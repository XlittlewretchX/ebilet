"use strict";(self.webpackChunkebilet_client=self.webpackChunkebilet_client||[]).push([[792],{703:(e,t,n)=>{var r=n(848),a=n(540),s=n(338),i=n(767),o=n(976),c=n(468),l=n(816),u=n(83),d=function(e,t,n,r){return new(n||(n=Promise))((function(a,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}c((r=r.apply(e,t||[])).next())}))},f=function(e,t){var n,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(s=0)),s;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=s.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},h=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,s=t.length;a<s;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},v=u.A.create({baseURL:"https://ebilet-8f91.onrender.com/api",headers:{"Content-Type":"application/json"}});v.interceptors.request.use((function(e){var t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}));var p,m=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,v.post("/auth/register",e)];case 1:return[2,t.sent().data]}}))}))},x=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,v.post("/auth/login",e)];case 1:return[2,t.sent().data]}}))}))},g=function(e){return d(void 0,void 0,void 0,(function(){var t;return f(this,(function(n){switch(n.label){case 0:return(t=new FormData).append("avatar",e),[4,v.post("/auth/avatar",t,{headers:{"Content-Type":"multipart/form-data"}})];case 1:return[2,n.sent().data]}}))}))},y=function(){return d(void 0,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,v.delete("/auth/avatar")];case 1:return[2,e.sent().data]}}))}))},j=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,v.patch("/auth/city",{city:e})];case 1:return[2,t.sent().data]}}))}))},b=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,v.post("/auth/favorite",{eventId:e})];case 1:return[2,t.sent().data]}}))}))},w=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,v.delete("/auth/favorite",{data:{eventId:e}})];case 1:return[2,t.sent().data]}}))}))},k=function(){return d(void 0,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,v.get("/auth/favorites")];case 1:return[2,e.sent().data]}}))}))},N=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,v.post("/auth/buy-ticket",e)];case 1:return[2,t.sent().data]}}))}))},C=function(){return d(void 0,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,v.get("/auth/my-tickets")];case 1:return[2,e.sent().data]}}))}))},S=function(){return d(void 0,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,v.get("/auth/check")];case 1:return[2,e.sent().data]}}))}))},A=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,v.patch("/auth/username",{username:e})];case 1:return[2,t.sent().data]}}))}))},D=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return d(void 0,h([],e,!0),void 0,(function(e){var t;return void 0===e&&(e={}),f(this,(function(n){switch(n.label){case 0:return t=new URLSearchParams,e.category&&t.append("category",e.category),e.subcategory&&t.append("subcategory",e.subcategory),e.priceRange&&"object"==typeof e.priceRange&&(void 0!==e.priceRange.min&&t.append("minPrice",String(e.priceRange.min)),void 0!==e.priceRange.max&&t.append("maxPrice",String(e.priceRange.max))),e.search&&t.append("search",e.search),e.city&&t.append("city",e.city),[4,v.get("/events",{params:t})];case 1:return[2,n.sent().data]}}))}))},B=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,v.get("/events/".concat(e))];case 1:return[2,t.sent().data]}}))}))},E=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,v.post("/events",e,{headers:{"Content-Type":"multipart/form-data"}})];case 1:return[2,t.sent().data]}}))}))},L=function(){return d(void 0,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,v.get("/events/user/events")];case 1:return[2,e.sent().data]}}))}))},T=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,v.get("/events/".concat(e,"/booked-seats"))];case 1:return[2,t.sent().data]}}))}))},O=function(e,t,n,r){return new(n||(n=Promise))((function(a,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}c((r=r.apply(e,t||[])).next())}))},M=function(e,t){var n,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(s=0)),s;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=s.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},R={user:null,token:localStorage.getItem("token"),isAuthenticated:!1,loading:!1,error:null,userTickets:[]},P=(0,l.zD)("auth/register",(function(e,t){return O(void 0,[e,t],void 0,(function(e,t){var n,r,a,s=t.rejectWithValue;return M(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,m(e)];case 1:return n=t.sent(),localStorage.setItem("token",n.token),[2,n];case 2:return r=t.sent(),(a=r).response&&a.response.data&&a.response.data.message?[2,s(a.response.data.message)]:[2,s("Ошибка при регистрации")];case 3:return[2]}}))}))})),I=(0,l.zD)("auth/login",(function(e,t){return O(void 0,[e,t],void 0,(function(e,t){var n,r,a,s=t.rejectWithValue;return M(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,x(e)];case 1:return n=t.sent(),localStorage.setItem("token",n.token),[2,n];case 2:return r=t.sent(),(a=r).response&&a.response.data&&a.response.data.message?[2,s(a.response.data.message)]:[2,s("Ошибка при входе")];case 3:return[2]}}))}))})),W=(0,l.zD)("auth/uploadAvatar",(function(e,t){return O(void 0,[e,t],void 0,(function(e,t){var n,r,a,s=t.rejectWithValue;return M(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,g(e)];case 1:return[2,t.sent().avatarUrl];case 2:return n=t.sent(),[2,s((null===(a=null===(r=n.response)||void 0===r?void 0:r.data)||void 0===a?void 0:a.message)||"Ошибка при загрузке аватара")];case 3:return[2]}}))}))})),z=(0,l.zD)("auth/resetAvatar",(function(e,t){return O(void 0,[e,t],void 0,(function(e,t){var n,r,a,s=t.rejectWithValue;return M(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,y()];case 1:return e.sent(),[2,void 0];case 2:return n=e.sent(),[2,s((null===(a=null===(r=n.response)||void 0===r?void 0:r.data)||void 0===a?void 0:a.message)||"Ошибка при сбросе аватара")];case 3:return[2]}}))}))})),F=(0,l.zD)("auth/updateCity",(function(e,t){return O(void 0,[e,t],void 0,(function(e,t){var n=t.rejectWithValue;return M(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,j(e)];case 1:return[2,t.sent().city];case 2:return t.sent(),[2,n("Ошибка при обновлении города")];case 3:return[2]}}))}))})),V=(0,l.zD)("auth/updateUsername",(function(e,t){return O(void 0,[e,t],void 0,(function(e,t){var n=t.rejectWithValue;return M(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,A(e)];case 1:return[2,t.sent().username];case 2:return t.sent(),[2,n("Ошибка при обновлении имени пользователя")];case 3:return[2]}}))}))})),U=(0,l.zD)("auth/addFavorite",(function(e,t){return O(void 0,[e,t],void 0,(function(e,t){var n=t.rejectWithValue;return M(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,b(e)];case 1:return t.sent(),[2,e];case 2:return t.sent(),[2,n("Ошибка при добавлении в избранное")];case 3:return[2]}}))}))})),G=(0,l.zD)("auth/removeFavorite",(function(e,t){return O(void 0,[e,t],void 0,(function(e,t){var n=t.rejectWithValue;return M(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,w(e)];case 1:return t.sent(),[2,e];case 2:return t.sent(),[2,n("Ошибка при удалении из избранного")];case 3:return[2]}}))}))})),q=(0,l.zD)("auth/fetchFavorites",(function(e,t){return O(void 0,[e,t],void 0,(function(e,t){var n=t.rejectWithValue;return M(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,k()];case 1:return[2,e.sent()];case 2:return e.sent(),[2,n("Ошибка при получении избранного")];case 3:return[2]}}))}))})),H=(0,l.zD)("auth/buyTicket",(function(e,t){return O(void 0,[e,t],void 0,(function(e,t){var n=t.rejectWithValue;return M(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,N(e)];case 1:return[2,t.sent()];case 2:return t.sent(),[2,n("Ошибка при покупке билета")];case 3:return[2]}}))}))})),Z=(0,l.zD)("auth/fetchUserTickets",(function(e,t){return O(void 0,[e,t],void 0,(function(e,t){var n=t.rejectWithValue;return M(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,C()];case 1:return[2,e.sent()];case 2:return e.sent(),[2,n("Ошибка при получении билетов")];case 3:return[2]}}))}))})),K=(0,l.zD)("auth/checkAuth",(function(e,t){return O(void 0,[e,t],void 0,(function(e,t){var n,r,a,s,i=t.rejectWithValue;return M(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),localStorage.getItem("token")?[4,S()]:[2,i(null)];case 1:return[2,e.sent()];case 2:return n=e.sent(),r=n,localStorage.removeItem("token"),(null===(s=null===(a=r.response)||void 0===a?void 0:a.data)||void 0===s?void 0:s.message)?[2,i(r.response.data.message)]:[2,i("Ошибка аутентификации")];case 3:return[2]}}))}))})),Y=(0,l.Z0)({name:"auth",initialState:R,reducers:{logout:function(e){e.user=null,e.token=null,e.isAuthenticated=!1,localStorage.removeItem("token")},clearError:function(e){e.error=null}},extraReducers:function(e){e.addCase(P.pending,(function(e){e.loading=!0,e.error=null})).addCase(P.fulfilled,(function(e,t){e.loading=!1,e.isAuthenticated=!0,e.user=t.payload.user,e.token=t.payload.token})).addCase(P.rejected,(function(e,t){e.loading=!1,e.error=t.payload||t.error.message||"Ошибка при регистрации"})).addCase(I.pending,(function(e){e.loading=!0,e.error=null})).addCase(I.fulfilled,(function(e,t){e.loading=!1,e.isAuthenticated=!0,e.user=t.payload.user,e.token=t.payload.token})).addCase(I.rejected,(function(e,t){e.loading=!1,e.error=t.payload||t.error.message||"Ошибка при входе"})).addCase(W.fulfilled,(function(e,t){e.user&&(e.user.avatarUrl=t.payload)})).addCase(z.fulfilled,(function(e,t){e.user&&(e.user.avatarUrl=void 0)})).addCase(F.fulfilled,(function(e,t){e.user&&(e.user.city=t.payload)})).addCase(V.fulfilled,(function(e,t){e.user&&(e.user.username=t.payload)})).addCase(U.fulfilled,(function(e,t){e.user&&(e.user.favorites||(e.user.favorites=[]),e.user.favorites.includes(t.payload)||e.user.favorites.push(t.payload))})).addCase(G.fulfilled,(function(e,t){e.user&&e.user.favorites&&(e.user.favorites=e.user.favorites.filter((function(e){return e!==t.payload})))})).addCase(q.fulfilled,(function(e,t){e.user&&(e.user.favorites=t.payload.map((function(e){return e.id})))})).addCase(H.pending,(function(e){e.loading=!0,e.error=null})).addCase(H.fulfilled,(function(e,t){e.loading=!1})).addCase(H.rejected,(function(e,t){e.loading=!1,e.error=t.payload||"Ошибка при покупке билета"})).addCase(Z.pending,(function(e){e.loading=!0,e.error=null})).addCase(Z.fulfilled,(function(e,t){e.loading=!1,e.userTickets=t.payload})).addCase(Z.rejected,(function(e,t){e.loading=!1,e.error=t.payload||"Ошибка при получении билетов"})).addCase(K.pending,(function(e){e.loading=!0,e.error=null})).addCase(K.fulfilled,(function(e,t){e.loading=!1,e.isAuthenticated=!0,e.user=t.payload.user,e.token=t.payload.token})).addCase(K.rejected,(function(e,t){e.loading=!1,e.isAuthenticated=!1,e.user=null,e.token=null,null!==t.payload&&(e.error=t.payload||"Ошибка аутентификации")}))}}),_=(p=Y.actions).logout;p.clearError;const X=Y.reducer;var J=function(e,t,n,r){return new(n||(n=Promise))((function(a,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}c((r=r.apply(e,t||[])).next())}))},Q=function(e,t){var n,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(s=0)),s;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=s.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},$=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,s=t.length;a<s;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},ee=(0,l.zD)("event/fetchEvents",(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return J(void 0,$([],e,!0),void 0,(function(e){return void 0===e&&(e={}),Q(this,(function(t){switch(t.label){case 0:return[4,D(e)];case 1:return[2,t.sent()]}}))}))})),te=((0,l.zD)("event/fetchEventById",(function(e){return J(void 0,void 0,void 0,(function(){return Q(this,(function(t){switch(t.label){case 0:return[4,B(e)];case 1:return[2,t.sent()]}}))}))})),(0,l.zD)("event/createEvent",(function(e){return J(void 0,void 0,void 0,(function(){return Q(this,(function(t){switch(t.label){case 0:return[4,E(e)];case 1:return[2,t.sent()]}}))}))}))),ne=(0,l.zD)("event/fetchUserEvents",(function(){return J(void 0,void 0,void 0,(function(){return Q(this,(function(e){switch(e.label){case 0:return[4,L()];case 1:return[2,e.sent()]}}))}))})),re=(0,l.Z0)({name:"event",initialState:{events:[],loading:!1,error:null},reducers:{clearError:function(e){e.error=null}},extraReducers:function(e){e.addCase(ee.pending,(function(e){e.loading=!0,e.error=null})).addCase(ee.fulfilled,(function(e,t){e.loading=!1,e.events=t.payload})).addCase(ee.rejected,(function(e,t){e.loading=!1,e.error=t.error.message||"Ошибка при загрузке событий"})).addCase(te.pending,(function(e){e.loading=!0,e.error=null})).addCase(te.fulfilled,(function(e,t){e.loading=!1,e.events.unshift(t.payload)})).addCase(te.rejected,(function(e,t){e.loading=!1,e.error=t.error.message||"Ошибка при создании события"})).addCase(ne.pending,(function(e){e.loading=!0,e.error=null})).addCase(ne.fulfilled,(function(e,t){e.loading=!1,e.events=t.payload})).addCase(ne.rejected,(function(e,t){e.loading=!1,e.error=t.error.message||"Ошибка при загрузке событий пользователя"}))}});re.actions.clearError;const ae=re.reducer;var se,ie=function(e,t,n,r){return new(n||(n=Promise))((function(a,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}c((r=r.apply(e,t||[])).next())}))},oe=function(e,t){var n,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(s=0)),s;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=s.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},ce=(0,l.zD)("city/fetchByIP",(function(e,t){return ie(void 0,[e,t],void 0,(function(e,t){var n,r,a,s,i,o,c,l,u,d,f,h,v,p,m,x=t.rejectWithValue;return oe(this,(function(e){switch(e.label){case 0:return e.trys.push([0,6,,7]),n="https://api.ipgeolocation.io/ipgeo?apiKey=".concat("90cea4be77d44b80ab21374726d21b70"),[4,fetch(n)];case 1:return(r=e.sent()).ok?[4,r.json()]:[2,x("Ошибка API: ".concat(r.status))];case 2:return a=e.sent(),s=a.city,i=a.latitude,o=a.longitude,i&&o?(c="https://nominatim.openstreetmap.org/reverse?lat=".concat(i,"&lon=").concat(o,"&format=json&accept-language=ru"),[4,fetch(c,{headers:{"User-Agent":"ebilet-app/1.0 (your@email.com)"}})]):[2,s||"Город"];case 3:return(l=e.sent()).ok?[4,l.json()]:[3,5];case 4:if(u=e.sent(),d=(null===(h=u.address)||void 0===h?void 0:h.city)||(null===(v=u.address)||void 0===v?void 0:v.town)||(null===(p=u.address)||void 0===p?void 0:p.village)||(null===(m=u.address)||void 0===m?void 0:m.state))return[2,d];e.label=5;case 5:return[2,s||"Город"];case 6:return f=e.sent(),[2,x(f.message)];case 7:return[2]}}))}))})),le=(0,l.Z0)({name:"city",initialState:{name:"Город",showPicker:!1},reducers:{openPicker:function(e){e.showPicker=!0},closePicker:function(e){e.showPicker=!1},setCity:function(e,t){e.name=t.payload,e.showPicker=!1}},extraReducers:function(e){e.addCase(ce.fulfilled,(function(e,t){var n=t.payload;e.name=n,e.showPicker=!1})).addCase(ce.rejected,(function(e){e.showPicker=!0}))}}),ue=((se=le.actions).openPicker,se.closePicker,se.setCity);const de=le.reducer;var fe=(0,l.Z0)({name:"search",initialState:{value:""},reducers:{setSearch:function(e,t){e.value=t.payload}}}),he=fe.actions.setSearch;const ve=fe.reducer;var pe,me={category:"",subcategory:"",dateRange:{start:"",end:""},priceRange:{min:0,max:1e4},onlyMyCity:!1},xe=(0,l.Z0)({name:"filter",initialState:me,reducers:{setFilters:function(e,t){return t.payload},resetFilters:function(){return me}}}),ge=(pe=xe.actions).setFilters,ye=pe.resetFilters;const je=xe.reducer;var be,we=(0,l.Z0)({name:"mobileMenu",initialState:{isOpen:!1,showLogoutConfirm:!1},reducers:{openMenu:function(e){e.isOpen=!0},closeMenu:function(e){e.isOpen=!1,e.showLogoutConfirm=!1},showLogoutConfirm:function(e){e.showLogoutConfirm=!0},hideLogoutConfirm:function(e){e.showLogoutConfirm=!1}}}),ke=(be=we.actions).openMenu,Ne=be.closeMenu,Ce=be.showLogoutConfirm,Se=be.hideLogoutConfirm;const Ae=we.reducer;var De=(0,l.U1)({reducer:{auth:X,event:ae,city:de,search:ve,filter:je,mobileMenu:Ae}}),Be=function(){return(0,c.wA)()},Ee=c.d4;const Le="ZBn11TNK",Te="CUqvr6P1",Oe="AHg1PWg4",Me="lm66XJB1",Re="bJBRsEr3",Pe="afkZPFTr",Ie="qRFgd7Gl";var We=function(){return We=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},We.apply(this,arguments)},ze=function(e,t,n,r){return new(n||(n=Promise))((function(a,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}c((r=r.apply(e,t||[])).next())}))},Fe=function(e,t){var n,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(s=0)),s;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=s.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},Ve=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};const Ue=function(e){var t=e.isOpen,n=e.onClose,s=Be(),i=Ee((function(e){return e.auth})),o=i.loading,c=i.error,l=i.isAuthenticated,u=Ee((function(e){return e.city.name})),d=(0,a.useState)(!0),f=d[0],h=d[1],v=(0,a.useState)({username:"",email:"",password:"",confirmPassword:""}),p=v[0],m=v[1],x=(0,a.useState)(""),g=x[0],y=x[1],j=function(e){var t;m(We(We({},p),((t={})[e.target.name]=e.target.value,t)))};return(0,a.useEffect)((function(){t&&l&&f&&n()}),[l,t,f,n]),(0,a.useEffect)((function(){t&&(m({username:"",email:"",password:"",confirmPassword:""}),y(""))}),[t,f]),(0,a.useEffect)((function(){if(t){var e=function(){if("undefined"==typeof window)return 0;var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.overflow="scroll",e.style.position="absolute",e.style.top="-9999px",document.body.appendChild(e);var t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),t}();document.body.style.overflow="hidden",e>0&&(document.body.style.paddingRight="".concat(e,"px"));var r=function(e){"Escape"===e.key&&n()};return window.addEventListener("keydown",r),function(){document.body.style.overflow="",document.body.style.paddingRight="",window.removeEventListener("keydown",r)}}document.body.style.overflow="",document.body.style.paddingRight=""}),[t,n]),t?(0,r.jsx)("div",{className:Le,onClick:n,children:(0,r.jsxs)("div",{className:Te,onClick:function(e){return e.stopPropagation()},children:[(0,r.jsx)("button",{className:Oe,onClick:n,children:"×"}),(0,r.jsx)("h2",{children:f?"Вход":"Регистрация"}),(0,r.jsxs)("form",{onSubmit:function(e){return ze(void 0,void 0,void 0,(function(){var t,r,a;return Fe(this,(function(i){switch(i.label){case 0:return e.preventDefault(),f||p.password===p.confirmPassword?f?(p.email,p.confirmPassword,t=Ve(p,["email","confirmPassword"]),[4,s(I(t))]):[3,2]:(alert("Пароли не совпадают"),[2]);case 1:return i.sent(),[3,4];case 2:return p.confirmPassword,r=Ve(p,["confirmPassword"]),[4,s(P(We(We({},r),{city:u})))];case 3:a=i.sent(),P.fulfilled.match(a)&&(y("Вы успешно зарегистрировались!"),setTimeout((function(){y(""),n()}),1500)),i.label=4;case 4:return[2]}}))}))},children:[(0,r.jsx)("div",{className:Me,children:(0,r.jsx)("input",{type:"text",name:"username",placeholder:"Имя пользователя",value:p.username,onChange:j,required:!0})}),!f&&(0,r.jsx)("div",{className:Me,children:(0,r.jsx)("input",{type:"email",name:"email",placeholder:"Email",value:p.email,onChange:j,required:!0})}),(0,r.jsx)("div",{className:Me,children:(0,r.jsx)("input",{type:"password",name:"password",placeholder:"Пароль",value:p.password,onChange:j,required:!0})}),!f&&(0,r.jsx)("div",{className:Me,children:(0,r.jsx)("input",{type:"password",name:"confirmPassword",placeholder:"Подтвердите пароль",value:p.confirmPassword,onChange:j,required:!0})}),(0,r.jsx)("button",{type:"submit",disabled:o,children:o?"Загрузка...":f?"Войти":"Зарегистрироваться"}),c&&(0,r.jsx)("p",{className:Re,children:c}),g&&(0,r.jsx)("p",{className:Pe,children:g})]}),(0,r.jsxs)("p",{className:Ie,children:[f?"Нет аккаунта?":"Уже есть аккаунт?"," ",(0,r.jsx)("button",{onClick:function(){return h(!f)},children:f?"Зарегистрироваться":"Войти"})]})]})}):null},Ge="kTUf0kGC",qe="fEL3MMAt",He="fM4jt9LS",Ze="L30DL5n3",Ke="r7jyaAy1",Ye="IXD9sEDJ",_e="l75q4Lc1",Xe="IAIvkVq1",Je="erN_ZNXn",Qe="a3hu4l6L",$e="fAQaBm7b",et="PlasbFNv";var tt=function(){return(0,r.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z",fill:"currentColor"})})},nt=function(){return(0,r.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z",fill:"currentColor"})})},rt=function(){return(0,r.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z",fill:"currentColor"})})},at=function(){return(0,r.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z",fill:"currentColor"})})},st=function(){return(0,r.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z",fill:"currentColor"})})},it=function(){return(0,r.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M11 7L9.6 8.4l2.6 2.6H2v2h10.2l-2.6 2.6L11 17l5-5-5-5zm9 12h-8v2h8c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-8v2h8v14z",fill:"currentColor"})})},ot=function(){return(0,r.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{marginRight:6},children:(0,r.jsx)("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z",fill:"#007bff"})})},ct=["Москва","Санкт-Петербург","Новосибирск","Екатеринбург","Казань","Нижний Новгород","Челябинск","Самара","Омск","Ростов-на-Дону","Уфа","Красноярск","Воронеж","Пермь","Волгоград","Краснодар","Саратов","Тюмень","Тольятти","Ижевск","Барнаул","Ульяновск","Иркутск","Хабаровск","Ярославль","Владивосток","Махачкала","Томск","Оренбург","Кемерово","Новокузнецк","Рязань","Астрахань","Набережные Челны","Пенза","Липецк","Киров","Чебоксары","Тула","Калининград","Курск","Улан-Удэ","Ставрополь","Сочи","Иваново","Брянск","Белгород","Архангельск","Владимир","Севастополь","Чита","Грозный","Курган","Смоленск","Вологда","Саранск","Череповец","Орёл","Владикавказ","Мурманск","Якутск","Сургут","Волжский","Кострома","Тверь","Стерлитамак","Ингушетия","Новороссийск","Йошкар-Ола","Таганрог","Сыктывкар","Нальчик","Шахты","Нижнекамск","Дзержинск","Орск","Энгельс","Бийск","Прокопьевск","Рыбинск","Балашиха","Ухта","Старый Оскол","Златоуст","Миасс","Альметьевск","Королёв","Люберцы","Северодвинск","Петрозаводск","Норильск","Сызрань","Новочеркасск","Зеленодольск","Волгодонск","Абакан","Уссурийск","Салават","Электросталь","Бердск","Находка","Рубцовск","Майкоп","Ковров","Коломна","Кисловодск","Железнодорожный","Новомосковск","Серпухов","Назрань","Орехово-Зуево","Нефтекамск","Дербент","Камышин","Невинномысск","Красногорск","Муром","Батайск","Новочебоксарск","Сергиев Посад","Черкесск","Октябрьский","Ачинск","Новошахтинск","Елец","Арзамас","Обнинск","Элиста","Новокуйбышевск","Каспийск","Пушкино","Домодедово","Реутов","Жуковский","Глазов","Железногорск","Воткинск","Ленинск-Кузнецкий","Междуреченск","Сарапул","Ессентуки","Вихоревка","Губкин","Бугульма","Кумертау","Клин","Чапаевск","Саров","Волжск","Назарово","Тобольск","Усть-Илимск","Стрежевой","Зеленогорск","Соликамск","Горно-Алтайск","Канск","Новоалтайск","Бор","Шадринск","Мичуринск","Великие Луки","Киселёвск","Ангарск","Балаково","Благовещенск","Братск","Великий Новгород","Димитровград","Магадан","Магнитогорск","Нарьян-Мар","Нижневартовск","Нижний Тагил","Петропавловск-Камчатский","Псков","Симферополь","Тамбов","Ханты-Мансийск","Южно-Сахалинск","Ереван","Ташир","Калуга"];const lt=function(){var e,t=Be(),n=Ee((function(e){return e.auth})).isAuthenticated,s=function(){var e=Be(),t=Ee((function(e){return e.city})).name,n=Ee((function(e){return e.auth})),r=n.isAuthenticated,s=n.user,i=(0,a.useState)(!1),o=i[0],c=i[1],l=(0,a.useState)(""),u=l[0],d=l[1],f=r?(null==s?void 0:s.city)||"Город":t;return(0,a.useEffect)((function(){d(f)}),[f]),{displayCity:f,editing:o,input:u,setEditing:c,setInput:d,handleSave:function(){u.trim()&&(r?(e(F(u.trim())),e(ue(u.trim()))):e(ue(u.trim())),c(!1))}}}(),i=s.displayCity,o=s.editing,c=s.input,l=s.setEditing,u=s.setInput,d=s.handleSave,f=(0,a.useState)([]),h=f[0],v=f[1],p=(0,a.useState)(-1),m=p[0],x=p[1],g=(0,a.useRef)(null),y=(0,a.useRef)(null),j=function(e){n&&t(F(e)),t(ue(e)),l(!1)};return(0,a.useEffect)((function(){var e=function(e){g.current&&!g.current.contains(e.target)&&v([])};return document.addEventListener("mousedown",e),function(){return document.removeEventListener("mousedown",e)}}),[]),(0,r.jsxs)("div",{className:Ge,children:[(0,r.jsxs)("button",{className:qe,onClick:function(){return l(!0)},"aria-label":"Выбрать город",children:[(0,r.jsx)(ot,{}),(0,r.jsx)("span",{className:He,title:i,children:(e=i,window.innerWidth<=480&&e.length>8?"".concat(e.slice(0,8),"..."):e)})]}),o&&(0,r.jsx)("div",{className:Ze,onClick:function(){return l(!1)},children:(0,r.jsxs)("div",{className:Ke,onClick:function(e){return e.stopPropagation()},children:[(0,r.jsx)("input",{ref:y,className:Ye,value:c,onChange:function(e){var t=e.target.value;if(u(t),t.trim()){var n=ct.filter((function(e){return e.toLowerCase().startsWith(t.toLowerCase())}));v(n.slice(0,5)),x(-1)}else v([])},onKeyDown:function(e){if(0!==h.length)switch(e.key){case"ArrowDown":e.preventDefault(),x((function(e){return e<h.length-1?e+1:e}));break;case"ArrowUp":e.preventDefault(),x((function(e){return e>0?e-1:e}));break;case"Enter":e.preventDefault(),m>=0?j(h[m]):d();break;case"Escape":v([])}},placeholder:"Введите город",autoFocus:!0}),h.length>0&&(0,r.jsx)("div",{className:_e,ref:g,children:h.map((function(e,t){return(0,r.jsx)("div",{className:"".concat(Xe," ").concat(t===m?Je:""),onClick:function(){return j(e)},children:e},e)}))}),(0,r.jsxs)("div",{className:Qe,children:[(0,r.jsx)("button",{className:$e,onClick:d,children:"Сохранить"}),(0,r.jsx)("button",{className:et,onClick:function(){return l(!1)},children:"Отмена"})]})]})})]})},ut="u_gfar7T",dt="c4nqin0V",ft="vznLq989",ht="RtxXsOy1",vt="zAcwWXS1",pt="yOBgwguB",mt="ecktM8Mn",xt="WzUGgLsP",gt="ODPKXZs7",yt="lUEi3qfW",jt="V_MqE9EB",bt="fsUi_MnL";const wt=function(e){var t=e.user,n=e.avatarUrl,s=function(){var e=Be(),t=(0,i.Zp)(),n=(0,a.useState)(!1),r=n[0],s=n[1],o=(0,a.useState)(!1),c=o[0],l=o[1];return{showUserMenu:r,showLogoutConfirm:c,setShowUserMenu:s,setShowLogoutConfirm:l,onLogout:function(){e(_()),l(!1),s(!1)},onProfileClick:function(){s(!1),t("/profile")}}}(),o=s.showUserMenu,c=s.showLogoutConfirm,l=s.setShowUserMenu,u=s.setShowLogoutConfirm,d=s.onLogout,f=s.onProfileClick;return a.useEffect((function(){if(o){var e=function(e){var t=document.getElementById("user-menu-dropdown");t&&!t.contains(e.target)&&(l(!1),u(!1))};return document.addEventListener("mousedown",e),function(){return document.removeEventListener("mousedown",e)}}}),[o,l,u]),(0,r.jsxs)("div",{className:ut,children:[(0,r.jsxs)("button",{className:dt+(o?" "+ft:""),onClick:function(){l(!o),u(!1)},"aria-haspopup":"true","aria-expanded":o,children:[(0,r.jsx)("img",{src:n,alt:"avatar",className:ht}),(0,r.jsx)("span",{className:vt,children:null==t?void 0:t.username})]}),o&&(0,r.jsxs)("div",{className:pt,id:"user-menu-dropdown",children:[(0,r.jsx)("a",{className:mt,href:"/profile",onClick:function(e){e.preventDefault(),l(!1),f()},children:"Мой профиль"}),(0,r.jsx)("div",{className:xt}),c?(0,r.jsxs)("div",{className:gt,children:["Выйти из аккаунта?",(0,r.jsxs)("div",{className:yt,children:[(0,r.jsx)("button",{className:jt,onClick:function(){d(),u(!1),l(!1)},children:"Да"}),(0,r.jsx)("button",{className:bt,onClick:function(){return u(!1)},children:"Нет"})]})]}):(0,r.jsx)("button",{className:mt,onClick:function(){return u(!0)},children:"Выйти"})]})]})},kt="vFxDmrvU",Nt="o4VsDbxP",Ct="frbACkJ_",St="sqI0LMOw",At="U1k4rMem",Dt="rbWNWGgP",Bt="GbgU173B",Et="ZV5CdtjW",Lt="poijlVjc",Tt="Q3b6hzAj",Ot="wZKwQdaY",Mt="IV8BWnrl",Rt="HrKCTqbm";var Pt=function(e){var t=e.isAuthenticated,n=e.onLoginClick,a=Be(),s=Ee((function(e){return e.mobileMenu})),i=s.isOpen,c=s.showLogoutConfirm,l=function(){a(Ne())};return(0,r.jsxs)("div",{className:"".concat(kt," ").concat(i?Nt:""),children:[(0,r.jsxs)("div",{className:Ct,children:[(0,r.jsx)(o.N_,{to:"/",className:St,onClick:l,children:"eBilet"}),(0,r.jsx)("button",{className:At,onClick:l,children:(0,r.jsx)(nt,{})})]}),(0,r.jsxs)("div",{className:Dt,children:[(0,r.jsx)("div",{className:Lt,children:(0,r.jsx)(lt,{})}),t?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(o.N_,{to:"/my-tickets",className:Bt,onClick:l,children:[(0,r.jsx)(at,{}),"Мои события"]}),(0,r.jsxs)(o.N_,{to:"/profile",className:Bt,onClick:l,children:[(0,r.jsx)(rt,{}),"Мой профиль"]}),c?(0,r.jsxs)("div",{className:Tt,children:["Выйти из аккаунта?",(0,r.jsxs)("div",{className:Ot,children:[(0,r.jsx)("button",{className:Mt,onClick:function(){a(_()),l()},children:"Да"}),(0,r.jsx)("button",{className:Rt,onClick:function(){return a(Se())},children:"Нет"})]})]}):(0,r.jsxs)("button",{className:Bt,onClick:function(){return a(Ce())},children:[(0,r.jsx)(st,{}),"Выйти"]})]}):(0,r.jsxs)("button",{className:Et,onClick:function(){n(),l()},children:[(0,r.jsx)(it,{}),"Войти"]})]})]})};const It="g41BiwqO",Wt="Ur4ZVcPj",zt="NZN2De8g",Ft="EgI6UGtM",Vt="C12NQz6V",Ut="THy6AUoD",Gt="z8gNbq6G",qt="PGbuMa0s";const Ht=function(){var e=Be(),t=Ee((function(e){return e.search.value}));return(0,r.jsx)("div",{className:qt,children:(0,r.jsx)("input",{type:"text",placeholder:"Поиск мероприятий...",value:t,onChange:function(t){return e(he(t.target.value))}})})};const Zt=function(){var e,t=Be(),n=Ee((function(e){return e.auth})),s=n.user,i=n.isAuthenticated,c=a.useState(!1),l=c[0],u=c[1];(0,a.useEffect)((function(){i?(null==s?void 0:s.city)&&"Город"!==s.city?t(ue(s.city)):t(ce()).then((function(e){ce.fulfilled.match(e)&&(t(F(e.payload)),t(ue(e.payload)))})):t(ce()).then((function(e){ce.fulfilled.match(e)&&t(ue(e.payload))}))}),[i]);var d=(null==s?void 0:s.avatarUrl)?s.avatarUrl.startsWith("/uploads")?"".concat(null===(e="https://ebilet-8f91.onrender.com/api")?void 0:e.replace("/api","")).concat(s.avatarUrl):s.avatarUrl:"https://xlittlewretchx.github.io/ebilet/img/default-avatar.svg";return(0,r.jsxs)("header",{className:It,children:[(0,r.jsxs)("div",{className:Wt,children:[(0,r.jsx)(o.N_,{to:"/",className:zt,children:"eBilet"}),(0,r.jsx)(Ht,{}),(0,r.jsxs)("nav",{className:Ft,children:[(0,r.jsx)(lt,{}),i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.N_,{to:"/my-tickets",className:Vt,children:"Мои события"}),(0,r.jsx)(wt,{user:s,avatarUrl:d})]}):(0,r.jsx)("button",{onClick:function(){return u(!0)},className:Ut,children:"Войти"})]}),(0,r.jsx)("button",{className:Gt,onClick:function(){return t(ke())},"aria-label":"Открыть меню",children:(0,r.jsx)(tt,{})})]}),(0,r.jsx)(Pt,{isAuthenticated:i,onLoginClick:function(){return u(!0)}}),(0,r.jsx)(Ue,{isOpen:l,onClose:function(){return u(!1)}})]})},Kt="q5cSkrMt",Yt="Ae6HeLkd",_t="Y5GpHGmX",Xt="rwPoguZK",Jt="cck_aaWJ",Qt="HPiEpQok",$t="FiozW65V",en="aYq2HTAm",tn="SOh8XEf3",nn="DkILKbzx",rn="LgrZNhg5",an="EkpXFwbY",sn="BTMdkehq";const on=function(e){var t,n,a=e.event,s=e.isFavorite,i=e.onAddToFavorites,o=e.onRemoveFromFavorites,c=e.onBuyTicket,l=a.ticketCount,u=a.ticketSeats;return(0,r.jsxs)("div",{className:Kt,children:[a.imageUrl&&(0,r.jsx)("div",{className:Yt,children:(0,r.jsx)("img",{src:a.imageUrl.startsWith("/uploads")?"".concat(null===(t="https://ebilet-8f91.onrender.com/api")?void 0:t.replace("/api","")).concat(a.imageUrl):a.imageUrl,alt:a.title,className:_t})}),(0,r.jsxs)("div",{className:Xt,children:[(0,r.jsx)("h3",{className:Jt,children:a.title}),(0,r.jsx)("p",{className:Qt,children:a.description}),(0,r.jsxs)("div",{className:$t,children:[(0,r.jsx)("span",{className:en,children:(n=a.date,new Date(n).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"}))}),(0,r.jsx)("span",{className:tn,children:a.location}),(0,r.jsxs)("span",{className:nn,children:[a.price," ₽"]})]}),(l||u&&u.length)&&(0,r.jsxs)("div",{style:{margin:"8px 0",fontSize:"0.95em"},children:[l&&(0,r.jsxs)("span",{style:{marginRight:12},children:["Куплено билетов: ",(0,r.jsx)("b",{children:l})]}),u&&u.length>0&&(0,r.jsxs)("span",{children:["Места: ",(0,r.jsx)("b",{children:u.join(", ")})]})]}),(0,r.jsxs)("div",{className:rn,children:[!a.isTicket&&(0,r.jsxs)(r.Fragment,{children:[s?(0,r.jsx)("button",{className:an,style:{color:"#2563eb",fontWeight:700},onClick:function(){return o&&o(a.id)},children:"Из избранного"}):(0,r.jsx)("button",{className:an,onClick:function(){return i(a.id)},children:"В избранное"}),(0,r.jsx)("button",{className:sn,onClick:function(){return c(a.id)},children:"Купить билет"})]}),a.isTicket&&(0,r.jsx)("span",{style:{color:"#22c55e",fontWeight:600,fontSize:"1em"},children:"Билет куплен"})]})]})]})},cn={eventsGrid:"qBEGkhBl",skeletonCard:"RbbVmJFy",skeletonPulse:"vpMKu1Ol",skeletonImage:"vlm4unXd",skeletonContent:"NBc2AoOt",skeletonTitle:"f2LiwQAJ",skeletonText:"zS2iyEE3",skeletonActions:"R2oGtYoV",emptyStub:"E8nCmBoI",errorStub:"q9ZaeAke",fadeIn:"RcMhUo2O",emptyStubIcon:"YDzKGw5_",emptyStubText:"mKiTZ3jb",errorStubText:"ndbO5NyY",errorStubIcon:"X8zyHPt9"};var ln=n(164);const un=function(e){var t=e.events,n=e.onAddToFavorites,a=e.onRemoveFromFavorites,s=e.onBuyTicket,i=e.loading,o=e.error;return i?(0,r.jsx)("div",{className:cn.eventsGrid,children:Array.from({length:6}).map((function(e,t){return(0,r.jsxs)("div",{className:(0,ln.A)(cn.skeletonCard,cn.card),children:[(0,r.jsx)("div",{className:cn.skeletonImage}),(0,r.jsxs)("div",{className:cn.skeletonContent,children:[(0,r.jsx)("div",{className:cn.skeletonTitle}),(0,r.jsx)("div",{className:cn.skeletonText}),(0,r.jsx)("div",{className:cn.skeletonText}),(0,r.jsx)("div",{className:cn.skeletonActions})]})]},t)}))}):o?(0,r.jsx)("div",{className:cn.eventsGrid,children:(0,r.jsxs)("div",{className:cn.errorStub,children:[(0,r.jsxs)("svg",{className:cn.errorStubIcon,viewBox:"0 0 48 48",fill:"none",children:[(0,r.jsx)("circle",{cx:"24",cy:"24",r:"22",fill:"#ffd6d6",stroke:"#dc3545",strokeWidth:"2"}),(0,r.jsx)("path",{d:"M24 14v12",stroke:"#dc3545",strokeWidth:"3",strokeLinecap:"round"}),(0,r.jsx)("circle",{cx:"24",cy:"33",r:"2.5",fill:"#dc3545"})]}),(0,r.jsxs)("div",{className:cn.errorStubText,children:["Произошла ошибка при загрузке событий.",(0,r.jsx)("br",{}),"Пожалуйста, попробуйте позже."]})]})}):t.length?(0,r.jsx)("div",{className:cn.eventsGrid,children:t.map((function(e){return(0,r.jsx)(on,{event:e,isFavorite:e.isFavorite,onAddToFavorites:n,onRemoveFromFavorites:a,onBuyTicket:s},e.id)}))}):(0,r.jsx)("div",{className:cn.eventsGrid,children:(0,r.jsxs)("div",{className:cn.emptyStub,children:[(0,r.jsxs)("svg",{className:cn.emptyStubIcon,viewBox:"0 0 48 48",fill:"none",children:[(0,r.jsx)("circle",{cx:"24",cy:"24",r:"22",fill:"#e3e8ee",stroke:"#bfc8d6",strokeWidth:"2"}),(0,r.jsx)("path",{d:"M16 28c1.5-2 4.5-2 6 0s4.5 2 6 0",stroke:"#bfc8d6",strokeWidth:"2",strokeLinecap:"round"}),(0,r.jsx)("circle",{cx:"18",cy:"20",r:"2",fill:"#bfc8d6"}),(0,r.jsx)("circle",{cx:"30",cy:"20",r:"2",fill:"#bfc8d6"})]}),(0,r.jsx)("div",{className:cn.emptyStubText,children:"Мероприятия не найдены по выбранным фильтрам"})]})})},dn="fwAkczIH",fn="bZnCPQjS",hn="iCXDBxH_",vn="kBXyRaRk",pn="GUckwTmH",mn="Y8pf8z9R",xn="ghCNQt6h",gn="yVFLEEy2",yn="mPsDzB1Y",jn="c1QaTwJw",bn="T97yrrqq",wn="jcw1xC7P",kn="L0Ssg5jW";var Nn=function(){return Nn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Nn.apply(this,arguments)},Cn={concert:["рок","поп","классика","джаз"],theater:["драма","комедия","мюзикл"],exhibition:["искусство","наука","технологии"],sport:["футбол","баскетбол","теннис"]};const Sn=function(){var e=Be(),t=Ee((function(e){return e.filter})),n=(0,a.useState)(!1),s=n[0],i=n[1];(0,a.useEffect)((function(){return document.body.style.overflow=s?"hidden":"unset",function(){document.body.style.overflow="unset"}}),[s]);var o=function(n,r){var a,s=Nn(Nn({},t),((a={})[n]=r,a));"category"===n&&(s=Nn(Nn({},s),{subcategory:""})),e(ge(s))},c=function(){e(ye())},l=function(){i(!1)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{className:bn,onClick:function(){i(!s)},children:[(0,r.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M8.33333 15H11.6667V13.3333H8.33333V15ZM2.5 5V6.66667H17.5V5H2.5ZM5 10.8333H15V9.16667H5V10.8333Z",fill:"currentColor"})}),"Фильтры"]}),(0,r.jsx)("div",{className:"".concat(dn," ").concat(s?fn:""),children:(0,r.jsx)((function(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:yn,children:[(0,r.jsx)("h3",{className:hn,children:"Фильтры"}),(0,r.jsx)("button",{className:jn,onClick:l,"aria-label":"Закрыть фильтры",children:(0,r.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M18 6L6 18M6 6L18 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),(0,r.jsxs)("div",{className:vn,children:[(0,r.jsx)("label",{className:pn,children:"Категория"}),(0,r.jsxs)("select",{className:mn,value:t.category,onChange:function(e){return o("category",e.target.value)},children:[(0,r.jsx)("option",{value:"",children:"Все категории"}),(0,r.jsx)("option",{value:"concert",children:"Концерты"}),(0,r.jsx)("option",{value:"theater",children:"Театр"}),(0,r.jsx)("option",{value:"exhibition",children:"Выставки"}),(0,r.jsx)("option",{value:"sport",children:"Спорт"})]})]}),t.category&&Cn[t.category]&&(0,r.jsxs)("div",{className:vn,children:[(0,r.jsx)("label",{className:pn,children:"Подкатегория"}),(0,r.jsxs)("select",{className:mn,value:t.subcategory,onChange:function(e){return o("subcategory",e.target.value.toLowerCase())},children:[(0,r.jsx)("option",{value:"",children:"Все подкатегории"}),Cn[t.category].map((function(e){return(0,r.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e)}))]})]}),(0,r.jsxs)("div",{className:vn,children:[(0,r.jsx)("label",{className:pn,children:"Цена"}),(0,r.jsxs)("div",{className:gn,children:[(0,r.jsx)("input",{type:"number",className:xn,placeholder:"От",value:t.priceRange.min,onChange:function(e){return o("priceRange",Nn(Nn({},t.priceRange),{min:Number(e.target.value)}))}}),(0,r.jsx)("input",{type:"number",className:xn,placeholder:"До",value:t.priceRange.max,onChange:function(e){return o("priceRange",Nn(Nn({},t.priceRange),{max:Number(e.target.value)}))}})]})]}),(0,r.jsx)("div",{className:vn,children:(0,r.jsxs)("div",{className:kn,children:[(0,r.jsx)("input",{type:"checkbox",id:"onlyMyCity",checked:t.onlyMyCity,onChange:function(e){return o("onlyMyCity",e.target.checked)}}),(0,r.jsx)("label",{htmlFor:"onlyMyCity",className:pn,style:{margin:0},children:"Искать в моем городе"})]})}),(0,r.jsx)("button",{className:wn,onClick:c,children:"Сбросить фильтры"})]})}),{})})]})},An="aOSoyp7r",Dn="d4KLp_dD",Bn="_FNy51Xg",En="V45fxXZ2",Ln="TCZtD3bx",Tn="NNJb7u6d",On="tx_zLngi",Mn="L9cW5MAQ",Rn="bBoisNcT",Pn="LSFm0ftZ",In="QLvNlLJK",Wn="q9fflxoV";var zn=function(e){return e.toString().padStart(2,"0")},Fn=function(e){return"".concat(e.getFullYear(),"-").concat(zn(e.getMonth()+1),"-").concat(zn(e.getDate()))},Vn=function(){return Vn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Vn.apply(this,arguments)},Un=["ПН","ВТ","СР","ЧТ","ПТ","СБ","ВС"],Gn=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],qn=n(691),Hn=(n(995),n(614));const Zn="WROPTd0E",Kn="vpc0jDIC",Yn="xfTV9jjM";var _n=function(e){var t=e.selectedDate,n=e.selectedRange,a=e.onCalendarChange,s=e.onClose,i=e.onClear;return(0,r.jsx)("div",{className:Zn,onClick:s,children:(0,r.jsxs)("div",{className:Kn,onClick:function(e){return e.stopPropagation()},children:[(0,r.jsx)(qn.Ay,{selected:t,onChange:a,startDate:n[0],endDate:n[1],selectsRange:!0,inline:!0,locale:Hn.ru,dateFormat:"dd.MM.yyyy"}),(0,r.jsxs)("div",{style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[(0,r.jsx)("button",{className:Yn,onClick:s,children:"Закрыть"}),(0,r.jsx)("button",{className:Yn,style:{background:"#e3eaff",color:"#2563eb"},onClick:i,children:"Очистить"})]})]})})},Xn=function(){return Xn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Xn.apply(this,arguments)};const Jn=function(e){var t=function(e){var t=e.onDateSelect,n=e.onRangeSelect,r=new Date,s=(0,a.useState)({calendarOpen:!1,selectedDate:null,selectedRange:[null,null],month:r.getMonth(),year:r.getFullYear()}),i=s[0],o=s[1];return(0,a.useEffect)((function(){if(i.selectedDate||i.selectedRange[0]||i.selectedRange[1]){var e=function(){o((function(e){return Vn(Vn({},e),{selectedDate:null,selectedRange:[null,null]})}))};return window.addEventListener("reset-date-strip",e),function(){return window.removeEventListener("reset-date-strip",e)}}}),[i.selectedDate,i.selectedRange]),{state:i,setState:o,handleDateClick:function(e){o((function(t){return Vn(Vn({},t),{selectedDate:e,selectedRange:[null,null]})}));var r=Fn(e);t(r),n(r,r)},handleCalendarChange:function(e){if(Array.isArray(e))o((function(t){return Vn(Vn({},t),{selectedRange:e,selectedDate:null})})),e[0]&&e[1]&&(n(Fn(e[0]),Fn(e[1])),o((function(e){return Vn(Vn({},e),{calendarOpen:!1})})));else if(e instanceof Date){o((function(t){return Vn(Vn({},t),{selectedDate:e,selectedRange:[null,null]})}));var r=Fn(e);t(r),o((function(e){return Vn(Vn({},e),{calendarOpen:!1})}))}},handleMonthChange:function(e){o((function(t){var n="prev"===e?0===t.month?11:t.month-1:11===t.month?0:t.month+1,r="prev"===e&&0===t.month?t.year-1:"next"===e&&11===t.month?t.year+1:t.year;return Vn(Vn({},t),{month:n,year:r})}))},handleClear:function(){o((function(e){return Vn(Vn({},e),{selectedDate:null,selectedRange:[null,null],calendarOpen:!1})})),n("","")}}}(e),n=t.state,s=t.setState,i=t.handleDateClick,o=t.handleCalendarChange,c=t.handleMonthChange,l=t.handleClear,u=new Date,d=function(e,t){for(var n=[],r=new Date(e,t,1);r.getMonth()===t;)n.push(new Date(r)),r.setDate(r.getDate()+1);return n}(n.year,n.month),f=new Date(n.year,n.month,1).getDay();0===f&&(f=7);Array(f-1).fill(null);return(0,r.jsxs)("div",{className:An,children:[(0,r.jsxs)("div",{className:Dn,children:[(0,r.jsx)("button",{className:En,onClick:function(){return c("prev")},children:"←"}),(0,r.jsxs)("span",{className:Bn,children:[Gn[n.month]," ",n.year]}),(0,r.jsx)("button",{className:En,onClick:function(){return c("next")},children:"→"})]}),(0,r.jsx)("div",{className:Ln,children:(0,r.jsx)("div",{className:Tn,children:d.map((function(e){var t=e.toDateString()===u.toDateString(),a=n.selectedDate&&e.toDateString()===n.selectedDate.toDateString(),s=Un[(e.getDay()+6)%7];return(0,r.jsxs)("button",{className:On+(a?" "+Mn:"")+(t?" "+Pn:""),onClick:function(){return i(e)},children:[(0,r.jsx)("span",{className:Rn,children:s}),(0,r.jsx)("span",{className:In,children:e.getDate()})]},e.toISOString())}))})}),(0,r.jsx)("button",{className:Wn,onClick:function(){return s((function(e){return Xn(Xn({},e),{calendarOpen:!0})}))}}),n.calendarOpen&&(0,r.jsx)(_n,{selectedDate:n.selectedDate,selectedRange:n.selectedRange,onCalendarChange:o,onClose:function(){return s((function(e){return Xn(Xn({},e),{calendarOpen:!1})}))},onClear:l})]})},Qn="CgjxyfEd",$n="RLut3f27",er="slcXbDY8",tr="zRDTHKjp",nr="oAFdJnbK",rr="GUOZxmDe";var ar=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,s=t.length;a<s;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},sr=function(){return sr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},sr.apply(this,arguments)},ir=function(){var e=Be(),t=Ee((function(e){return e.event})),n=t.loading,r=t.error,s=Ee((function(e){return e.filter})),o=function(e,t){var n=(0,a.useState)(e),r=n[0],s=n[1];return(0,a.useEffect)((function(){var n=setTimeout((function(){s(e)}),t);return function(){clearTimeout(n)}}),[e,t]),r}(s,300),c=function(){var e=Ee((function(e){return e.event})).events,t=Ee((function(e){return e.search.value})),n=Ee((function(e){return e.filter})),r=t.trim().toLowerCase(),a=e.filter((function(e){var t=e.title.toLowerCase(),a=!r||t.startsWith(r)||t.includes(r),s=!n.category||e.category&&e.category.trim().toLowerCase()===n.category.trim().toLowerCase(),i=!0,o=(e.date||"").slice(0,10),c=(n.dateRange.start||"").slice(0,10),l=(n.dateRange.end||"").slice(0,10);c&&l?i=o>=c&&o<=l:c?i=o>=c:l&&(i=o<=l);var u=e.price>=n.priceRange.min&&e.price<=n.priceRange.max;return a&&s&&i&&u}));if(r){for(var s=[],i=[],o=0,c=a;o<c.length;o++){var l=c[o],u=l.title.toLowerCase();u.startsWith(r)?s.push(l):u.includes(r)&&i.push(l)}a=ar(ar([],s,!0),i,!0)}return{filteredEvents:a}}().filteredEvents,l=(0,a.useState)(!1),u=l[0],d=l[1],f=Ee((function(e){return e.search.value})),h=Ee((function(e){return e.city.name})),v=Ee((function(e){var t;return(null===(t=e.auth.user)||void 0===t?void 0:t.favorites)||[]})),p=Ee((function(e){return e.auth.isAuthenticated})),m=(0,a.useState)(!1),x=m[0],g=m[1],y=(0,a.useState)(!1),j=y[0],b=y[1];(0,a.useEffect)((function(){var t=sr(sr({},o),{search:f});o.onlyMyCity&&h&&"Город"!==h?t.city=h:delete t.city,e(ee(t))}),[e,o,f,h]),(0,a.useEffect)((function(){var e=null;return n?e=setTimeout((function(){return d(!0)}),250):d(!1),function(){e&&clearTimeout(e)}}),[n]);var w=(0,i.Zp)();return{loading:u,error:r,filteredEvents:c.map((function(e){return sr(sr({},e),{isFavorite:v.includes(e.id)})})),handleAddToFavorites:function(t){p?e(U(t)):g(!0)},handleRemoveFromFavorites:function(t){e(G(t))},handleBuyTicket:function(e){p?w("/buy/".concat(e)):g(!0)},handleDateSelect:function(t){e(ge(sr(sr({},s),{dateRange:{start:t,end:t}})))},handleRangeSelect:function(t,n){e(ge(sr(sr({},s),{dateRange:{start:t,end:n}})))},showAuthAlert:x,setShowAuthAlert:g,showAuthModal:j,setShowAuthModal:b,isAuthenticated:p}};var or={position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.25)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},cr={background:"#fff",borderRadius:12,padding:"2rem 2.5rem",boxShadow:"0 4px 24px rgba(0,0,0,0.13)",minWidth:320,maxWidth:"90vw",textAlign:"center",position:"relative"},lr={marginTop:24,padding:"0.7rem 2.2rem",borderRadius:24,border:"none",background:"#2563eb",color:"#fff",fontWeight:600,fontSize:"1.1rem",cursor:"pointer"},ur={position:"absolute",top:10,right:16,fontSize:22,color:"#888",background:"none",border:"none",cursor:"pointer"};const dr=function(e){var t=e.isOpen,n=e.onClose,s=e.onAuthClick;return(0,a.useEffect)((function(){if(t){var e=function(){if("undefined"==typeof window)return 0;var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.overflow="scroll",e.style.position="absolute",e.style.top="-9999px",document.body.appendChild(e);var t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),t}();document.body.style.overflow="hidden",e>0&&(document.body.style.paddingRight="".concat(e,"px"));var r=function(e){"Escape"===e.key&&n()};return window.addEventListener("keydown",r),function(){document.body.style.overflow="",document.body.style.paddingRight="",window.removeEventListener("keydown",r)}}document.body.style.overflow="",document.body.style.paddingRight=""}),[t,n]),t?(0,r.jsx)("div",{style:or,onClick:n,children:(0,r.jsxs)("div",{style:cr,onClick:function(e){return e.stopPropagation()},children:[(0,r.jsx)("button",{style:ur,onClick:n,"aria-label":"Закрыть",children:"×"}),(0,r.jsx)("div",{style:{fontSize:"1.15rem",color:"#222",marginBottom:16},children:"Для продолжения необходимо войти в аккаунт"}),(0,r.jsx)("button",{style:lr,onClick:s,children:"Войти или зарегистрироваться"})]})}):null};const fr=function(){var e=ir(),t=e.loading,n=e.error,s=e.filteredEvents,i=e.handleAddToFavorites,o=e.handleRemoveFromFavorites,c=e.handleBuyTicket,l=e.handleDateSelect,u=e.handleRangeSelect,d=e.showAuthAlert,f=e.setShowAuthAlert,h=e.showAuthModal,v=e.setShowAuthModal,p=Be(),m=Ee((function(e){return e.auth.isAuthenticated}));return a.useEffect((function(){m&&p(q())}),[m,p]),t?(0,r.jsx)("div",{className:nr,children:"Загрузка..."}):n?(0,r.jsxs)("div",{className:rr,children:["Ошибка: ",n]}):(0,r.jsxs)("div",{className:Qn,children:[(0,r.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"1.5rem",marginBottom:"-1.5rem"},children:(0,r.jsx)(Jn,{onDateSelect:l,onRangeSelect:u})}),(0,r.jsxs)("div",{className:$n,children:[(0,r.jsx)("aside",{className:er,children:(0,r.jsx)(Sn,{})}),(0,r.jsx)("main",{className:tr,children:(0,r.jsx)(un,{events:s,onAddToFavorites:i,onRemoveFromFavorites:o,onBuyTicket:c,loading:t,error:n})})]}),(0,r.jsx)(dr,{isOpen:d,onClose:function(){return f(!1)},onAuthClick:function(){f(!1),v(!0)}}),(0,r.jsx)(Ue,{isOpen:h,onClose:function(){return v(!1)}})]})},hr="Crw2kdr1",vr="C39kYaHZ",pr="wrxPl7G8",mr="IdcN0Kf5",xr="twJoggpY",gr="_3vJED9ON",yr="KJlTLrGi",jr="glgAjrDd",br="dkPJn_jE",wr="cmk1F0Pv",kr="H5IQESIf",Nr="cr0iTSDn",Cr="oRSOIwGU",Sr="DhyDvIL9",Ar="mt2JOtaW",Dr="tth8oZQi",Br="_RzXGQFk",Er="PUoqcH9F",Lr="KhMsW4vD",Tr="G3rIQyMw",Or="f3wr_G8C",Mr="uHtTRs6c",Rr="SeuQM5i6",Pr="uXDX9P80",Ir="ZW_on0Wd",Wr="cnbyq8qV",zr="ZY5CyOvD",Fr="xRLXsmc7",Vr="UOOBhP8t",Ur="F8SWk08z",Gr="XbW9JRyl",qr="Bgg_oSA9",Hr="ocqDJswv",Zr="K_FPgpUV";var Kr=function(e,t,n,r){return new(n||(n=Promise))((function(a,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}c((r=r.apply(e,t||[])).next())}))},Yr=function(e,t){var n,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(s=0)),s;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=s.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}};const _r=function(){var e,t=(0,i.Zp)(),n=Be(),s=Ee((function(e){return e.auth})).user,o=Ee((function(e){return e.event})),c=(o.events,o.loading),l=o.error,u=(0,a.useState)(!1),d=u[0],f=u[1],h=(0,a.useState)(!1),v=h[0],p=h[1],m=(0,a.useState)((null==s?void 0:s.username)||""),x=m[0],g=m[1],y=(0,a.useState)(null),j=y[0],b=y[1],w=Ee((function(e){return e.auth.userTickets||[]}));(0,a.useEffect)((function(){s&&(n(ne()),n(Z()))}),[n,s]);var k=function(){return Kr(void 0,void 0,void 0,(function(){var e;return Yr(this,(function(t){switch(t.label){case 0:return b(null),x.trim()&&x!==(null==s?void 0:s.username)?[4,n(V(x))]:[3,2];case 1:return e=t.sent(),V.fulfilled.match(e)?f(!1):V.rejected.match(e)&&b(e.payload||"Ошибка при обновлении имени"),[3,3];case 2:f(!1),t.label=3;case 3:return[2]}}))}))};return s?c?(0,r.jsx)("div",{className:Ir,children:"Загрузка..."}):l?(0,r.jsx)("div",{className:Wr,children:l}):(0,r.jsx)("div",{className:hr,children:(0,r.jsx)("div",{className:vr,children:(0,r.jsxs)("div",{className:pr,children:[(0,r.jsxs)("div",{className:xr,children:[(0,r.jsx)("div",{className:gr}),(0,r.jsx)("img",{src:s.avatarUrl?s.avatarUrl.startsWith("/uploads")?"".concat(null===(e="https://ebilet-8f91.onrender.com/api")?void 0:e.replace("/api","")).concat(s.avatarUrl):s.avatarUrl:"https://xlittlewretchx.github.io/ebilet/img/default-avatar.svg",alt:"Avatar",className:yr}),(0,r.jsxs)("div",{className:Dr,children:[(0,r.jsxs)("label",{className:Br,children:[(0,r.jsx)("svg",{width:"20",height:"20",fill:"none",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{d:"M4 7a2 2 0 012-2h2.172a2 2 0 001.414-.586l.828-.828A2 2 0 0112.828 3h2.344a2 2 0 011.414.586l.828.828A2 2 0 0020 5h2a2 2 0 012 2v12a2 2 0 01-2 2H4a2 2 0 01-2-2V7zm8 3a4 4 0 100 8 4 4 0 000-8zm0 2a2 2 0 110 4 2 2 0 010-4z",fill:"#2563eb"})}),(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:function(e){return Kr(void 0,void 0,void 0,(function(){var t,r;return Yr(this,(function(a){switch(a.label){case 0:return(t=null===(r=e.target.files)||void 0===r?void 0:r[0])?[4,n(W(t))]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))},style:{display:"none"}})]}),s.avatarUrl&&(0,r.jsx)("button",{className:Er,onClick:function(){return Kr(void 0,void 0,void 0,(function(){return Yr(this,(function(e){switch(e.label){case 0:return[4,n(z())];case 1:return e.sent(),[2]}}))}))},title:"Сбросить аватар",children:(0,r.jsx)("svg",{width:"20",height:"20",fill:"none",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{d:"M6 18L18 6M6 6l12 12",stroke:"#dc3545",strokeWidth:"2",strokeLinecap:"round"})})})]})]}),(0,r.jsx)("div",{className:mr,children:(0,r.jsx)("div",{className:jr,children:d?(0,r.jsxs)("div",{className:Lr,children:[(0,r.jsx)("input",{type:"text",value:x,onChange:function(e){return g(e.target.value)},className:Tr,placeholder:"Введите имя",autoFocus:!0,onKeyDown:function(e){"Enter"===e.key?k():"Escape"===e.key&&(g(s.username),f(!1),b(null))}}),(0,r.jsxs)("div",{className:Or,children:[(0,r.jsx)("button",{type:"button",className:Mr,onClick:k,children:(0,r.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{d:"M5 13l4 4L19 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,r.jsx)("button",{type:"button",className:Rr,onClick:function(){g(s.username),f(!1),b(null)},children:(0,r.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{d:"M6 18L18 6M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})})]}),j&&(0,r.jsx)("div",{className:Zr,children:j})]}):(0,r.jsxs)(r.Fragment,{children:["Привет, ",s.username,"!",(0,r.jsx)("button",{className:Pr,onClick:function(){return f(!0)},children:(0,r.jsxs)("svg",{width:"20",height:"20",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{d:"M4 17.25V19a.75.75 0 00.75.75h1.75a.75.75 0 00.53-.22l9.72-9.72a.75.75 0 000-1.06l-2.25-2.25a.75.75 0 00-1.06 0l-9.72 9.72a.75.75 0 00-.22.53z",stroke:"#2563eb",strokeWidth:"2"}),(0,r.jsx)("path",{d:"M15.5 6.5l2 2",stroke:"#2563eb",strokeWidth:"2",strokeLinecap:"round"})]})})]})})}),(0,r.jsxs)("div",{className:br,children:[(0,r.jsxs)("div",{children:["Email: ",s.email]}),(0,r.jsxs)("div",{children:["Город: ",s.city]})]}),(0,r.jsxs)("div",{className:Nr,children:[(0,r.jsxs)("div",{className:Cr,children:[(0,r.jsx)("div",{className:Sr,children:w.length}),(0,r.jsx)("div",{className:Ar,children:"Куплено билетов"})]}),(0,r.jsxs)("div",{className:Cr,children:[(0,r.jsx)("div",{className:Sr,children:s.favorites?s.favorites.length:0}),(0,r.jsx)("div",{className:Ar,children:"Избранное"})]})]}),(0,r.jsxs)("div",{className:wr,children:[(0,r.jsxs)("button",{className:kr,type:"button",onClick:function(){return t("/my-tickets")},children:[(0,r.jsxs)("svg",{width:"20",height:"20",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{d:"M4 7.5A2.5 2.5 0 016.5 5h11A2.5 2.5 0 0120 7.5v9A2.5 2.5 0 0117.5 19h-11A2.5 2.5 0 014 16.5v-9z",stroke:"#2563eb",strokeWidth:"2"}),(0,r.jsx)("path",{d:"M8 9h8M8 13h5",stroke:"#2563eb",strokeWidth:"2",strokeLinecap:"round"})]}),"Мои билеты"]}),(0,r.jsxs)("button",{className:kr,type:"button",onClick:function(){return t("/my-tickets",{state:{tab:"favorites"}})},children:[(0,r.jsx)("svg",{width:"20",height:"20",fill:"none",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{d:"M12 21s-7-5.686-7-10.5A5.5 5.5 0 0112 5a5.5 5.5 0 017 5.5C19 15.314 12 21 12 21z",stroke:"#2563eb",strokeWidth:"2"})}),"Избранное"]}),(0,r.jsxs)("div",{className:Hr,children:[(0,r.jsxs)("button",{className:kr+" "+zr,type:"button",onClick:function(){return p(!0)},children:[(0,r.jsx)("svg",{width:"20",height:"20",fill:"none",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{d:"M6 18L18 6M6 6l12 12",stroke:"#2563eb",strokeWidth:"2",strokeLinecap:"round"})}),"Выйти"]}),v&&(0,r.jsxs)("div",{className:Fr,children:[(0,r.jsx)("div",{className:Vr,children:"Выйти из аккаунта?"}),(0,r.jsxs)("div",{className:Ur,children:[(0,r.jsx)("button",{className:Gr,onClick:function(){n(_()),p(!1)},children:"Выйти"}),(0,r.jsx)("button",{className:qr,onClick:function(){return p(!1)},children:"Отмена"})]})]})]})]})]})})}):(0,r.jsx)("div",{className:Wr,children:"Пожалуйста, войдите в систему"})},Xr="_ifCH7uh",Jr="GbLO1eUY",Qr="KXB6Wmqr",$r="jmziS_bF",ea="tmOnqDUR",ta="jt9o2PT4",na="G9gCuTYe",ra="Y8ze9CgU";var aa=function(){return aa=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},aa.apply(this,arguments)},sa=function(e,t,n,r){return new(n||(n=Promise))((function(a,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}c((r=r.apply(e,t||[])).next())}))},ia=function(e,t){var n,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(s=0)),s;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=s.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},oa=[{key:"tickets",label:"Мои билеты"},{key:"favorites",label:"Избранное"}];const ca=function(){var e=(0,a.useState)("tickets"),t=e[0],n=e[1],s=Be(),i=Ee((function(e){var t;return(null===(t=e.auth.user)||void 0===t?void 0:t.favorites)||[]})),o=Ee((function(e){return e.event.events})).filter((function(e){return i.includes(e.id)})).map((function(e){return aa(aa({},e),{isFavorite:!0})})),c=Ee((function(e){return e.auth.loading})),l=Ee((function(e){return e.auth.error})),u=Ee((function(e){return e.auth.userTickets||[]})).reduce((function(e,t){return e[t.eventId]?(e[t.eventId].ticketCount+=1,t.seat&&e[t.eventId].ticketSeats.push(t.seat)):e[t.eventId]=aa(aa({},t),{ticketCount:1,ticketSeats:t.seat?[t.seat]:[]}),e}),{}),d=Object.values(u);return(0,a.useEffect)((function(){"tickets"===t?s(Z()):"favorites"===t&&(s(q()),s(ee({})))}),[t,s]),(0,r.jsxs)("div",{className:Xr,children:[(0,r.jsx)("h1",{children:"Мои события"}),(0,r.jsx)("div",{className:Jr,children:oa.map((function(e){return(0,r.jsx)("button",{className:t===e.key?$r:Qr,onClick:function(){return n(e.key)},type:"button",children:e.label},e.key)}))}),(0,r.jsx)("div",{className:ea,children:"tickets"===t?d.length>0?(0,r.jsx)(un,{events:d.map((function(e){return aa(aa({},e),{id:e.eventId,isTicket:!0})})),onAddToFavorites:function(){},onRemoveFromFavorites:function(){},onBuyTicket:function(){},loading:c,error:l}):(0,r.jsxs)("div",{className:ta,children:[(0,r.jsxs)("svg",{className:na,viewBox:"0 0 48 48",fill:"none",children:[(0,r.jsx)("circle",{cx:"24",cy:"24",r:"22",fill:"#e3eaff",stroke:"#bfc8d6",strokeWidth:"2"}),(0,r.jsx)("path",{d:"M16 28c1.5-2 4.5-2 6 0s4.5 2 6 0",stroke:"#bfc8d6",strokeWidth:"2",strokeLinecap:"round"}),(0,r.jsx)("circle",{cx:"18",cy:"20",r:"2",fill:"#bfc8d6"}),(0,r.jsx)("circle",{cx:"30",cy:"20",r:"2",fill:"#bfc8d6"})]}),(0,r.jsx)("div",{className:ra,children:"У вас пока нет купленных билетов"})]}):o.length>0?(0,r.jsx)(un,{events:o,onAddToFavorites:function(){},onRemoveFromFavorites:function(e){return sa(void 0,void 0,void 0,(function(){return ia(this,(function(t){switch(t.label){case 0:return[4,s(G(e))];case 1:return t.sent(),s(q()),s(ee({})),[2]}}))}))},onBuyTicket:function(){},loading:c,error:l}):(0,r.jsxs)("div",{className:ta,children:[(0,r.jsxs)("svg",{className:na,viewBox:"0 0 48 48",fill:"none",children:[(0,r.jsx)("circle",{cx:"24",cy:"24",r:"22",fill:"#e3eaff",stroke:"#bfc8d6",strokeWidth:"2"}),(0,r.jsx)("path",{d:"M16 28c1.5-2 4.5-2 6 0s4.5 2 6 0",stroke:"#bfc8d6",strokeWidth:"2",strokeLinecap:"round"}),(0,r.jsx)("circle",{cx:"18",cy:"20",r:"2",fill:"#bfc8d6"}),(0,r.jsx)("circle",{cx:"30",cy:"20",r:"2",fill:"#bfc8d6"})]}),(0,r.jsx)("div",{className:ra,children:"У вас пока нет избранных событий"})]})})]})},la={legend:"QqPd0FV8",legendItem:"ygmSVDPC",legendBoxFree:"vYb5nAxP",legendBoxSelected:"toGfKC32",legendBoxBooked:"SSv0sTVP",sceneLabel:"YhXIRch9",grid:"WHOT3LXd",gridRow:"PruI0fUR",seatButton:"zYG7EdKs",selected:"WmjPp9x0",booked:"UUCZc1Kq",circleWrapper:"uFc_SGIy",nextButton:"_CzGfsWr",prevButton:"D8AVbEZe",selectedInfo:"VebIyXBU",maxInfo:"LIVnYT_e"};var ua=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,s=t.length;a<s;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};const da="wn8Rbeuu",fa="uxj2vNEo";const ha=function(e){var t=e.children,n=e.title;return(0,r.jsxs)("div",{className:da,children:[(0,r.jsx)("h2",{className:fa,children:n}),t]})},va="sBznJJGu",pa="E6LfH8_L",ma="I6sh7HV8";const xa=function(e){var t=e.onNext,n=e.onBack,a=e.nextText,s=void 0===a?"Далее":a,i=e.isNextDisabled,o=void 0!==i&&i,c=e.isLoading,l=void 0!==c&&c;return(0,r.jsxs)("div",{className:va,children:[n&&(0,r.jsx)("button",{type:"button",onClick:n,className:ma,children:"Назад"}),(0,r.jsx)("button",{type:"Далее"===s?"button":"submit",onClick:"Далее"===s?t:void 0,disabled:o||l,className:pa,children:l?"Загрузка...":s})]})};var ga=[{name:"A",color:"#ffe066",startAngle:228,endAngle:312},{name:"B",color:"#5eb3fa",startAngle:138,endAngle:222},{name:"C",color:"#f7a6c7",startAngle:48,endAngle:132},{name:"D",color:"#8fd18f",startAngle:-42,endAngle:42}];const ya=function(e){var t=e.eventId,n=e.onNext,s=e.onBack,i=e.seatingType,o=void 0===i?"grid":i,c=e.initialSeats,l=void 0===c?null:c,u=function(e){var t=(0,a.useState)([]),n=t[0],r=t[1],s=(0,a.useState)([]),i=s[0],o=s[1],c=(0,a.useState)(!0),l=c[0],u=c[1],d=(0,a.useState)(null),f=d[0],h=d[1];return(0,a.useEffect)((function(){u(!0),T(Number(e)).then((function(e){return r(e)})).catch((function(){return h("Ошибка загрузки мест")})).finally((function(){return u(!1)}))}),[e]),{bookedSeats:n,selectedSeats:i,setSelectedSeats:o,loading:l,error:f,handleSelect:function(e){n.includes(e)||(i.includes(e)?o(i.filter((function(t){return t!==e}))):i.length<10&&o(ua(ua([],i,!0),[e],!1)))}}}(t),d=u.bookedSeats,f=u.selectedSeats,h=u.setSelectedSeats,v=u.loading,p=u.error,m=u.handleSelect;a.useEffect((function(){l&&h(l)}),[]);return v?(0,r.jsx)("div",{children:"Загрузка схемы зала..."}):p?(0,r.jsx)("div",{style:{color:"red"},children:p}):(0,r.jsxs)(ha,{title:"Выбор мест",children:[(0,r.jsxs)("div",{className:la.legend,children:[(0,r.jsxs)("span",{className:la.legendItem,children:[(0,r.jsx)("span",{className:la.legendBoxFree})," свободно"]}),(0,r.jsxs)("span",{className:la.legendItem,children:[(0,r.jsx)("span",{className:la.legendBoxSelected})," выбрано"]}),(0,r.jsxs)("span",{className:la.legendItem,children:[(0,r.jsx)("span",{className:la.legendBoxBooked})," занято"]})]}),"grid"===o&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:la.sceneLabel,children:"Сцена"}),(0,r.jsx)("div",{className:la.grid,children:Array.from({length:5}).map((function(e,t){return(0,r.jsx)("div",{className:la.gridRow,children:Array.from({length:8}).map((function(e,n){var a="".concat(String.fromCharCode(65+t)).concat(n+1),s=d.includes(a),i=f.includes(a);return(0,r.jsx)("button",{disabled:s,className:[la.seatButton,i?la.selected:"",s?la.booked:""].join(" "),onClick:function(){return m(a)},title:s?"Место занято":"Место ".concat(a),"aria-label":"Место ".concat(a).concat(s?" (занято)":i?" (выбрано)":""),children:a},a)}))},t)}))})]}),"circle"===o&&(0,r.jsx)("div",{className:la.circleWrapper,children:(0,r.jsxs)("svg",{width:600,height:600,viewBox:"0 0 600 600",style:{background:"#f8fafd",borderRadius:"8px",boxShadow:"0 2px 16px #2563eb11"},children:[(0,r.jsx)("rect",{x:200,y:220,width:200,height:160,rx:30,fill:"#bfe6ff",stroke:"#222",strokeWidth:2}),(0,r.jsx)("rect",{x:200,y:220,width:200,height:160,rx:30,fill:"none",stroke:"#222",strokeWidth:2}),(0,r.jsx)("text",{x:300,y:305,textAnchor:"middle",fill:"#222",fontSize:32,fontWeight:700,children:"Поле"}),ga.map((function(e,t){var n=e.endAngle-e.startAngle,a=1;return(0,r.jsxs)("g",{children:[(0,r.jsx)("text",{x:300+220*Math.cos((e.startAngle+e.endAngle)/2*Math.PI/180),y:300+220*Math.sin((e.startAngle+e.endAngle)/2*Math.PI/180),textAnchor:"middle",fontSize:28,fontWeight:700,fill:e.color,opacity:.7,children:e.name}),Array.from({length:5}).map((function(t,s){var i=140+32*s;return Array.from({length:7}).map((function(t,s){var o=(e.startAngle+n/6*s)*Math.PI/180,c=300+i*Math.cos(o),l=300+i*Math.sin(o),u="".concat(e.name).concat(a++),h=d.includes(u),v=f.includes(u);return(0,r.jsxs)("g",{style:{cursor:h?"not-allowed":"pointer"},onClick:function(){return m(u)},children:[(0,r.jsx)("rect",{x:c-9,y:l-9,width:18,height:18,rx:4,fill:h?"#ccc":v?"#2563eb":e.color,stroke:v?"#2563eb":"#bbb",strokeWidth:v?2:1,style:{filter:v?"drop-shadow(0 0 8px #2563eb55)":void 0,transition:"all 0.15s"}}),(0,r.jsx)("text",{x:c,y:l+4,textAnchor:"middle",fontSize:10,fontWeight:v?700:400,fill:h?"#888":v?"#fff":"#222",pointerEvents:"none",children:u})]},u)}))}))]},e.name)}))]})}),f.length>0&&(0,r.jsxs)("div",{className:la.selectedInfo,children:["Вы выбрали места: ",(0,r.jsx)("b",{children:f.join(", ")})]}),10===f.length&&(0,r.jsxs)("div",{className:la.maxInfo,children:["Максимум ",10," мест за одну покупку"]}),(0,r.jsx)(xa,{onNext:function(){f.length>0&&n(f)},onBack:s,isNextDisabled:0===f.length})]})},ja={form:"JQaenamU",title:"fYD3qzzd",label:"Zi8nICeP",inputWrapper:"Bhrkreat",input:"Vnk97CON",inputError:"iobB8wwB",icon:"KrJ3p76Z",error:"ARR7gWgw",nextButton:"CHSuyWXX",prevButton:"eowmllqz"};function ba(e){return/.+@.+\..+/.test(e)}function wa(e){return/^\+?\d{10,15}$/.test(e.replace(/\D/g,""))}var ka=function(){return ka=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},ka.apply(this,arguments)};const Na=function(e){var t=e.initialEmail,n=e.initialData,s=e.onNext,i=e.onBack,o=function(e){var t=(0,a.useState)(""),n=t[0],r=t[1],s=(0,a.useState)(""),i=s[0],o=s[1],c=(0,a.useState)(e),l=c[0],u=c[1],d=(0,a.useState)({}),f=d[0],h=d[1],v=n.trim().length>2&&wa(i)&&ba(l);return{name:n,setName:r,phone:i,setPhone:o,email:l,setEmail:u,touched:f,setTouched:h,isValid:v}}((null==n?void 0:n.email)||t),c=o.name,l=o.setName,u=o.phone,d=o.setPhone,f=o.email,h=o.setEmail,v=o.touched,p=o.setTouched,m=o.isValid;a.useEffect((function(){n&&(l(n.name),d(n.phone),h(n.email))}),[]);return(0,r.jsx)(ha,{title:"Ваши данные",children:(0,r.jsxs)("form",{className:ja.form,onSubmit:function(e){e.preventDefault(),m&&s({name:c,phone:u,email:f})},autoComplete:"off",children:[(0,r.jsxs)("label",{className:ja.label,children:[(0,r.jsx)("span",{style:{marginBottom:2},children:"ФИО"}),(0,r.jsxs)("div",{className:ja.inputWrapper,children:[(0,r.jsx)("input",{value:c,onChange:function(e){return l(e.target.value)},onBlur:function(){return p((function(e){return ka(ka({},e),{name:!0})}))},placeholder:"Иванов Иван Иванович",className:[ja.input,v.name&&c.trim().length<3?ja.inputError:""].join(" "),autoComplete:"off"}),(0,r.jsx)("span",{className:ja.icon,children:"👤"})]}),v.name&&c.trim().length<3&&(0,r.jsx)("span",{className:ja.error,children:"Введите полное имя"})]}),(0,r.jsxs)("label",{className:ja.label,children:[(0,r.jsx)("span",{style:{marginBottom:2},children:"Телефон"}),(0,r.jsxs)("div",{className:ja.inputWrapper,children:[(0,r.jsx)("input",{value:u,onChange:function(e){return d(e.target.value)},onBlur:function(){return p((function(e){return ka(ka({},e),{phone:!0})}))},placeholder:"+79991234567",className:[ja.input,v.phone&&!wa(u)?ja.inputError:""].join(" "),autoComplete:"off"}),(0,r.jsx)("span",{className:ja.icon,children:"📱"})]}),v.phone&&!wa(u)&&(0,r.jsx)("span",{className:ja.error,children:"Введите корректный телефон"})]}),(0,r.jsxs)("label",{className:ja.label,children:[(0,r.jsx)("span",{style:{marginBottom:2},children:"Email"}),(0,r.jsxs)("div",{className:ja.inputWrapper,children:[(0,r.jsx)("input",{value:f,onChange:function(e){return h(e.target.value)},onBlur:function(){return p((function(e){return ka(ka({},e),{email:!0})}))},placeholder:"email@example.com",className:[ja.input,v.email&&!ba(f)?ja.inputError:""].join(" "),autoComplete:"off"}),(0,r.jsx)("span",{className:ja.icon,children:"✉️"})]}),v.email&&!ba(f)&&(0,r.jsx)("span",{className:ja.error,children:"Введите корректный email"})]}),(0,r.jsx)(xa,{onNext:function(){m&&s({name:c,phone:u,email:f})},onBack:i,isNextDisabled:!m,nextText:"Далее"})]})})},Ca={form:"QycDKdvc",title:"LDOLPptO",summary:"HtnMLkF8",eventTitle:"Du3sS5fC",amount:"ZTOixN9M",label:"uiyLXLFg",input:"KwwEtING",inputError:"FF04EcMe",error:"GkJb6cu3",row:"DWwNWj5V",secure:"Pf0xbG7E",secureIcon:"Y0dVczYb",payButton:"cPGPhgF0",prevButton:"ChaCUGzt"};var Sa=function(){return Sa=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Sa.apply(this,arguments)};const Aa=function(e){var t=e.eventTitle,n=e.amount,s=e.onPay,i=e.loading,o=e.onBack,c=function(){var e=(0,a.useState)(""),t=e[0],n=e[1],r=(0,a.useState)(""),s=r[0],i=r[1],o=(0,a.useState)(""),c=o[0],l=o[1],u=(0,a.useState)({}),d=u[0],f=u[1],h=(0,a.useRef)(null),v=(0,a.useRef)(null),p=16===t.replace(/\s/g,"").length,m=/^\d{2}\/\d{2}$/.test(s)&&function(){var e=s.split("/").map(Number),t=e[0],n=e[1];if(t<1||t>12)return!1;var r=new Date,a=2e3+n,i=r.getFullYear(),o=r.getMonth()+1;return a>i||a===i&&t>=o}(),x=/^\d{3}$/.test(c);return{card:t,setCard:n,date:s,setDate:i,cvv:c,setCvv:l,touched:d,setTouched:f,dateRef:h,cvvRef:v,formatCardNumber:function(e){return e.replace(/\D/g,"").replace(/(.{4})/g,"$1 ").trim()},isCardValid:p,isDateValid:m,isCvvValid:x,isValid:p&&m&&x}}(),l=c.card,u=c.setCard,d=c.date,f=c.setDate,h=c.cvv,v=c.setCvv,p=c.touched,m=c.setTouched,x=c.dateRef,g=c.cvvRef,y=c.formatCardNumber,j=c.isCardValid,b=c.isDateValid,w=c.isCvvValid,k=c.isValid;return(0,r.jsxs)("form",{className:Ca.form,onSubmit:function(e){e.preventDefault(),k&&!i&&s()},autoComplete:"off",children:[(0,r.jsx)("h2",{className:Ca.title,children:"Оплата билета"}),(0,r.jsxs)("div",{className:Ca.summary,children:[(0,r.jsx)("div",{className:Ca.eventTitle,children:t}),(0,r.jsxs)("div",{className:Ca.amount,children:["Сумма к оплате: ",(0,r.jsxs)("b",{children:[n," ₽"]})]})]}),(0,r.jsxs)("label",{className:Ca.label,children:[(0,r.jsx)("span",{children:"Номер карты"}),(0,r.jsx)("input",{value:l,onChange:function(e){var t=e.target.value.replace(/[^\d ]/g,"");u(t),16===t.replace(/\s/g,"").length&&x.current&&x.current.focus()},onBlur:function(e){m((function(e){return Sa(Sa({},e),{card:!0})})),u(y(e.target.value))},placeholder:"0000 0000 0000 0000",maxLength:19,className:[Ca.input,p.card&&!j?Ca.inputError:""].join(" ")}),p.card&&!j&&(0,r.jsx)("span",{className:Ca.error,children:"Введите 16 цифр"})]}),(0,r.jsxs)("div",{className:Ca.row,children:[(0,r.jsxs)("label",{className:Ca.label,style:{flex:1},children:[(0,r.jsx)("span",{children:"Срок"}),(0,r.jsx)("input",{ref:x,value:d,onChange:function(e){var t=e.target.value.replace(/[^\d/]/g,"");2===t.length&&1===d.length&&(t+="/"),t.length>5&&(t=t.slice(0,5)),f(t),/^\d{2}\/\d{2}$/.test(t)&&b&&g.current&&g.current.focus()},onBlur:function(){return m((function(e){return Sa(Sa({},e),{date:!0})}))},placeholder:"MM/YY",maxLength:5,className:[Ca.input,p.date&&!b?Ca.inputError:""].join(" ")}),p.date&&!b&&(0,r.jsx)("span",{className:Ca.error,children:"Месяц/год некорректны"})]}),(0,r.jsxs)("label",{className:Ca.label,style:{flex:1},children:[(0,r.jsx)("span",{children:"CVV"}),(0,r.jsx)("input",{ref:g,value:h,onChange:function(e){var t=e.target.value.replace(/[^\d]/g,"").slice(0,3);v(t)},onBlur:function(){return m((function(e){return Sa(Sa({},e),{cvv:!0})}))},placeholder:"123",maxLength:3,className:[Ca.input,p.cvv&&!w?Ca.inputError:""].join(" "),type:"password"}),p.cvv&&!w&&(0,r.jsx)("span",{className:Ca.error,children:"3 цифры"})]})]}),(0,r.jsxs)("div",{className:Ca.secure,children:[(0,r.jsx)("span",{className:Ca.secureIcon,children:"🔒"})," Платёж защищён"]}),(0,r.jsxs)("div",{style:{display:"flex",gap:8,marginTop:8},children:[o&&(0,r.jsx)("button",{type:"button",onClick:o,className:Ca.prevButton,children:"Назад"}),(0,r.jsx)("button",{type:"submit",disabled:!k||i,className:Ca.payButton,children:i?"Оплата...":"Оплатить"})]})]})},Da="QWTwTtq2",Ba="Ap76OYc5",Ea="H_ripnUi",La="oJ9ZfkGY",Ta="K2qtJgrt",Oa="WLR0Uhe3",Ma="mvIixGhh",Ra="ULuQsCua",Pa="Kbs3XE4F";const Ia=function(e){var t=e.eventTitle,n=e.places,a=e.count,s=e.onGoToTickets,i=e.onGoHome;return(0,r.jsxs)("div",{className:Da,children:[(0,r.jsx)("div",{className:Ba,children:"🎉"}),(0,r.jsx)("h2",{className:Ea,children:"Покупка успешна!"}),(0,r.jsxs)("div",{className:La,children:[(0,r.jsx)("div",{className:Ta,children:t}),n&&n.length>0&&(0,r.jsxs)("div",{className:Oa,children:["Места: ",n.join(", ")]}),a&&(0,r.jsxs)("div",{className:Oa,children:["Количество: ",a]})]}),(0,r.jsx)("button",{onClick:s,className:Ma,children:"Мои билеты"}),(0,r.jsx)("button",{onClick:i,className:Ra,children:"На главную"}),(0,r.jsx)("div",{className:Pa,children:"Спасибо за покупку! Желаем приятного посещения 🎫"})]})},Wa="PFCYxcZh",za="sOnqGhiS",Fa="iKocadxu",Va="NGZsBkju";const Ua=function(e){var t=e.onNext,n=e.onBack,s=e.initialCount,i=function(e){void 0===e&&(e=1);var t=(0,a.useState)(e),n=t[0],r=t[1];return{count:n,setCount:function(e){return r(Math.max(1,Math.min(10,e)))},decrement:function(){return r((function(e){return Math.max(1,e-1)}))},increment:function(){return r((function(e){return Math.min(10,e+1)}))}}}(void 0===s?1:s),o=i.count,c=i.decrement,l=i.increment,u=i.setCount;return(0,r.jsxs)(ha,{title:"Выбор количества билетов",children:[(0,r.jsxs)("div",{className:Wa,children:[(0,r.jsx)("button",{onClick:c,disabled:1===o,className:za,"aria-label":"Уменьшить количество",children:"-"}),(0,r.jsx)("input",{type:"number",min:1,max:10,value:o,onChange:function(e){return u(Number(e.target.value))},className:Fa,"aria-label":"Количество билетов"}),(0,r.jsx)("button",{onClick:l,disabled:10===o,className:za,"aria-label":"Увеличить количество",children:"+"})]}),(0,r.jsxs)("div",{className:Va,children:["Максимум ",10," билетов за одну покупку"]}),(0,r.jsx)(xa,{onNext:function(){return t(o)},onBack:n})]})};var Ga={success:"#4BB543",error:"#e74c3c",info:"#2563eb"};const qa=function(e){var t=e.message,n=e.type,s=void 0===n?"info":n,i=e.onClose,o=e.duration,c=void 0===o?3e3:o;return(0,a.useEffect)((function(){var e=setTimeout(i,c);return function(){return clearTimeout(e)}}),[i,c]),(0,r.jsxs)("div",{style:{position:"fixed",top:24,right:24,zIndex:9999,background:Ga[s],color:"#fff",padding:"14px 28px",borderRadius:8,fontSize:17,fontWeight:600,boxShadow:"0 4px 16px #0002",minWidth:220,display:"flex",alignItems:"center",gap:12,animation:"toast-in 0.3s"},children:["success"===s&&(0,r.jsx)("span",{style:{fontSize:22},children:"✔️"}),"error"===s&&(0,r.jsx)("span",{style:{fontSize:22},children:"❌"}),"info"===s&&(0,r.jsx)("span",{style:{fontSize:22},children:"ℹ️"}),(0,r.jsx)("span",{children:t}),(0,r.jsx)("button",{onClick:i,style:{marginLeft:"auto",background:"none",border:"none",color:"#fff",fontSize:20,cursor:"pointer"},children:"×"}),(0,r.jsx)("style",{children:"\n        @keyframes toast-in { from { opacity: 0; transform: translateY(-20px);} to { opacity: 1; transform: none;}}\n      "})]})};var Ha=function(){return Ha=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Ha.apply(this,arguments)},Za=function(e,t,n,r){return new(n||(n=Promise))((function(a,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}c((r=r.apply(e,t||[])).next())}))},Ka=function(e,t){var n,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(s=0)),s;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=s.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}};const Ya=function(){var e=(0,i.g)().eventId,t=void 0===e?"":e,n=(0,i.Zp)(),s=(0,c.wA)(),o=(0,c.d4)((function(e){var t;return(null===(t=e.auth.user)||void 0===t?void 0:t.email)||""})),l=(0,a.useState)(0),u=l[0],d=l[1],f=(0,a.useState)({count:1,seat:null,userData:null}),h=f[0],v=f[1],p=(0,a.useState)(!1),m=p[0],x=p[1],g=(0,a.useState)(null),y=g[0],j=g[1],b=(0,a.useState)(null),w=b[0],k=b[1],N=(0,a.useState)(!0),C=N[0],S=N[1],A=(0,a.useState)(null),D=A[0],E=A[1],L=(0,a.useState)(null),T=L[0],O=L[1];(0,a.useEffect)((function(){S(!0),B(Number(t)).then(k).catch((function(){return E("Ошибка загрузки события")})).finally((function(){return S(!1)}))}),[t]);var M=[],R=function(){j(null),d(u+1)},P=function(){j(null),d(u-1)};return C?(0,r.jsx)("div",{children:"Загрузка события..."}):D||!w?(0,r.jsx)("div",{style:{color:"red"},children:D||"Событие не найдено"}):("grid"===w.seatingType||"circle"===w.seatingType?M.push((0,r.jsx)(ya,{eventId:t,seatingType:w.seatingType,onNext:function(e){v((function(t){return Ha(Ha({},t),{seat:e})})),R()},onBack:u>0?P:void 0,initialSeats:h.seat},"choose-seat")):"none"===w.seatingType&&M.push((0,r.jsx)(Ua,{onNext:function(e){v((function(t){return Ha(Ha({},t),{count:e,seat:null})})),R()},onBack:u>0?P:void 0,initialCount:h.count},"choose-count")),M.push((0,r.jsx)(Na,{initialEmail:o,initialData:h.userData,onNext:function(e){v((function(t){return Ha(Ha({},t),{userData:e})})),R()},onBack:P},"user-data")),M.push((0,r.jsx)(Aa,{eventTitle:w.title,amount:w.price*("none"===w.seatingType?h.count:Array.isArray(h.seat)?h.seat.length:1),onPay:function(){return Za(void 0,void 0,void 0,(function(){var e,n,r,a,i,o;return Ka(this,(function(c){switch(c.label){case 0:if(!h.userData)return[2];x(!0),j(null),O(null),c.label=1;case 1:return c.trys.push([1,4,5,6]),e=h.seat,"none"===w.seatingType&&(e=Array(h.count).fill(null)),[4,s(H(Ha({eventId:Number(t),seat:Array.isArray(e)&&1===e.length?e[0]:e},h.userData)))];case 2:return c.sent(),[4,s(Z())];case 3:return c.sent(),O({message:"Билеты успешно куплены!",type:"success"}),R(),[3,6];case 4:return n=c.sent(),j((null==n?void 0:n.message)||(null===(a=null===(r=null==n?void 0:n.response)||void 0===r?void 0:r.data)||void 0===a?void 0:a.message)||"Ошибка при покупке билета"),O({message:(null==n?void 0:n.message)||(null===(o=null===(i=null==n?void 0:n.response)||void 0===i?void 0:i.data)||void 0===o?void 0:o.message)||"Ошибка при покупке билета",type:"error"}),[3,6];case 5:return x(!1),[7];case 6:return[2]}}))}))},loading:m,onBack:P},"payment")),M.push((0,r.jsx)(Ia,{eventTitle:w.title,places:Array.isArray(h.seat)?h.seat:void 0,count:"none"===w.seatingType?h.count:Array.isArray(h.seat)?h.seat.length:1,onGoToTickets:function(){return n("/my-tickets")},onGoHome:function(){return n("/")}},"success")),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{children:"Покупка билета"}),m&&(0,r.jsx)("p",{children:"Покупка билета..."}),y&&(0,r.jsx)("p",{style:{color:"red"},children:y}),T&&(0,r.jsx)(qa,{message:T.message,type:T.type,onClose:function(){return O(null)}}),M[u]]}))};const _a=function(e){var t=e.children;return Ee((function(e){return e.auth})).isAuthenticated?(0,r.jsx)(r.Fragment,{children:t}):(0,r.jsx)(i.C5,{to:"/",replace:!0})},Xa="oNLuKqJw",Ja="QPT3LbSV";var Qa=function(){return(0,a.useEffect)((function(){De.dispatch(K())}),[]),(0,r.jsxs)("div",{className:Xa,children:[(0,r.jsx)(Zt,{}),(0,r.jsx)("main",{className:Ja,children:(0,r.jsxs)(i.BV,{children:[(0,r.jsx)(i.qh,{path:"/",element:(0,r.jsx)(fr,{})}),(0,r.jsx)(i.qh,{path:"/profile",element:(0,r.jsx)(_a,{children:(0,r.jsx)(_r,{})})}),(0,r.jsx)(i.qh,{path:"/my-tickets",element:(0,r.jsx)(_a,{children:(0,r.jsx)(ca,{})})}),(0,r.jsx)(i.qh,{path:"/buy/:eventId",element:(0,r.jsx)(Ya,{})})]})})]})};const $a=function(){return(0,r.jsx)(c.Kq,{store:De,children:(0,r.jsx)(o.Kd,{basename:"/ebilet",children:(0,r.jsx)(Qa,{})})})};s.createRoot(document.getElementById("root")).render((0,r.jsx)(a.StrictMode,{children:(0,r.jsx)($a,{})}))}},e=>{e.O(0,[720],(()=>{return t=703,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=main.a3c4d03b.js.map