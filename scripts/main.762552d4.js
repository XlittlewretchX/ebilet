"use strict";(self.webpackChunkebilet_client=self.webpackChunkebilet_client||[]).push([[792],{45:(e,n,t)=>{var r=t(848),a=t(540),s=t(338),i=t(976),o=t(767),c=t(468),l=t(816),u=t(83),d=function(e,n,t,r){return new(t||(t=Promise))((function(a,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,o)}c((r=r.apply(e,n||[])).next())}))},f=function(e,n){var t,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(o){return function(c){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(s=0)),s;)try{if(t=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=s.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=n.call(e,s)}catch(e){o=[6,e],r=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},h=u.A.create({baseURL:"https://ebilet-8f91.onrender.com/api",headers:{"Content-Type":"application/json"}});h.interceptors.request.use((function(e){var n=localStorage.getItem("token");return n&&(e.headers.Authorization="Bearer ".concat(n)),e}));var p,v=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(n){switch(n.label){case 0:return[4,h.post("/auth/register",e)];case 1:return[2,n.sent().data]}}))}))},m=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(n){switch(n.label){case 0:return[4,h.post("/auth/login",e)];case 1:return[2,n.sent().data]}}))}))},y=function(e){return d(void 0,void 0,void 0,(function(){var n;return f(this,(function(t){switch(t.label){case 0:return(n=new FormData).append("avatar",e),[4,h.post("/auth/avatar",n,{headers:{"Content-Type":"multipart/form-data"}})];case 1:return[2,t.sent().data]}}))}))},j=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(n){switch(n.label){case 0:return[4,h.patch("/auth/city",{city:e})];case 1:return[2,n.sent().data]}}))}))},x=function(){return d(void 0,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,h.get("/events")];case 1:return[2,e.sent().data]}}))}))},b=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(n){switch(n.label){case 0:return[4,h.get("/events/".concat(e))];case 1:return[2,n.sent().data]}}))}))},g=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(n){switch(n.label){case 0:return[4,h.post("/events",e,{headers:{"Content-Type":"multipart/form-data"}})];case 1:return[2,n.sent().data]}}))}))},w=function(){return d(void 0,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,h.get("/events/user/events")];case 1:return[2,e.sent().data]}}))}))},N=function(e,n,t,r){return new(t||(t=Promise))((function(a,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,o)}c((r=r.apply(e,n||[])).next())}))},k=function(e,n){var t,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(o){return function(c){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(s=0)),s;)try{if(t=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=s.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=n.call(e,s)}catch(e){o=[6,e],r=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},C={user:null,token:localStorage.getItem("token"),isAuthenticated:!1,loading:!1,error:null},S=(0,l.zD)("auth/register",(function(e,n){return N(void 0,[e,n],void 0,(function(e,n){var t,r,a,s=n.rejectWithValue;return k(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,v(e)];case 1:return t=n.sent(),localStorage.setItem("token",t.token),[2,t];case 2:return r=n.sent(),(a=r).response&&a.response.data&&a.response.data.message?[2,s(a.response.data.message)]:[2,s("Ошибка при регистрации")];case 3:return[2]}}))}))})),O=(0,l.zD)("auth/login",(function(e,n){return N(void 0,[e,n],void 0,(function(e,n){var t,r,a,s=n.rejectWithValue;return k(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,m(e)];case 1:return t=n.sent(),localStorage.setItem("token",t.token),[2,t];case 2:return r=n.sent(),(a=r).response&&a.response.data&&a.response.data.message?[2,s(a.response.data.message)]:[2,s("Ошибка при входе")];case 3:return[2]}}))}))})),P=(0,l.zD)("auth/uploadAvatar",(function(e){return N(void 0,void 0,void 0,(function(){return k(this,(function(n){switch(n.label){case 0:return[4,y(e)];case 1:return[2,n.sent()]}}))}))})),E=(0,l.zD)("auth/updateCity",(function(e,n){return N(void 0,[e,n],void 0,(function(e,n){var t=n.rejectWithValue;return k(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,j(e)];case 1:return[2,n.sent().city];case 2:return n.sent(),[2,t("Ошибка при обновлении города")];case 3:return[2]}}))}))})),I=(0,l.Z0)({name:"auth",initialState:C,reducers:{logout:function(e){e.user=null,e.token=null,e.isAuthenticated=!1,localStorage.removeItem("token")},clearError:function(e){e.error=null}},extraReducers:function(e){e.addCase(S.pending,(function(e){e.loading=!0,e.error=null})).addCase(S.fulfilled,(function(e,n){e.loading=!1,e.isAuthenticated=!0,e.user=n.payload.user,e.token=n.payload.token})).addCase(S.rejected,(function(e,n){e.loading=!1,e.error=n.payload||n.error.message||"Ошибка при регистрации"})).addCase(O.pending,(function(e){e.loading=!0,e.error=null})).addCase(O.fulfilled,(function(e,n){e.loading=!1,e.isAuthenticated=!0,e.user=n.payload.user,e.token=n.payload.token})).addCase(O.rejected,(function(e,n){e.loading=!1,e.error=n.payload||n.error.message||"Ошибка при входе"})).addCase(P.fulfilled,(function(e,n){e.user&&(e.user.avatarUrl=n.payload.avatarUrl)})).addCase(E.fulfilled,(function(e,n){e.user&&(e.user.city=n.payload)}))}}),R=(p=I.actions).logout;p.clearError;const F=I.reducer;var T=function(e,n,t,r){return new(t||(t=Promise))((function(a,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,o)}c((r=r.apply(e,n||[])).next())}))},A=function(e,n){var t,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(o){return function(c){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(s=0)),s;)try{if(t=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=s.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=n.call(e,s)}catch(e){o=[6,e],r=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},D=(0,l.zD)("event/fetchEvents",(function(){return T(void 0,void 0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,x()];case 1:return[2,e.sent()]}}))}))})),B=((0,l.zD)("event/fetchEventById",(function(e){return T(void 0,void 0,void 0,(function(){return A(this,(function(n){switch(n.label){case 0:return[4,b(e)];case 1:return[2,n.sent()]}}))}))})),(0,l.zD)("event/createEvent",(function(e){return T(void 0,void 0,void 0,(function(){return A(this,(function(n){switch(n.label){case 0:return[4,g(e)];case 1:return[2,n.sent()]}}))}))}))),z=(0,l.zD)("event/fetchUserEvents",(function(){return T(void 0,void 0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,w()];case 1:return[2,e.sent()]}}))}))})),M=(0,l.Z0)({name:"event",initialState:{events:[],loading:!1,error:null},reducers:{clearError:function(e){e.error=null}},extraReducers:function(e){e.addCase(D.pending,(function(e){e.loading=!0,e.error=null})).addCase(D.fulfilled,(function(e,n){e.loading=!1,e.events=n.payload})).addCase(D.rejected,(function(e,n){e.loading=!1,e.error=n.error.message||"Ошибка при загрузке событий"})).addCase(B.pending,(function(e){e.loading=!0,e.error=null})).addCase(B.fulfilled,(function(e,n){e.loading=!1,e.events.unshift(n.payload)})).addCase(B.rejected,(function(e,n){e.loading=!1,e.error=n.error.message||"Ошибка при создании события"})).addCase(z.pending,(function(e){e.loading=!0,e.error=null})).addCase(z.fulfilled,(function(e,n){e.loading=!1,e.events=n.payload})).addCase(z.rejected,(function(e,n){e.loading=!1,e.error=n.error.message||"Ошибка при загрузке событий пользователя"}))}});M.actions.clearError;const V=M.reducer;var q,G=function(e,n,t,r){return new(t||(t=Promise))((function(a,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,o)}c((r=r.apply(e,n||[])).next())}))},Y=function(e,n){var t,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(o){return function(c){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(s=0)),s;)try{if(t=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=s.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=n.call(e,s)}catch(e){o=[6,e],r=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},U=(0,l.zD)("city/fetchByIP",(function(e,n){return G(void 0,[e,n],void 0,(function(e,n){var t,r,a,s,i,o,c,l,u,d,f,h,p,v,m,y=n.rejectWithValue;return Y(this,(function(e){switch(e.label){case 0:return e.trys.push([0,6,,7]),t="https://api.ipgeolocation.io/ipgeo?apiKey=".concat("90cea4be77d44b80ab21374726d21b70"),[4,fetch(t)];case 1:return(r=e.sent()).ok?[4,r.json()]:[2,y("Ошибка API: ".concat(r.status))];case 2:return a=e.sent(),s=a.city,i=a.latitude,o=a.longitude,i&&o?(c="https://nominatim.openstreetmap.org/reverse?lat=".concat(i,"&lon=").concat(o,"&format=json&accept-language=ru"),[4,fetch(c,{headers:{"User-Agent":"ebilet-app/1.0 (your@email.com)"}})]):[2,s||"Город"];case 3:return(l=e.sent()).ok?[4,l.json()]:[3,5];case 4:if(u=e.sent(),d=(null===(h=u.address)||void 0===h?void 0:h.city)||(null===(p=u.address)||void 0===p?void 0:p.town)||(null===(v=u.address)||void 0===v?void 0:v.village)||(null===(m=u.address)||void 0===m?void 0:m.state),console.log(u.address.city),console.log(u.address.suburb),console.log(u.address.road),console.log(u.address.house_number),d)return[2,d];e.label=5;case 5:return[2,s||"Город"];case 6:return f=e.sent(),[2,y(f.message)];case 7:return[2]}}))}))})),_=(0,l.Z0)({name:"city",initialState:{name:"Город",showPicker:!1},reducers:{openPicker:function(e){e.showPicker=!0},closePicker:function(e){e.showPicker=!1},setCity:function(e,n){e.name=n.payload,e.showPicker=!1}},extraReducers:function(e){e.addCase(U.fulfilled,(function(e,n){var t=n.payload;e.name=t,e.showPicker=!1})).addCase(U.rejected,(function(e){e.showPicker=!0}))}}),L=((q=_.actions).openPicker,q.closePicker,q.setCity);const X=_.reducer;var Z=(0,l.U1)({reducer:{auth:F,event:V,city:X}}),K=function(){return(0,c.wA)()},H=c.d4;const J="bpPJIY6U",W="bjtsBS8k",Q="EDhKdpc7",$="yyzd7YrG",ee="Kjv9kV1L",ne="IAgmSXvg",te="uZZ_BM0m";var re=function(){return re=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},re.apply(this,arguments)},ae=function(e,n,t,r){return new(t||(t=Promise))((function(a,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,o)}c((r=r.apply(e,n||[])).next())}))},se=function(e,n){var t,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(o){return function(c){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(s=0)),s;)try{if(t=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=s.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=n.call(e,s)}catch(e){o=[6,e],r=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},ie=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)n.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(t[r[a]]=e[r[a]])}return t};const oe=function(e){var n=e.isOpen,t=e.onClose,s=K(),i=H((function(e){return e.auth})),o=i.loading,c=i.error,l=i.isAuthenticated,u=H((function(e){return e.city.name})),d=(0,a.useState)(!0),f=d[0],h=d[1],p=(0,a.useState)({username:"",email:"",password:"",confirmPassword:""}),v=p[0],m=p[1],y=(0,a.useState)(""),j=y[0],x=y[1],b=function(e){var n;m(re(re({},v),((n={})[e.target.name]=e.target.value,n)))};return(0,a.useEffect)((function(){n&&l&&f&&t()}),[l,n,f,t]),(0,a.useEffect)((function(){n&&(m({username:"",email:"",password:"",confirmPassword:""}),x(""))}),[n,f]),n?(0,r.jsx)("div",{className:J,onClick:t,children:(0,r.jsxs)("div",{className:W,onClick:function(e){return e.stopPropagation()},children:[(0,r.jsx)("button",{className:Q,onClick:t,children:"×"}),(0,r.jsx)("h2",{children:f?"Вход":"Регистрация"}),(0,r.jsxs)("form",{onSubmit:function(e){return ae(void 0,void 0,void 0,(function(){var n,r,a;return se(this,(function(i){switch(i.label){case 0:return e.preventDefault(),f||v.password===v.confirmPassword?f?(v.email,v.confirmPassword,n=ie(v,["email","confirmPassword"]),[4,s(O(n))]):[3,2]:(alert("Пароли не совпадают"),[2]);case 1:return i.sent(),[3,4];case 2:return v.confirmPassword,r=ie(v,["confirmPassword"]),[4,s(S(re(re({},r),{city:u})))];case 3:a=i.sent(),S.fulfilled.match(a)&&(x("Вы успешно зарегистрировались!"),setTimeout((function(){x(""),t()}),1500)),i.label=4;case 4:return[2]}}))}))},children:[(0,r.jsx)("div",{className:$,children:(0,r.jsx)("input",{type:"text",name:"username",placeholder:"Имя пользователя",value:v.username,onChange:b,required:!0})}),!f&&(0,r.jsx)("div",{className:$,children:(0,r.jsx)("input",{type:"email",name:"email",placeholder:"Email",value:v.email,onChange:b,required:!0})}),(0,r.jsx)("div",{className:$,children:(0,r.jsx)("input",{type:"password",name:"password",placeholder:"Пароль",value:v.password,onChange:b,required:!0})}),!f&&(0,r.jsx)("div",{className:$,children:(0,r.jsx)("input",{type:"password",name:"confirmPassword",placeholder:"Подтвердите пароль",value:v.confirmPassword,onChange:b,required:!0})}),(0,r.jsx)("button",{type:"submit",disabled:o,children:o?"Загрузка...":f?"Войти":"Зарегистрироваться"}),c&&(0,r.jsx)("p",{className:ee,children:c}),j&&(0,r.jsx)("p",{className:ne,children:j})]}),(0,r.jsxs)("p",{className:te,children:[f?"Нет аккаунта?":"Уже есть аккаунт?"," ",(0,r.jsx)("button",{onClick:function(){return h(!f)},children:f?"Зарегистрироваться":"Войти"})]})]})}):null},ce="k5rxhHqu",le="mTFHSVjn",ue="AQj0qjGu",de="NLW9Mru1",fe="JUFDT6sE",he="IecoVAa_",pe="ohMFSmtb",ve="ZykafPsT",me="AMkCxMZ5",ye="eSE1oGM8",je="OQXaY7qu",xe="YpBllFSl",be="zVBLGTS5",ge="BMrkEVHo",we="JtP_ltPL",Ne="rtCQt7XI",ke="kwHSCM5d",Ce="lAVIIIFv",Se="XapMHCuM",Oe="FV9PH3Y9",Pe="YRk2MqKD",Ee="FuZjbqe_",Ie="fA1OvUlR",Re="wwQn_1wS",Fe="jXt8BEh2",Te="X4PUdjG7";var Ae=function(){return(0,r.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{marginRight:6},children:(0,r.jsx)("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z",fill:"#007bff"})})};const De=function(){var e=K(),n=H((function(e){return e.city})).name,t=H((function(e){return e.auth})),s=t.isAuthenticated,i=t.user,o=(0,a.useState)(!1),c=o[0],l=o[1],u=(0,a.useState)(""),d=u[0],f=u[1],h=s?(null==i?void 0:i.city)||"Город":n;return a.useEffect((function(){f(h)}),[h]),(0,r.jsxs)("div",{className:Oe,children:[(0,r.jsxs)("button",{className:Pe,onClick:function(){return l(!0)},"aria-label":"Выбрать город",children:[(0,r.jsx)(Ae,{}),(0,r.jsx)("span",{className:Ee,children:h})]}),c&&(0,r.jsx)("div",{className:Ie,onClick:function(){return l(!1)},children:(0,r.jsxs)("div",{className:Re,onClick:function(e){return e.stopPropagation()},children:[(0,r.jsx)("input",{className:Fe,value:d,onChange:function(e){return f(e.target.value)},placeholder:"Введите город",autoFocus:!0}),(0,r.jsxs)("div",{className:Te,children:[(0,r.jsx)("button",{className:Ce,onClick:function(){d.trim()&&(s?(e(E(d.trim())),e(L(d.trim()))):e(L(d.trim())),l(!1))},children:"Сохранить"}),(0,r.jsx)("button",{className:Se,onClick:function(){return l(!1)},children:"Отмена"})]})]})})]})};const Be=function(){var e=K(),n=H((function(e){return e.auth})),t=n.user,s=n.isAuthenticated,o=(0,a.useState)(!1),c=o[0],l=o[1],u=(0,a.useState)(!1),d=u[0],f=u[1],h=(0,a.useState)(!1),p=h[0],v=h[1],m=(0,a.useState)(""),y=m[0],j=m[1];(0,a.useEffect)((function(){s?(null==t?void 0:t.city)&&"Город"!==t.city?e(L(t.city)):e(U()).then((function(n){U.fulfilled.match(n)&&(e(E(n.payload)),e(L(n.payload)))})):e(U()).then((function(n){U.fulfilled.match(n)&&e(L(n.payload))}))}),[s]);return(0,a.useEffect)((function(){if(d){var e=function(e){var n=document.getElementById("user-menu-dropdown");n&&!n.contains(e.target)&&(f(!1),v(!1))};return document.addEventListener("mousedown",e),function(){return document.removeEventListener("mousedown",e)}}}),[d]),(0,r.jsxs)("header",{className:ce,children:[(0,r.jsxs)("div",{className:le,children:[(0,r.jsx)(i.N_,{to:"/",className:ue,children:"EBilet"}),(0,r.jsx)("div",{className:pe,children:(0,r.jsx)("input",{type:"text",placeholder:"Поиск мероприятий...",value:y,onChange:function(e){return j(e.target.value)}})}),(0,r.jsxs)("nav",{className:de,children:[(0,r.jsx)(De,{}),s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.N_,{to:"/my-tickets",className:fe,children:"Мои события"}),(0,r.jsxs)("div",{className:ve,children:[(0,r.jsxs)("button",{className:me+(d?" "+ye:""),onClick:function(){f((function(e){return!e})),v(!1)},"aria-haspopup":"true","aria-expanded":d,children:[(0,r.jsx)("img",{src:(null==t?void 0:t.avatarUrl)||"/default-avatar.png",alt:"avatar",className:je}),(0,r.jsx)("span",{className:xe,children:null==t?void 0:t.username})]}),d&&(0,r.jsxs)("div",{className:be,id:"user-menu-dropdown",children:[(0,r.jsx)(i.N_,{className:ge,to:"/profile",onClick:function(){return f(!1)},children:"Мой профиль"}),(0,r.jsx)("div",{className:we}),p?(0,r.jsxs)("div",{className:Ne,children:["Выйти из аккаунта?",(0,r.jsxs)("div",{className:ke,children:[(0,r.jsx)("button",{className:Ce,onClick:function(){e(R()),v(!1),f(!1)},children:"Да"}),(0,r.jsx)("button",{className:Se,onClick:function(){return v(!1)},children:"Нет"})]})]}):(0,r.jsx)("button",{className:ge,onClick:function(){return v(!0)},children:"Выйти"})]})]})]}):(0,r.jsx)("button",{onClick:function(){return l(!0)},className:he,children:"Войти"})]})]}),(0,r.jsx)(oe,{isOpen:c,onClose:function(){return l(!1)}})]})},ze="YvM5FLFP",Me="dXj11BDJ",Ve="FpY8onfk",qe="CRizw7lr",Ge="QgcL77oZ",Ye="RRM3pxoO",Ue="zu3mJbnV",_e="JYaCMsI8",Le="TTVw5vFO",Xe="mXBkGq1O",Ze="AOIpO0MI",Ke="cPHSjKlo",He="C4vpFgDJ";const Je=function(e){var n,t=e.event,a=e.onAddToFavorites,s=e.onBuyTicket;return(0,r.jsxs)("div",{className:ze,children:[t.imageUrl&&(0,r.jsx)("div",{className:Me,children:(0,r.jsx)("img",{src:t.imageUrl,alt:t.title,className:Ve})}),(0,r.jsxs)("div",{className:qe,children:[(0,r.jsx)("h3",{className:Ge,children:t.title}),(0,r.jsx)("p",{className:Ye,children:t.description}),(0,r.jsxs)("div",{className:Ue,children:[(0,r.jsx)("span",{className:_e,children:(n=t.date,new Date(n).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"}))}),(0,r.jsx)("span",{className:Le,children:t.location}),(0,r.jsxs)("span",{className:Xe,children:[t.price," ₽"]})]}),(0,r.jsxs)("div",{className:Ze,children:[(0,r.jsx)("button",{className:Ke,onClick:function(){return a(t.id)},children:"В избранное"}),(0,r.jsx)("button",{className:He,onClick:function(){return s(t.id)},children:"Купить билет"})]})]})]})},We="PjgZ7vFV",Qe="jaY9VeYu",$e="BaGs2vBz",en="YvBg03zK",nn="Tlk30F4G",tn="J481YSQ9",rn="e9XMvyD5",an="b9FCLRCd";var sn=function(){return sn=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},sn.apply(this,arguments)};const on=function(e){var n=e.onFilterChange,t=(0,a.useState)({category:"",dateRange:{start:"",end:""},priceRange:{min:0,max:1e4}}),s=t[0],i=t[1],o=function(e,t){var r,a=sn(sn({},s),((r={})[e]=t,r));i(a),null==n||n(a)};return(0,r.jsxs)("div",{className:We,children:[(0,r.jsx)("h3",{className:Qe,children:"Фильтры"}),(0,r.jsxs)("div",{className:$e,children:[(0,r.jsx)("label",{className:en,children:"Категория"}),(0,r.jsxs)("select",{className:nn,value:s.category,onChange:function(e){return o("category",e.target.value)},children:[(0,r.jsx)("option",{value:"",children:"Все категории"}),(0,r.jsx)("option",{value:"concert",children:"Концерты"}),(0,r.jsx)("option",{value:"theater",children:"Театр"}),(0,r.jsx)("option",{value:"exhibition",children:"Выставки"}),(0,r.jsx)("option",{value:"sport",children:"Спорт"})]})]}),(0,r.jsxs)("div",{className:$e,children:[(0,r.jsx)("label",{className:en,children:"Дата"}),(0,r.jsx)("div",{className:rn,children:(0,r.jsx)("input",{type:"date",className:tn,value:s.dateRange.start,onChange:function(e){return o("dateRange",sn(sn({},s.dateRange),{start:e.target.value}))}})})]}),(0,r.jsxs)("div",{className:$e,children:[(0,r.jsx)("label",{className:en,children:"Цена"}),(0,r.jsxs)("div",{className:an,children:[(0,r.jsx)("input",{type:"number",className:tn,placeholder:"От",value:s.priceRange.min,onChange:function(e){return o("priceRange",sn(sn({},s.priceRange),{min:Number(e.target.value)}))}}),(0,r.jsx)("input",{type:"number",className:tn,placeholder:"До",value:s.priceRange.max,onChange:function(e){return o("priceRange",sn(sn({},s.priceRange),{max:Number(e.target.value)}))}})]})]})]})},cn="CgjxyfEd",ln="RLut3f27",un="slcXbDY8",dn="zRDTHKjp",fn="UD6lwGa_",hn="oAFdJnbK",pn="GUOZxmDe";const vn=function(){var e=K(),n=H((function(e){return e.event})),t=n.events,s=n.loading,i=n.error;(0,a.useEffect)((function(){e(D())}),[e]);var o=function(e){console.log("Добавлено в избранное: ".concat(e))},c=function(e){console.log("Куплен билет: ".concat(e))};return s?(0,r.jsx)("div",{className:hn,children:"Загрузка..."}):i?(0,r.jsxs)("div",{className:pn,children:["Ошибка: ",i]}):(0,r.jsx)("div",{className:cn,children:(0,r.jsxs)("div",{className:ln,children:[(0,r.jsx)("aside",{className:un,children:(0,r.jsx)(on,{onFilterChange:function(e){console.log("Фильтры:",e)}})}),(0,r.jsx)("main",{className:dn,children:(0,r.jsx)("div",{className:fn,children:t.map((function(e){return(0,r.jsx)(Je,{event:e,onAddToFavorites:o,onBuyTicket:c},e.id)}))})})]})})},mn="Crw2kdr1",yn="C39kYaHZ",jn="nN4bYVhl",xn="KAiSm_v9",bn="KJlTLrGi",gn="_RzXGQFk",wn="cZJTIiqp",Nn="EJOHFjYL",kn="EbW2xjXI",Cn="EXuRoKnY",Sn="uXDX9P80",On="uHtTRs6c",Pn="SeuQM5i6",En="sudOS0eV",In="DzmiSDRR",Rn="ZW_on0Wd",Fn="cnbyq8qV";var Tn=function(){return Tn=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},Tn.apply(this,arguments)},An=function(e,n,t,r){return new(t||(t=Promise))((function(a,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function o(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,o)}c((r=r.apply(e,n||[])).next())}))},Dn=function(e,n){var t,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(o){return function(c){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(s=0)),s;)try{if(t=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=s.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=n.call(e,s)}catch(e){o=[6,e],r=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}};const Bn=function(){var e=K(),n=H((function(e){return e.auth})).user,t=H((function(e){return e.event})),s=t.events,i=t.loading,o=t.error,c=(0,a.useState)(!1),l=c[0],u=c[1],d=(0,a.useState)({username:(null==n?void 0:n.username)||"",email:(null==n?void 0:n.email)||"",city:(null==n?void 0:n.city)||""}),f=d[0],h=d[1];(0,a.useEffect)((function(){n&&e(z())}),[e,n]);var p=function(e){var n;h(Tn(Tn({},f),((n={})[e.target.name]=e.target.value,n)))};return n?i?(0,r.jsx)("div",{className:Rn,children:"Загрузка..."}):o?(0,r.jsx)("div",{className:Fn,children:o}):(0,r.jsx)("div",{className:mn,children:(0,r.jsxs)("div",{className:yn,children:[(0,r.jsxs)("div",{className:jn,children:[(0,r.jsxs)("div",{className:xn,children:[(0,r.jsx)("img",{src:n.avatarUrl||"/default-avatar.png",alt:"Avatar",className:bn}),(0,r.jsxs)("label",{className:gn,children:["Изменить фото",(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:function(n){return An(void 0,void 0,void 0,(function(){var t,r;return Dn(this,(function(a){switch(a.label){case 0:return(t=null===(r=n.target.files)||void 0===r?void 0:r[0])?[4,e(P(t))]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))},style:{display:"none"}})]})]}),(0,r.jsx)("div",{className:wn,children:l?(0,r.jsxs)("form",{className:Nn,children:[(0,r.jsxs)("div",{className:kn,children:[(0,r.jsx)("label",{children:"Имя пользователя"}),(0,r.jsx)("input",{type:"text",name:"username",value:f.username,onChange:p})]}),(0,r.jsxs)("div",{className:kn,children:[(0,r.jsx)("label",{children:"Email"}),(0,r.jsx)("input",{type:"email",name:"email",value:f.email,onChange:p})]}),(0,r.jsxs)("div",{className:kn,children:[(0,r.jsx)("label",{children:"Город"}),(0,r.jsx)("input",{type:"text",name:"city",value:f.city,onChange:p})]}),(0,r.jsxs)("div",{className:Cn,children:[(0,r.jsx)("button",{type:"submit",className:On,children:"Сохранить"}),(0,r.jsx)("button",{type:"button",className:Pn,onClick:function(){return u(!1)},children:"Отмена"})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{children:n.username}),(0,r.jsx)("p",{children:n.email}),(0,r.jsx)("p",{children:n.city}),(0,r.jsx)("button",{className:Sn,onClick:function(){return u(!0)},children:"Редактировать профиль"})]})})]}),(0,r.jsxs)("div",{className:En,children:[(0,r.jsx)("h3",{children:"Мои события"}),(0,r.jsx)("div",{className:In,children:s.map((function(e){return(0,r.jsx)(Je,{event:e,onAddToFavorites:function(){},onBuyTicket:function(){}},e.id)}))})]})]})}):(0,r.jsx)("div",{className:Fn,children:"Пожалуйста, войдите в систему"})},zn="_ifCH7uh";const Mn=function(){return(0,r.jsxs)("div",{className:zn,children:[(0,r.jsx)("h1",{children:"Мои события"}),(0,r.jsx)("p",{children:"Здесь будут отображаться все купленные билеты пользователя на события."})]})},Vn="d6WLOcTu",qn="CjyF501h";const Gn=function(){return(0,r.jsx)(c.Kq,{store:Z,children:(0,r.jsx)(i.Kd,{children:(0,r.jsxs)("div",{className:Vn,children:[(0,r.jsx)(Be,{}),(0,r.jsx)("main",{className:qn,children:(0,r.jsxs)(o.BV,{children:[(0,r.jsx)(o.qh,{path:"/",element:(0,r.jsx)(vn,{})}),(0,r.jsx)(o.qh,{path:"/profile",element:(0,r.jsx)(Bn,{})}),(0,r.jsx)(o.qh,{path:"/my-tickets",element:(0,r.jsx)(Mn,{})})]})})]})})})};s.createRoot(document.getElementById("root")).render((0,r.jsx)(a.StrictMode,{children:(0,r.jsx)(Gn,{})}))}},e=>{e.O(0,[460],(()=>{return n=45,e(e.s=n);var n}));e.O()}]);
//# sourceMappingURL=main.762552d4.js.map