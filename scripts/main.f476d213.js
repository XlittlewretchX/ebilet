"use strict";(self.webpackChunkebilet_client=self.webpackChunkebilet_client||[]).push([[792],{275:(e,t,n)=>{var r=n(848),a=n(540),i=n(338),o=n(976),s=n(767),c=n(468),l=n(816),u=n(83),d=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},f=function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},h=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},v=u.A.create({baseURL:"https://ebilet-8f91.onrender.com/api",headers:{"Content-Type":"application/json"}});v.interceptors.request.use((function(e){var t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}));var p,m=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,v.post("/auth/register",e)];case 1:return[2,t.sent().data]}}))}))},y=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,v.post("/auth/login",e)];case 1:return[2,t.sent().data]}}))}))},x=function(e){return d(void 0,void 0,void 0,(function(){var t;return f(this,(function(n){switch(n.label){case 0:return(t=new FormData).append("avatar",e),[4,v.post("/auth/avatar",t,{headers:{"Content-Type":"multipart/form-data"}})];case 1:return[2,n.sent().data]}}))}))},g=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,v.patch("/auth/city",{city:e})];case 1:return[2,t.sent().data]}}))}))},b=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,v.post("/auth/favorite",{eventId:e})];case 1:return[2,t.sent().data]}}))}))},j=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,v.delete("/auth/favorite",{data:{eventId:e}})];case 1:return[2,t.sent().data]}}))}))},w=function(){return d(void 0,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,v.get("/auth/favorites")];case 1:return[2,e.sent().data]}}))}))},k=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return d(void 0,h([],e,!0),void 0,(function(e){var t;return void 0===e&&(e={}),f(this,(function(n){switch(n.label){case 0:return t=new URLSearchParams,e.category&&t.append("category",e.category),e.subcategory&&t.append("subcategory",e.subcategory),e.priceRange&&"object"==typeof e.priceRange&&(void 0!==e.priceRange.min&&t.append("minPrice",String(e.priceRange.min)),void 0!==e.priceRange.max&&t.append("maxPrice",String(e.priceRange.max))),e.search&&t.append("search",e.search),e.city&&t.append("city",e.city),[4,v.get("/events",{params:t})];case 1:return[2,n.sent().data]}}))}))},N=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,v.get("/events/".concat(e))];case 1:return[2,t.sent().data]}}))}))},C=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,v.post("/events",e,{headers:{"Content-Type":"multipart/form-data"}})];case 1:return[2,t.sent().data]}}))}))},S=function(){return d(void 0,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,v.get("/events/user/events")];case 1:return[2,e.sent().data]}}))}))},A=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},P=function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},E={user:null,token:localStorage.getItem("token"),isAuthenticated:!1,loading:!1,error:null},R=(0,l.zD)("auth/register",(function(e,t){return A(void 0,[e,t],void 0,(function(e,t){var n,r,a,i=t.rejectWithValue;return P(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,m(e)];case 1:return n=t.sent(),localStorage.setItem("token",n.token),[2,n];case 2:return r=t.sent(),(a=r).response&&a.response.data&&a.response.data.message?[2,i(a.response.data.message)]:[2,i("Ошибка при регистрации")];case 3:return[2]}}))}))})),I=(0,l.zD)("auth/login",(function(e,t){return A(void 0,[e,t],void 0,(function(e,t){var n,r,a,i=t.rejectWithValue;return P(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,y(e)];case 1:return n=t.sent(),localStorage.setItem("token",n.token),[2,n];case 2:return r=t.sent(),(a=r).response&&a.response.data&&a.response.data.message?[2,i(a.response.data.message)]:[2,i("Ошибка при входе")];case 3:return[2]}}))}))})),O=(0,l.zD)("auth/uploadAvatar",(function(e){return A(void 0,void 0,void 0,(function(){return P(this,(function(t){switch(t.label){case 0:return[4,x(e)];case 1:return[2,t.sent()]}}))}))})),D=(0,l.zD)("auth/updateCity",(function(e,t){return A(void 0,[e,t],void 0,(function(e,t){var n=t.rejectWithValue;return P(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,g(e)];case 1:return[2,t.sent().city];case 2:return t.sent(),[2,n("Ошибка при обновлении города")];case 3:return[2]}}))}))})),B=(0,l.zD)("auth/addFavorite",(function(e,t){return A(void 0,[e,t],void 0,(function(e,t){var n=t.rejectWithValue;return P(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,b(e)];case 1:return t.sent(),[2,e];case 2:return t.sent(),[2,n("Ошибка при добавлении в избранное")];case 3:return[2]}}))}))})),T=(0,l.zD)("auth/removeFavorite",(function(e,t){return A(void 0,[e,t],void 0,(function(e,t){var n=t.rejectWithValue;return P(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,j(e)];case 1:return t.sent(),[2,e];case 2:return t.sent(),[2,n("Ошибка при удалении из избранного")];case 3:return[2]}}))}))})),F=(0,l.zD)("auth/fetchFavorites",(function(e,t){return A(void 0,[e,t],void 0,(function(e,t){var n=t.rejectWithValue;return P(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,w()];case 1:return[2,e.sent()];case 2:return e.sent(),[2,n("Ошибка при получении избранного")];case 3:return[2]}}))}))})),L=(0,l.Z0)({name:"auth",initialState:E,reducers:{logout:function(e){e.user=null,e.token=null,e.isAuthenticated=!1,localStorage.removeItem("token")},clearError:function(e){e.error=null}},extraReducers:function(e){e.addCase(R.pending,(function(e){e.loading=!0,e.error=null})).addCase(R.fulfilled,(function(e,t){e.loading=!1,e.isAuthenticated=!0,e.user=t.payload.user,e.token=t.payload.token})).addCase(R.rejected,(function(e,t){e.loading=!1,e.error=t.payload||t.error.message||"Ошибка при регистрации"})).addCase(I.pending,(function(e){e.loading=!0,e.error=null})).addCase(I.fulfilled,(function(e,t){e.loading=!1,e.isAuthenticated=!0,e.user=t.payload.user,e.token=t.payload.token})).addCase(I.rejected,(function(e,t){e.loading=!1,e.error=t.payload||t.error.message||"Ошибка при входе"})).addCase(O.fulfilled,(function(e,t){e.user&&(e.user.avatarUrl=t.payload.avatarUrl)})).addCase(D.fulfilled,(function(e,t){e.user&&(e.user.city=t.payload)})).addCase(B.fulfilled,(function(e,t){e.user&&(e.user.favorites||(e.user.favorites=[]),e.user.favorites.includes(t.payload)||e.user.favorites.push(t.payload))})).addCase(T.fulfilled,(function(e,t){e.user&&e.user.favorites&&(e.user.favorites=e.user.favorites.filter((function(e){return e!==t.payload})))})).addCase(F.fulfilled,(function(e,t){e.user&&(e.user.favorites=t.payload.map((function(e){return e.id})))}))}}),M=(p=L.actions).logout;p.clearError;const W=L.reducer;var U=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},z=function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},G=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},q=(0,l.zD)("event/fetchEvents",(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return U(void 0,G([],e,!0),void 0,(function(e){return void 0===e&&(e={}),z(this,(function(t){switch(t.label){case 0:return[4,k(e)];case 1:return[2,t.sent()]}}))}))})),H=((0,l.zD)("event/fetchEventById",(function(e){return U(void 0,void 0,void 0,(function(){return z(this,(function(t){switch(t.label){case 0:return[4,N(e)];case 1:return[2,t.sent()]}}))}))})),(0,l.zD)("event/createEvent",(function(e){return U(void 0,void 0,void 0,(function(){return z(this,(function(t){switch(t.label){case 0:return[4,C(e)];case 1:return[2,t.sent()]}}))}))}))),Y=(0,l.zD)("event/fetchUserEvents",(function(){return U(void 0,void 0,void 0,(function(){return z(this,(function(e){switch(e.label){case 0:return[4,S()];case 1:return[2,e.sent()]}}))}))})),X=(0,l.Z0)({name:"event",initialState:{events:[],loading:!1,error:null},reducers:{clearError:function(e){e.error=null}},extraReducers:function(e){e.addCase(q.pending,(function(e){e.loading=!0,e.error=null})).addCase(q.fulfilled,(function(e,t){e.loading=!1,e.events=t.payload})).addCase(q.rejected,(function(e,t){e.loading=!1,e.error=t.error.message||"Ошибка при загрузке событий"})).addCase(H.pending,(function(e){e.loading=!0,e.error=null})).addCase(H.fulfilled,(function(e,t){e.loading=!1,e.events.unshift(t.payload)})).addCase(H.rejected,(function(e,t){e.loading=!1,e.error=t.error.message||"Ошибка при создании события"})).addCase(Y.pending,(function(e){e.loading=!0,e.error=null})).addCase(Y.fulfilled,(function(e,t){e.loading=!1,e.events=t.payload})).addCase(Y.rejected,(function(e,t){e.loading=!1,e.error=t.error.message||"Ошибка при загрузке событий пользователя"}))}});X.actions.clearError;const Z=X.reducer;var V,J=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},K=function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},_=(0,l.zD)("city/fetchByIP",(function(e,t){return J(void 0,[e,t],void 0,(function(e,t){var n,r,a,i,o,s,c,l,u,d,f,h,v,p,m,y,x=t.rejectWithValue;return K(this,(function(e){switch(e.label){case 0:return e.trys.push([0,6,,7]),n="90cea4be77d44b80ab21374726d21b70",console.log("[fetchCityByIP] Используемый API-ключ:",n),r="https://api.ipgeolocation.io/ipgeo?apiKey=".concat(n),console.log("[fetchCityByIP] URL запроса:",r),[4,fetch(r)];case 1:return a=e.sent(),console.log("[fetchCityByIP] Статус ответа:",a.status),a.ok?[4,a.json()]:(console.error("[fetchCityByIP] Ошибка API:",a.status),[2,x("Ошибка API: ".concat(a.status))]);case 2:return i=e.sent(),console.log("[fetchCityByIP] Данные от ipgeolocation:",i),o=i.city,s=i.latitude,c=i.longitude,s&&c?(l="https://nominatim.openstreetmap.org/reverse?lat=".concat(s,"&lon=").concat(c,"&format=json&accept-language=ru"),console.log("[fetchCityByIP] URL запроса к Nominatim:",l),[4,fetch(l,{headers:{"User-Agent":"ebilet-app/1.0 (your@email.com)"}})]):(console.warn("[fetchCityByIP] Нет координат, возвращаю город:",o),[2,o||"Город"]);case 3:return u=e.sent(),console.log("[fetchCityByIP] Статус ответа Nominatim:",u.status),u.ok?[4,u.json()]:[3,5];case 4:if(d=e.sent(),console.log("[fetchCityByIP] Данные от Nominatim:",d),f=(null===(v=d.address)||void 0===v?void 0:v.city)||(null===(p=d.address)||void 0===p?void 0:p.town)||(null===(m=d.address)||void 0===m?void 0:m.village)||(null===(y=d.address)||void 0===y?void 0:y.state))return console.log("[fetchCityByIP] Город на русском найден:",f),[2,f];e.label=5;case 5:return console.warn("[fetchCityByIP] Город на русском не найден, возвращаю:",o),[2,o||"Город"];case 6:return h=e.sent(),console.error("[fetchCityByIP] Ошибка:",h),[2,x(h.message)];case 7:return[2]}}))}))})),Q=(0,l.Z0)({name:"city",initialState:{name:"Город",showPicker:!1},reducers:{openPicker:function(e){e.showPicker=!0},closePicker:function(e){e.showPicker=!1},setCity:function(e,t){e.name=t.payload,e.showPicker=!1}},extraReducers:function(e){e.addCase(_.fulfilled,(function(e,t){var n=t.payload;e.name=n,e.showPicker=!1})).addCase(_.rejected,(function(e){e.showPicker=!0}))}}),$=((V=Q.actions).openPicker,V.closePicker,V.setCity);const ee=Q.reducer;var te=(0,l.Z0)({name:"search",initialState:{value:""},reducers:{setSearch:function(e,t){e.value=t.payload}}}),ne=te.actions.setSearch;const re=te.reducer;var ae,ie={category:"",subcategory:"",dateRange:{start:"",end:""},priceRange:{min:0,max:1e4},onlyMyCity:!1},oe=(0,l.Z0)({name:"filter",initialState:ie,reducers:{setFilters:function(e,t){return t.payload},resetFilters:function(){return ie}}}),se=(ae=oe.actions).setFilters,ce=ae.resetFilters;const le=oe.reducer;var ue=(0,l.U1)({reducer:{auth:W,event:Z,city:ee,search:re,filter:le}}),de=function(){return(0,c.wA)()},fe=c.d4;const he="ZBn11TNK",ve="CUqvr6P1",pe="AHg1PWg4",me="lm66XJB1",ye="bJBRsEr3",xe="afkZPFTr",ge="qRFgd7Gl";var be=function(){return be=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},be.apply(this,arguments)},je=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},we=function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ke=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};const Ne=function(e){var t=e.isOpen,n=e.onClose,i=de(),o=fe((function(e){return e.auth})),s=o.loading,c=o.error,l=o.isAuthenticated,u=fe((function(e){return e.city.name})),d=(0,a.useState)(!0),f=d[0],h=d[1],v=(0,a.useState)({username:"",email:"",password:"",confirmPassword:""}),p=v[0],m=v[1],y=(0,a.useState)(""),x=y[0],g=y[1],b=function(e){var t;m(be(be({},p),((t={})[e.target.name]=e.target.value,t)))};return(0,a.useEffect)((function(){t&&l&&f&&n()}),[l,t,f,n]),(0,a.useEffect)((function(){t&&(m({username:"",email:"",password:"",confirmPassword:""}),g(""))}),[t,f]),(0,a.useEffect)((function(){if(t){var e=function(){if("undefined"==typeof window)return 0;var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.overflow="scroll",e.style.position="absolute",e.style.top="-9999px",document.body.appendChild(e);var t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),t}();document.body.style.overflow="hidden",e>0&&(document.body.style.paddingRight="".concat(e,"px"));var r=function(e){"Escape"===e.key&&n()};return window.addEventListener("keydown",r),function(){document.body.style.overflow="",document.body.style.paddingRight="",window.removeEventListener("keydown",r)}}document.body.style.overflow="",document.body.style.paddingRight=""}),[t,n]),t?(0,r.jsx)("div",{className:he,onClick:n,children:(0,r.jsxs)("div",{className:ve,onClick:function(e){return e.stopPropagation()},children:[(0,r.jsx)("button",{className:pe,onClick:n,children:"×"}),(0,r.jsx)("h2",{children:f?"Вход":"Регистрация"}),(0,r.jsxs)("form",{onSubmit:function(e){return je(void 0,void 0,void 0,(function(){var t,r,a;return we(this,(function(o){switch(o.label){case 0:return e.preventDefault(),f||p.password===p.confirmPassword?f?(p.email,p.confirmPassword,t=ke(p,["email","confirmPassword"]),[4,i(I(t))]):[3,2]:(alert("Пароли не совпадают"),[2]);case 1:return o.sent(),[3,4];case 2:return p.confirmPassword,r=ke(p,["confirmPassword"]),[4,i(R(be(be({},r),{city:u})))];case 3:a=o.sent(),R.fulfilled.match(a)&&(g("Вы успешно зарегистрировались!"),setTimeout((function(){g(""),n()}),1500)),o.label=4;case 4:return[2]}}))}))},children:[(0,r.jsx)("div",{className:me,children:(0,r.jsx)("input",{type:"text",name:"username",placeholder:"Имя пользователя",value:p.username,onChange:b,required:!0})}),!f&&(0,r.jsx)("div",{className:me,children:(0,r.jsx)("input",{type:"email",name:"email",placeholder:"Email",value:p.email,onChange:b,required:!0})}),(0,r.jsx)("div",{className:me,children:(0,r.jsx)("input",{type:"password",name:"password",placeholder:"Пароль",value:p.password,onChange:b,required:!0})}),!f&&(0,r.jsx)("div",{className:me,children:(0,r.jsx)("input",{type:"password",name:"confirmPassword",placeholder:"Подтвердите пароль",value:p.confirmPassword,onChange:b,required:!0})}),(0,r.jsx)("button",{type:"submit",disabled:s,children:s?"Загрузка...":f?"Войти":"Зарегистрироваться"}),c&&(0,r.jsx)("p",{className:ye,children:c}),x&&(0,r.jsx)("p",{className:xe,children:x})]}),(0,r.jsxs)("p",{className:ge,children:[f?"Нет аккаунта?":"Уже есть аккаунт?"," ",(0,r.jsx)("button",{onClick:function(){return h(!f)},children:f?"Зарегистрироваться":"Войти"})]})]})}):null},Ce="fAQaBm7b",Se="PlasbFNv",Ae="kTUf0kGC",Pe="fEL3MMAt",Ee="fM4jt9LS",Re="L30DL5n3",Ie="r7jyaAy1",Oe="IXD9sEDJ",De="a3hu4l6L";var Be=function(){return(0,r.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{marginRight:6},children:(0,r.jsx)("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z",fill:"#007bff"})})};const Te=function(){var e=function(){var e=de(),t=fe((function(e){return e.city})).name,n=fe((function(e){return e.auth})),r=n.isAuthenticated,i=n.user,o=(0,a.useState)(!1),s=o[0],c=o[1],l=(0,a.useState)(""),u=l[0],d=l[1],f=r?(null==i?void 0:i.city)||"Город":t;return(0,a.useEffect)((function(){d(f)}),[f]),{displayCity:f,editing:s,input:u,setEditing:c,setInput:d,handleSave:function(){u.trim()&&(r?(e(D(u.trim())),e($(u.trim()))):e($(u.trim())),c(!1))}}}(),t=e.displayCity,n=e.editing,i=e.input,o=e.setEditing,s=e.setInput,c=e.handleSave;return(0,r.jsxs)("div",{className:Ae,children:[(0,r.jsxs)("button",{className:Pe,onClick:function(){return o(!0)},"aria-label":"Выбрать город",children:[(0,r.jsx)(Be,{}),(0,r.jsx)("span",{className:Ee,children:t})]}),n&&(0,r.jsx)("div",{className:Re,onClick:function(){return o(!1)},children:(0,r.jsxs)("div",{className:Ie,onClick:function(e){return e.stopPropagation()},children:[(0,r.jsx)("input",{className:Oe,value:i,onChange:function(e){return s(e.target.value)},placeholder:"Введите город",autoFocus:!0}),(0,r.jsxs)("div",{className:De,children:[(0,r.jsx)("button",{className:Ce,onClick:c,children:"Сохранить"}),(0,r.jsx)("button",{className:Se,onClick:function(){return o(!1)},children:"Отмена"})]})]})})]})},Fe="u_gfar7T",Le="c4nqin0V",Me="vznLq989",We="RtxXsOy1",Ue="zAcwWXS1",ze="yOBgwguB",Ge="ecktM8Mn",qe="WzUGgLsP",He="ODPKXZs7",Ye="lUEi3qfW",Xe="V_MqE9EB",Ze="fsUi_MnL";const Ve=function(e){var t=e.user,n=e.avatarUrl,i=function(){var e=de(),t=(0,s.Zp)(),n=(0,a.useState)(!1),r=n[0],i=n[1],o=(0,a.useState)(!1),c=o[0],l=o[1];return{showUserMenu:r,showLogoutConfirm:c,setShowUserMenu:i,setShowLogoutConfirm:l,onLogout:function(){e(M()),l(!1),i(!1)},onProfileClick:function(){i(!1),t("/profile")}}}(),o=i.showUserMenu,c=i.showLogoutConfirm,l=i.setShowUserMenu,u=i.setShowLogoutConfirm,d=i.onLogout,f=i.onProfileClick;return a.useEffect((function(){if(o){var e=function(e){var t=document.getElementById("user-menu-dropdown");t&&!t.contains(e.target)&&(l(!1),u(!1))};return document.addEventListener("mousedown",e),function(){return document.removeEventListener("mousedown",e)}}}),[o,l,u]),(0,r.jsxs)("div",{className:Fe,children:[(0,r.jsxs)("button",{className:Le+(o?" "+Me:""),onClick:function(){l(!o),u(!1)},"aria-haspopup":"true","aria-expanded":o,children:[(0,r.jsx)("img",{src:n,alt:"avatar",className:We}),(0,r.jsx)("span",{className:Ue,children:null==t?void 0:t.username})]}),o&&(0,r.jsxs)("div",{className:ze,id:"user-menu-dropdown",children:[(0,r.jsx)("a",{className:Ge,href:"/profile",onClick:function(e){e.preventDefault(),l(!1),f()},children:"Мой профиль"}),(0,r.jsx)("div",{className:qe}),c?(0,r.jsxs)("div",{className:He,children:["Выйти из аккаунта?",(0,r.jsxs)("div",{className:Ye,children:[(0,r.jsx)("button",{className:Xe,onClick:function(){d(),u(!1),l(!1)},children:"Да"}),(0,r.jsx)("button",{className:Ze,onClick:function(){return u(!1)},children:"Нет"})]})]}):(0,r.jsx)("button",{className:Ge,onClick:function(){return u(!0)},children:"Выйти"})]})]})},Je="g41BiwqO",Ke="Ur4ZVcPj",_e="NZN2De8g",Qe="EgI6UGtM",$e="C12NQz6V",et="THy6AUoD",tt="PGbuMa0s";const nt=function(){var e=de(),t=fe((function(e){return e.search.value}));return(0,r.jsx)("div",{className:tt,children:(0,r.jsx)("input",{type:"text",placeholder:"Поиск мероприятий...",value:t,onChange:function(t){return e(ne(t.target.value))}})})};const rt=function(){var e,t=de(),n=fe((function(e){return e.auth})),i=n.user,s=n.isAuthenticated,c=(0,a.useState)(!1),l=c[0],u=c[1];fe((function(e){return e.search.value}));(0,a.useEffect)((function(){s?(null==i?void 0:i.city)&&"Город"!==i.city?t($(i.city)):t(_()).then((function(e){_.fulfilled.match(e)&&(t(D(e.payload)),t($(e.payload)))})):t(_()).then((function(e){_.fulfilled.match(e)&&t($(e.payload))}))}),[s]);var d=(null==i?void 0:i.avatarUrl)?i.avatarUrl.startsWith("/uploads")?"".concat(null===(e="https://ebilet-8f91.onrender.com/api")?void 0:e.replace("/api","")).concat(i.avatarUrl):i.avatarUrl:"/img/default-avatar.svg";return(0,r.jsxs)("header",{className:Je,children:[(0,r.jsxs)("div",{className:Ke,children:[(0,r.jsx)(o.N_,{to:"/",className:_e,children:"EBilet"}),(0,r.jsx)(nt,{}),(0,r.jsxs)("nav",{className:Qe,children:[(0,r.jsx)(Te,{}),s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.N_,{to:"/my-tickets",className:$e,children:"Мои события"}),(0,r.jsx)(Ve,{user:i,avatarUrl:d})]}):(0,r.jsx)("button",{onClick:function(){return u(!0)},className:et,children:"Войти"})]})]}),(0,r.jsx)(Ne,{isOpen:l,onClose:function(){return u(!1)}})]})},at="q5cSkrMt",it="Ae6HeLkd",ot="Y5GpHGmX",st="rwPoguZK",ct="cck_aaWJ",lt="HPiEpQok",ut="FiozW65V",dt="aYq2HTAm",ft="SOh8XEf3",ht="DkILKbzx",vt="LgrZNhg5",pt="EkpXFwbY",mt="BTMdkehq";const yt=function(e){var t,n,a=e.event,i=e.isFavorite,o=e.onAddToFavorites,s=e.onRemoveFromFavorites,c=e.onBuyTicket;return(0,r.jsxs)("div",{className:at,children:[a.imageUrl&&(0,r.jsx)("div",{className:it,children:(0,r.jsx)("img",{src:a.imageUrl.startsWith("/uploads")?"".concat(null===(t="https://ebilet-8f91.onrender.com/api")?void 0:t.replace("/api","")).concat(a.imageUrl):a.imageUrl,alt:a.title,className:ot})}),(0,r.jsxs)("div",{className:st,children:[(0,r.jsx)("h3",{className:ct,children:a.title}),(0,r.jsx)("p",{className:lt,children:a.description}),(0,r.jsxs)("div",{className:ut,children:[(0,r.jsx)("span",{className:dt,children:(n=a.date,new Date(n).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"}))}),(0,r.jsx)("span",{className:ft,children:a.location}),(0,r.jsxs)("span",{className:ht,children:[a.price," ₽"]})]}),(0,r.jsxs)("div",{className:vt,children:[i?(0,r.jsx)("button",{className:pt,style:{color:"#2563eb",fontWeight:700},onClick:function(){return s&&s(a.id)},children:"В избранном"}):(0,r.jsx)("button",{className:pt,onClick:function(){return o(a.id)},children:"В избранное"}),(0,r.jsx)("button",{className:mt,onClick:function(){return c(a.id)},children:"Купить билет"})]})]})]})},xt={eventsGrid:"qBEGkhBl",skeletonCard:"RbbVmJFy",skeletonPulse:"vpMKu1Ol",skeletonImage:"vlm4unXd",skeletonContent:"NBc2AoOt",skeletonTitle:"f2LiwQAJ",skeletonText:"zS2iyEE3",skeletonActions:"R2oGtYoV",emptyStub:"E8nCmBoI",errorStub:"q9ZaeAke",fadeIn:"RcMhUo2O",emptyStubIcon:"YDzKGw5_",emptyStubText:"mKiTZ3jb",errorStubIcon:"X8zyHPt9",errorStubText:"ndbO5NyY"};var gt=n(164);const bt=function(e){var t=e.events,n=e.onAddToFavorites,a=e.onRemoveFromFavorites,i=e.onBuyTicket,o=e.loading,s=e.error;return o?(0,r.jsx)("div",{className:xt.eventsGrid,children:Array.from({length:6}).map((function(e,t){return(0,r.jsxs)("div",{className:(0,gt.A)(xt.skeletonCard,xt.card),children:[(0,r.jsx)("div",{className:xt.skeletonImage}),(0,r.jsxs)("div",{className:xt.skeletonContent,children:[(0,r.jsx)("div",{className:xt.skeletonTitle}),(0,r.jsx)("div",{className:xt.skeletonText}),(0,r.jsx)("div",{className:xt.skeletonText}),(0,r.jsx)("div",{className:xt.skeletonActions})]})]},t)}))}):s?(0,r.jsx)("div",{className:xt.eventsGrid,children:(0,r.jsxs)("div",{className:xt.errorStub,children:[(0,r.jsxs)("svg",{className:xt.errorStubIcon,viewBox:"0 0 48 48",fill:"none",children:[(0,r.jsx)("circle",{cx:"24",cy:"24",r:"22",fill:"#ffd6d6",stroke:"#dc3545",strokeWidth:"2"}),(0,r.jsx)("path",{d:"M24 14v12",stroke:"#dc3545",strokeWidth:"3",strokeLinecap:"round"}),(0,r.jsx)("circle",{cx:"24",cy:"33",r:"2.5",fill:"#dc3545"})]}),(0,r.jsxs)("div",{className:xt.errorStubText,children:["Произошла ошибка при загрузке событий.",(0,r.jsx)("br",{}),"Пожалуйста, попробуйте позже."]})]})}):t.length?(0,r.jsx)("div",{className:xt.eventsGrid,children:t.map((function(e){return(0,r.jsx)(yt,{event:e,isFavorite:e.isFavorite,onAddToFavorites:n,onRemoveFromFavorites:a,onBuyTicket:i},e.id)}))}):(0,r.jsx)("div",{className:xt.eventsGrid,children:(0,r.jsxs)("div",{className:xt.emptyStub,children:[(0,r.jsxs)("svg",{className:xt.emptyStubIcon,viewBox:"0 0 48 48",fill:"none",children:[(0,r.jsx)("circle",{cx:"24",cy:"24",r:"22",fill:"#e3e8ee",stroke:"#bfc8d6",strokeWidth:"2"}),(0,r.jsx)("path",{d:"M16 28c1.5-2 4.5-2 6 0s4.5 2 6 0",stroke:"#bfc8d6",strokeWidth:"2",strokeLinecap:"round"}),(0,r.jsx)("circle",{cx:"18",cy:"20",r:"2",fill:"#bfc8d6"}),(0,r.jsx)("circle",{cx:"30",cy:"20",r:"2",fill:"#bfc8d6"})]}),(0,r.jsx)("div",{className:xt.emptyStubText,children:"Мероприятия не найдены по выбранным фильтрам"})]})})},jt={filters:"fwAkczIH",title:"iCXDBxH_",section:"kBXyRaRk",label:"GUckwTmH",select:"Y8pf8z9R",input:"ghCNQt6h",dateRange:"bvfcjHbC",priceRange:"yVFLEEy2"};var wt=function(){return wt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},wt.apply(this,arguments)},kt={concert:["рок","поп","классика","джаз"],theater:["драма","комедия","мюзикл"],exhibition:["искусство","наука","технологии"],sport:["футбол","баскетбол","теннис"]};const Nt=function(){var e=de(),t=fe((function(e){return e.filter})),n=function(n,r){var a,i=wt(wt({},t),((a={})[n]=r,a));"category"===n&&(i=wt(wt({},i),{subcategory:""})),e(se(i))};return(0,r.jsxs)("div",{className:jt.filters,children:[(0,r.jsx)("h3",{className:jt.title,children:"Фильтры"}),(0,r.jsxs)("div",{className:jt.section,children:[(0,r.jsx)("label",{className:jt.label,children:"Категория"}),(0,r.jsxs)("select",{className:jt.select,value:t.category,onChange:function(e){return n("category",e.target.value)},children:[(0,r.jsx)("option",{value:"",children:"Все категории"}),(0,r.jsx)("option",{value:"concert",children:"Концерты"}),(0,r.jsx)("option",{value:"theater",children:"Театр"}),(0,r.jsx)("option",{value:"exhibition",children:"Выставки"}),(0,r.jsx)("option",{value:"sport",children:"Спорт"})]})]}),t.category&&kt[t.category]&&(0,r.jsxs)("div",{className:jt.section,children:[(0,r.jsx)("label",{className:jt.label,children:"Подкатегория"}),(0,r.jsxs)("select",{className:jt.select,value:t.subcategory,onChange:function(e){return n("subcategory",e.target.value.toLowerCase())},children:[(0,r.jsx)("option",{value:"",children:"Все подкатегории"}),kt[t.category].map((function(e){return(0,r.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e)}))]})]}),(0,r.jsxs)("div",{className:jt.section,children:[(0,r.jsx)("label",{className:jt.label,children:"Цена"}),(0,r.jsxs)("div",{className:jt.priceRange,children:[(0,r.jsx)("input",{type:"number",className:jt.input,placeholder:"От",value:t.priceRange.min,onChange:function(e){return n("priceRange",wt(wt({},t.priceRange),{min:Number(e.target.value)}))}}),(0,r.jsx)("input",{type:"number",className:jt.input,placeholder:"До",value:t.priceRange.max,onChange:function(e){return n("priceRange",wt(wt({},t.priceRange),{max:Number(e.target.value)}))}})]})]}),(0,r.jsx)("div",{className:jt.section,children:(0,r.jsxs)("label",{className:jt.label,style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,r.jsx)("input",{type:"checkbox",checked:t.onlyMyCity,onChange:function(e){return n("onlyMyCity",e.target.checked)},style:{marginRight:"0.5rem"}}),"Искать в моем городе"]})}),(0,r.jsx)("button",{className:jt.resetBtn,onClick:function(){e(ce())},style:{marginTop:"1.5rem",width:"100%",background:"#e3eaff",color:"#2563eb",border:"none",borderRadius:"6px",padding:"0.6rem 0",fontWeight:600,cursor:"pointer"},children:"Сбросить фильтры"})]})},Ct="j0hpXBhN",St="eHWccHhH",At="vYHN7kuE",Pt="uoLFLMYf",Et="H77EWGMO",Rt="NMRhFUn6",It="J96oD63O",Ot="qeNvi5fk",Dt="KFdP2fDA",Bt="kNzAYewg",Tt="DM0HIRNy",Ft="ENnngIek",Lt="xBFG1fFa",Mt="ZmmTvOnY",Wt="ktm0PLty";var Ut=n(691),zt=(n(995),n(614)),Gt=["ПН","ВТ","СР","ЧТ","ПТ","СБ","ВС"],qt=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],Ht=function(e){return e.toString().padStart(2,"0")},Yt=function(e){return"".concat(e.getFullYear(),"-").concat(Ht(e.getMonth()+1),"-").concat(Ht(e.getDate()))};const Xt=function(e){var t=e.onDateSelect,n=e.onRangeSelect,i=new Date,o=(0,a.useState)(!1),s=o[0],c=o[1],l=(0,a.useState)(null),u=l[0],d=l[1],f=(0,a.useState)([null,null]),h=f[0],v=f[1],p=(0,a.useState)(i.getMonth()),m=p[0],y=p[1],x=(0,a.useState)(i.getFullYear()),g=x[0],b=x[1];(0,a.useEffect)((function(){if(u||h[0]||h[1]){var e=function(){d(null),v([null,null])};return window.addEventListener("reset-date-strip",e),function(){return window.removeEventListener("reset-date-strip",e)}}}),[u,h]);var j=function(e,t){for(var n=[],r=new Date(e,t,1);r.getMonth()===t;)n.push(new Date(r)),r.setDate(r.getDate()+1);return n}(g,m),w=new Date(g,m,1).getDay();0===w&&(w=7);Array(w-1).fill(null);var k=function(e){if(Array.isArray(e))v(e),d(null),e[0]&&e[1]&&(n(Yt(e[0]),Yt(e[1])),c(!1));else if(e instanceof Date){d(e),v([null,null]);var r=Yt(e);t(r),c(!1)}},N=function(){d(null),v([null,null]),n("",""),c(!1)};return(0,r.jsxs)("div",{className:Ct,children:[(0,r.jsxs)("div",{className:St,children:[(0,r.jsx)("button",{className:Pt,onClick:function(){0===m?(y(11),b((function(e){return e-1}))):y((function(e){return e-1}))},children:"←"}),(0,r.jsxs)("span",{className:At,children:[qt[m]," ",g]}),(0,r.jsx)("button",{className:Pt,onClick:function(){11===m?(y(0),b((function(e){return e+1}))):y((function(e){return e+1}))},children:"→"})]}),(0,r.jsx)("div",{className:Et,children:(0,r.jsx)("div",{className:It,children:j.map((function(e){var a=e.toDateString()===i.toDateString(),o=u&&e.toDateString()===u.toDateString(),s=Gt[(e.getDay()+6)%7];return(0,r.jsxs)("button",{className:Ot+(o?" "+Dt:"")+(a?" "+Bt:""),onClick:function(){return function(e){d(e),v([null,null]);var r=Yt(e);t(r),n(r,r)}(e)},children:[(0,r.jsx)("span",{className:Rt,children:s}),(0,r.jsx)("span",{className:Tt,children:e.getDate()})]},e.toISOString())}))})}),(0,r.jsx)("button",{className:Ft,onClick:function(){return c(!0)},children:"📅"}),s&&(0,r.jsx)((function(){return(0,r.jsx)("div",{className:Lt,onClick:function(){return c(!1)},children:(0,r.jsxs)("div",{className:Mt,onClick:function(e){return e.stopPropagation()},children:[(0,r.jsx)(Ut.Ay,{selected:u,onChange:k,startDate:h[0],endDate:h[1],selectsRange:!0,inline:!0,locale:zt.ru,dateFormat:"dd.MM.yyyy"}),(0,r.jsxs)("div",{style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[(0,r.jsx)("button",{className:Wt,onClick:function(){return c(!1)},children:"Закрыть"}),(0,r.jsx)("button",{className:Wt,style:{background:"#e3eaff",color:"#2563eb"},onClick:N,children:"Очистить"})]})]})})}),{})]})},Zt="CgjxyfEd",Vt="RLut3f27",Jt="slcXbDY8",Kt="zRDTHKjp",_t="oAFdJnbK",Qt="GUOZxmDe";var $t=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},en=function(){return en=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},en.apply(this,arguments)},tn=function(){var e=de(),t=fe((function(e){return e.event})),n=t.loading,r=t.error,i=fe((function(e){return e.filter})),o=function(e,t){var n=(0,a.useState)(e),r=n[0],i=n[1];return(0,a.useEffect)((function(){var n=setTimeout((function(){i(e)}),t);return function(){clearTimeout(n)}}),[e,t]),r}(i,300),s=function(){var e=fe((function(e){return e.event})).events,t=fe((function(e){return e.search.value})),n=fe((function(e){return e.filter})),r=t.trim().toLowerCase(),a=e.filter((function(e){var t=e.title.toLowerCase(),a=!r||t.startsWith(r)||t.includes(r),i=!n.category||e.category&&e.category.trim().toLowerCase()===n.category.trim().toLowerCase(),o=!0,s=(e.date||"").slice(0,10),c=(n.dateRange.start||"").slice(0,10),l=(n.dateRange.end||"").slice(0,10);c&&l?o=s>=c&&s<=l:c?o=s>=c:l&&(o=s<=l);var u=e.price>=n.priceRange.min&&e.price<=n.priceRange.max;return a&&i&&o&&u}));if(r){for(var i=[],o=[],s=0,c=a;s<c.length;s++){var l=c[s],u=l.title.toLowerCase();u.startsWith(r)?i.push(l):u.includes(r)&&o.push(l)}a=$t($t([],i,!0),o,!0)}return{filteredEvents:a}}().filteredEvents,c=(0,a.useState)(!1),l=c[0],u=c[1],d=fe((function(e){return e.search.value})),f=fe((function(e){return e.city.name})),h=fe((function(e){var t;return(null===(t=e.auth.user)||void 0===t?void 0:t.favorites)||[]})),v=fe((function(e){return e.auth.isAuthenticated})),p=(0,a.useState)(!1),m=p[0],y=p[1],x=(0,a.useState)(!1),g=x[0],b=x[1];(0,a.useEffect)((function(){var t=en(en({},o),{search:d});o.onlyMyCity&&f&&"Город"!==f?t.city=f:delete t.city,e(q(t))}),[e,o,d,f]),(0,a.useEffect)((function(){var e=null;return n?e=setTimeout((function(){return u(!0)}),250):u(!1),function(){e&&clearTimeout(e)}}),[n]);return{loading:l,error:r,filteredEvents:s.map((function(e){return en(en({},e),{isFavorite:h.includes(e.id)})})),handleAddToFavorites:function(t){v?e(B(t)):y(!0)},handleRemoveFromFavorites:function(t){e(T(t))},handleBuyTicket:function(e){},handleDateSelect:function(t){e(se(en(en({},i),{dateRange:{start:t,end:t}})))},handleRangeSelect:function(t,n){e(se(en(en({},i),{dateRange:{start:t,end:n}})))},showAuthAlert:m,setShowAuthAlert:y,showAuthModal:g,setShowAuthModal:b,isAuthenticated:v}};var nn={position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.25)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},rn={background:"#fff",borderRadius:12,padding:"2rem 2.5rem",boxShadow:"0 4px 24px rgba(0,0,0,0.13)",minWidth:320,maxWidth:"90vw",textAlign:"center",position:"relative"},an={marginTop:24,padding:"0.7rem 2.2rem",borderRadius:24,border:"none",background:"#2563eb",color:"#fff",fontWeight:600,fontSize:"1.1rem",cursor:"pointer"},on={position:"absolute",top:10,right:16,fontSize:22,color:"#888",background:"none",border:"none",cursor:"pointer"};const sn=function(e){var t=e.isOpen,n=e.onClose,i=e.onAuthClick;return(0,a.useEffect)((function(){if(t){var e=function(){if("undefined"==typeof window)return 0;var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.overflow="scroll",e.style.position="absolute",e.style.top="-9999px",document.body.appendChild(e);var t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),t}();document.body.style.overflow="hidden",e>0&&(document.body.style.paddingRight="".concat(e,"px"));var r=function(e){"Escape"===e.key&&n()};return window.addEventListener("keydown",r),function(){document.body.style.overflow="",document.body.style.paddingRight="",window.removeEventListener("keydown",r)}}document.body.style.overflow="",document.body.style.paddingRight=""}),[t,n]),t?(0,r.jsx)("div",{style:nn,onClick:n,children:(0,r.jsxs)("div",{style:rn,onClick:function(e){return e.stopPropagation()},children:[(0,r.jsx)("button",{style:on,onClick:n,"aria-label":"Закрыть",children:"×"}),(0,r.jsx)("div",{style:{fontSize:"1.15rem",color:"#222",marginBottom:16},children:"Чтобы добавить событие в избранное, необходимо войти в аккаунт"}),(0,r.jsx)("button",{style:an,onClick:i,children:"Войти или зарегистрироваться"})]})}):null};const cn=function(){var e=tn(),t=e.loading,n=e.error,i=e.filteredEvents,o=e.handleAddToFavorites,s=e.handleRemoveFromFavorites,c=e.handleBuyTicket,l=e.handleDateSelect,u=e.handleRangeSelect,d=e.showAuthAlert,f=e.setShowAuthAlert,h=e.showAuthModal,v=e.setShowAuthModal,p=de(),m=fe((function(e){return e.auth.isAuthenticated}));return a.useEffect((function(){m&&p(F())}),[m,p]),t?(0,r.jsx)("div",{className:_t,children:"Загрузка..."}):n?(0,r.jsxs)("div",{className:Qt,children:["Ошибка: ",n]}):(0,r.jsxs)("div",{className:Zt,children:[(0,r.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"1.5rem",marginBottom:"-1.5rem"},children:(0,r.jsx)(Xt,{onDateSelect:l,onRangeSelect:u})}),(0,r.jsxs)("div",{className:Vt,children:[(0,r.jsx)("aside",{className:Jt,children:(0,r.jsx)(Nt,{})}),(0,r.jsx)("main",{className:Kt,children:(0,r.jsx)(bt,{events:i,onAddToFavorites:o,onRemoveFromFavorites:s,onBuyTicket:c,loading:t,error:n})})]}),(0,r.jsx)(sn,{isOpen:d,onClose:function(){return f(!1)},onAuthClick:function(){f(!1),v(!0)}}),(0,r.jsx)(Ne,{isOpen:h,onClose:function(){return v(!1)}})]})},ln="Crw2kdr1",un="C39kYaHZ",dn="wrxPl7G8",fn="IdcN0Kf5",hn="twJoggpY",vn="_3vJED9ON",pn="KJlTLrGi",mn="glgAjrDd",yn="dkPJn_jE",xn="cmk1F0Pv",gn="H5IQESIf",bn="cr0iTSDn",jn="oRSOIwGU",wn="DhyDvIL9",kn="mt2JOtaW",Nn="_RzXGQFk",Cn="cZJTIiqp",Sn="EJOHFjYL",An="EbW2xjXI",Pn="EXuRoKnY",En="uXDX9P80",Rn="uHtTRs6c",In="SeuQM5i6",On="ZW_on0Wd",Dn="cnbyq8qV",Bn="nN4bYVhl",Tn="ZY5CyOvD",Fn="xRLXsmc7",Ln="UOOBhP8t",Mn="F8SWk08z",Wn="XbW9JRyl",Un="Bgg_oSA9",zn="ocqDJswv";var Gn=function(){return Gn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Gn.apply(this,arguments)},qn=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},Hn=function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};const Yn=function(){var e,t=(0,s.Zp)(),n=de(),i=fe((function(e){return e.auth})).user,o=fe((function(e){return e.event})),c=(o.events,o.loading),l=o.error,u=(0,a.useState)(!1),d=u[0],f=u[1],h=(0,a.useState)(!1),v=h[0],p=h[1],m=(0,a.useState)({username:(null==i?void 0:i.username)||"",email:(null==i?void 0:i.email)||"",city:(null==i?void 0:i.city)||""}),y=m[0],x=m[1];(0,a.useEffect)((function(){i&&n(Y())}),[n,i]);return i?c?(0,r.jsx)("div",{className:On,children:"Загрузка..."}):l?(0,r.jsx)("div",{className:Dn,children:l}):(0,r.jsx)("div",{className:ln,children:(0,r.jsxs)("div",{className:un,children:[(0,r.jsxs)("div",{className:dn,children:[(0,r.jsxs)("div",{className:hn,children:[(0,r.jsx)("div",{className:vn}),(0,r.jsx)("img",{src:i.avatarUrl?i.avatarUrl.startsWith("/uploads")?"".concat(null===(e="https://ebilet-8f91.onrender.com/api")?void 0:e.replace("/api","")).concat(i.avatarUrl):i.avatarUrl:"/img/default-avatar.svg",alt:"Avatar",className:pn}),d&&(0,r.jsxs)("label",{className:Nn,children:[(0,r.jsx)("svg",{width:"20",height:"20",fill:"none",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{d:"M4 7a2 2 0 012-2h2.172a2 2 0 001.414-.586l.828-.828A2 2 0 0112.828 3h2.344a2 2 0 011.414.586l.828.828A2 2 0 0020 5h2a2 2 0 012 2v12a2 2 0 01-2 2H4a2 2 0 01-2-2V7zm8 3a4 4 0 100 8 4 4 0 000-8zm0 2a2 2 0 110 4 2 2 0 010-4z",fill:"#2563eb"})}),(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:function(e){return qn(void 0,void 0,void 0,(function(){var t,r;return Hn(this,(function(a){switch(a.label){case 0:return(t=null===(r=e.target.files)||void 0===r?void 0:r[0])?[4,n(O(t))]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))},style:{display:"none"}})]})]}),(0,r.jsxs)("div",{className:fn,children:[(0,r.jsxs)("div",{className:mn,children:["Привет, ",i.username,"!"]}),!d&&(0,r.jsx)("button",{className:En,onClick:function(){return f(!0)},children:(0,r.jsxs)("svg",{width:"20",height:"20",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{d:"M4 17.25V19a.75.75 0 00.75.75h1.75a.75.75 0 00.53-.22l9.72-9.72a.75.75 0 000-1.06l-2.25-2.25a.75.75 0 00-1.06 0l-9.72 9.72a.75.75 0 00-.22.53z",stroke:"#2563eb",strokeWidth:"2"}),(0,r.jsx)("path",{d:"M15.5 6.5l2 2",stroke:"#2563eb",strokeWidth:"2",strokeLinecap:"round"})]})})]}),(0,r.jsxs)("div",{className:yn,children:[(0,r.jsxs)("div",{children:["Email: ",i.email]}),(0,r.jsxs)("div",{children:["Город: ",i.city]})]}),(0,r.jsxs)("div",{className:bn,children:[(0,r.jsxs)("div",{className:jn,children:[(0,r.jsx)("div",{className:wn,children:"0"}),(0,r.jsx)("div",{className:kn,children:"Куплено билетов"})]}),(0,r.jsxs)("div",{className:jn,children:[(0,r.jsx)("div",{className:wn,children:i.favorites?i.favorites.length:0}),(0,r.jsx)("div",{className:kn,children:"Избранное"})]})]}),(0,r.jsxs)("div",{className:xn,children:[(0,r.jsxs)("button",{className:gn,type:"button",onClick:function(){return t("/my-tickets")},children:[(0,r.jsxs)("svg",{width:"20",height:"20",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{d:"M4 7.5A2.5 2.5 0 016.5 5h11A2.5 2.5 0 0120 7.5v9A2.5 2.5 0 0117.5 19h-11A2.5 2.5 0 014 16.5v-9z",stroke:"#2563eb",strokeWidth:"2"}),(0,r.jsx)("path",{d:"M8 9h8M8 13h5",stroke:"#2563eb",strokeWidth:"2",strokeLinecap:"round"})]}),"Мои билеты"]}),(0,r.jsxs)("button",{className:gn,type:"button",onClick:function(){return t("/my-tickets",{state:{tab:"favorites"}})},children:[(0,r.jsx)("svg",{width:"20",height:"20",fill:"none",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{d:"M12 21s-7-5.686-7-10.5A5.5 5.5 0 0112 5a5.5 5.5 0 017 5.5C19 15.314 12 21 12 21z",stroke:"#2563eb",strokeWidth:"2"})}),"Избранное"]}),(0,r.jsxs)("div",{className:zn,children:[(0,r.jsxs)("button",{className:gn+" "+Tn,type:"button",onClick:function(){return p(!0)},children:[(0,r.jsx)("svg",{width:"20",height:"20",fill:"none",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{d:"M6 18L18 6M6 6l12 12",stroke:"#2563eb",strokeWidth:"2",strokeLinecap:"round"})}),"Выйти"]}),v&&(0,r.jsxs)("div",{className:Fn,children:[(0,r.jsx)("div",{className:Ln,children:"Выйти из аккаунта?"}),(0,r.jsxs)("div",{className:Mn,children:[(0,r.jsx)("button",{className:Wn,onClick:function(){n(M()),p(!1)},children:"Выйти"}),(0,r.jsx)("button",{className:Un,onClick:function(){return p(!1)},children:"Отмена"})]})]})]})]})]}),d&&(0,r.jsx)("div",{className:Bn,children:(0,r.jsx)("div",{className:Cn,children:(0,r.jsxs)("form",{className:Sn,children:[(0,r.jsxs)("div",{className:An,children:[(0,r.jsx)("label",{children:"Имя пользователя"}),(0,r.jsx)("input",{type:"text",name:"username",value:y.username,onChange:function(e){var t;x(Gn(Gn({},y),((t={})[e.target.name]=e.target.value,t)))}})]}),(0,r.jsxs)("div",{className:Pn,children:[(0,r.jsx)("button",{type:"submit",className:Rn,children:"Сохранить"}),(0,r.jsx)("button",{type:"button",className:In,onClick:function(){return f(!1)},children:"Отмена"})]})]})})})]})}):(0,r.jsx)("div",{className:Dn,children:"Пожалуйста, войдите в систему"})},Xn="_ifCH7uh",Zn="GbLO1eUY",Vn="KXB6Wmqr",Jn="jmziS_bF",Kn="tmOnqDUR",_n="jt9o2PT4",Qn="G9gCuTYe",$n="Y8ze9CgU";var er=function(){return er=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},er.apply(this,arguments)},tr=[{key:"tickets",label:"Мои билеты"},{key:"favorites",label:"Избранное"}];const nr=function(){var e=(0,a.useState)("tickets"),t=e[0],n=e[1],i=de(),o=fe((function(e){var t;return(null===(t=e.auth.user)||void 0===t?void 0:t.favorites)||[]})),s=fe((function(e){return e.event.events})).filter((function(e){return o.includes(e.id)})).map((function(e){return er(er({},e),{isFavorite:!0})})),c=fe((function(e){return e.auth.loading})),l=fe((function(e){return e.auth.error}));return(0,a.useEffect)((function(){"favorites"===t&&(i(F()),i(q({})))}),[t,i]),(0,r.jsxs)("div",{className:Xn,children:[(0,r.jsx)("h1",{children:"Мои события"}),(0,r.jsx)("div",{className:Zn,children:tr.map((function(e){return(0,r.jsx)("button",{className:t===e.key?Jn:Vn,onClick:function(){return n(e.key)},type:"button",children:e.label},e.key)}))}),(0,r.jsx)("div",{className:Kn,children:"tickets"===t?(0,r.jsxs)("div",{className:_n,children:[(0,r.jsxs)("svg",{className:Qn,viewBox:"0 0 48 48",fill:"none",children:[(0,r.jsx)("circle",{cx:"24",cy:"24",r:"22",fill:"#e3eaff",stroke:"#bfc8d6",strokeWidth:"2"}),(0,r.jsx)("path",{d:"M16 28c1.5-2 4.5-2 6 0s4.5 2 6 0",stroke:"#bfc8d6",strokeWidth:"2",strokeLinecap:"round"}),(0,r.jsx)("circle",{cx:"18",cy:"20",r:"2",fill:"#bfc8d6"}),(0,r.jsx)("circle",{cx:"30",cy:"20",r:"2",fill:"#bfc8d6"})]}),(0,r.jsx)("div",{className:$n,children:"У вас пока нет купленных билетов"})]}):s.length>0?(0,r.jsx)(bt,{events:s,onAddToFavorites:function(){},onRemoveFromFavorites:function(){},onBuyTicket:function(){},loading:c,error:l}):(0,r.jsxs)("div",{className:_n,children:[(0,r.jsxs)("svg",{className:Qn,viewBox:"0 0 48 48",fill:"none",children:[(0,r.jsx)("circle",{cx:"24",cy:"24",r:"22",fill:"#e3eaff",stroke:"#bfc8d6",strokeWidth:"2"}),(0,r.jsx)("path",{d:"M16 28c1.5-2 4.5-2 6 0s4.5 2 6 0",stroke:"#bfc8d6",strokeWidth:"2",strokeLinecap:"round"}),(0,r.jsx)("circle",{cx:"18",cy:"20",r:"2",fill:"#bfc8d6"}),(0,r.jsx)("circle",{cx:"30",cy:"20",r:"2",fill:"#bfc8d6"})]}),(0,r.jsx)("div",{className:$n,children:"У вас пока нет избранных событий"})]})})]})},rr="oNLuKqJw",ar="QPT3LbSV";const ir=function(){return(0,r.jsx)(c.Kq,{store:ue,children:(0,r.jsx)(o.Kd,{basename:"/ebilet",children:(0,r.jsxs)("div",{className:rr,children:[(0,r.jsx)(rt,{}),(0,r.jsx)("main",{className:ar,children:(0,r.jsxs)(s.BV,{children:[(0,r.jsx)(s.qh,{path:"/",element:(0,r.jsx)(cn,{})}),(0,r.jsx)(s.qh,{path:"/profile",element:(0,r.jsx)(Yn,{})}),(0,r.jsx)(s.qh,{path:"/my-tickets",element:(0,r.jsx)(nr,{})})]})})]})})})};i.createRoot(document.getElementById("root")).render((0,r.jsx)(a.StrictMode,{children:(0,r.jsx)(ir,{})}))}},e=>{e.O(0,[720],(()=>{return t=275,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=main.f476d213.js.map