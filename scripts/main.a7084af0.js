"use strict";(self.webpackChunkebilet_client=self.webpackChunkebilet_client||[]).push([[792],{273:(e,n,t)=>{var r=t(848),a=t(540),i=t(338),o=t(976),s=t(767),c=t(468),l=t(816),u=t(83),d=function(e,n,t,r){return new(t||(t=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,s)}c((r=r.apply(e,n||[])).next())}))},f=function(e,n){var t,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=n.call(e,i)}catch(e){s=[6,e],r=0}finally{t=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},h=function(e,n,t){if(t||2===arguments.length)for(var r,a=0,i=n.length;a<i;a++)!r&&a in n||(r||(r=Array.prototype.slice.call(n,0,a)),r[a]=n[a]);return e.concat(r||Array.prototype.slice.call(n))},p=u.A.create({baseURL:"https://ebilet-8f91.onrender.com/api",headers:{"Content-Type":"application/json"}});p.interceptors.request.use((function(e){var n=localStorage.getItem("token");return n&&(e.headers.Authorization="Bearer ".concat(n)),e}));var v,m=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(n){switch(n.label){case 0:return[4,p.post("/auth/register",e)];case 1:return[2,n.sent().data]}}))}))},y=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(n){switch(n.label){case 0:return[4,p.post("/auth/login",e)];case 1:return[2,n.sent().data]}}))}))},g=function(e){return d(void 0,void 0,void 0,(function(){var n;return f(this,(function(t){switch(t.label){case 0:return(n=new FormData).append("avatar",e),[4,p.post("/auth/avatar",n,{headers:{"Content-Type":"multipart/form-data"}})];case 1:return[2,t.sent().data]}}))}))},x=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(n){switch(n.label){case 0:return[4,p.patch("/auth/city",{city:e})];case 1:return[2,n.sent().data]}}))}))},j=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return d(void 0,h([],e,!0),void 0,(function(e){var n;return void 0===e&&(e={}),f(this,(function(t){switch(t.label){case 0:return n=new URLSearchParams,e.category&&n.append("category",e.category),e.subcategory&&n.append("subcategory",e.subcategory),e.priceRange&&"object"==typeof e.priceRange&&(void 0!==e.priceRange.min&&n.append("minPrice",String(e.priceRange.min)),void 0!==e.priceRange.max&&n.append("maxPrice",String(e.priceRange.max))),e.search&&n.append("search",e.search),e.city&&n.append("city",e.city),[4,p.get("/events",{params:n})];case 1:return[2,t.sent().data]}}))}))},b=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(n){switch(n.label){case 0:return[4,p.get("/events/".concat(e))];case 1:return[2,n.sent().data]}}))}))},w=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(n){switch(n.label){case 0:return[4,p.post("/events",e,{headers:{"Content-Type":"multipart/form-data"}})];case 1:return[2,n.sent().data]}}))}))},N=function(){return d(void 0,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,p.get("/events/user/events")];case 1:return[2,e.sent().data]}}))}))},k=function(e,n,t,r){return new(t||(t=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,s)}c((r=r.apply(e,n||[])).next())}))},C=function(e,n){var t,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=n.call(e,i)}catch(e){s=[6,e],r=0}finally{t=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},S={user:null,token:localStorage.getItem("token"),isAuthenticated:!1,loading:!1,error:null},P=(0,l.zD)("auth/register",(function(e,n){return k(void 0,[e,n],void 0,(function(e,n){var t,r,a,i=n.rejectWithValue;return C(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,m(e)];case 1:return t=n.sent(),localStorage.setItem("token",t.token),[2,t];case 2:return r=n.sent(),(a=r).response&&a.response.data&&a.response.data.message?[2,i(a.response.data.message)]:[2,i("Ошибка при регистрации")];case 3:return[2]}}))}))})),E=(0,l.zD)("auth/login",(function(e,n){return k(void 0,[e,n],void 0,(function(e,n){var t,r,a,i=n.rejectWithValue;return C(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,y(e)];case 1:return t=n.sent(),localStorage.setItem("token",t.token),[2,t];case 2:return r=n.sent(),(a=r).response&&a.response.data&&a.response.data.message?[2,i(a.response.data.message)]:[2,i("Ошибка при входе")];case 3:return[2]}}))}))})),R=(0,l.zD)("auth/uploadAvatar",(function(e){return k(void 0,void 0,void 0,(function(){return C(this,(function(n){switch(n.label){case 0:return[4,g(e)];case 1:return[2,n.sent()]}}))}))})),A=(0,l.zD)("auth/updateCity",(function(e,n){return k(void 0,[e,n],void 0,(function(e,n){var t=n.rejectWithValue;return C(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,x(e)];case 1:return[2,n.sent().city];case 2:return n.sent(),[2,t("Ошибка при обновлении города")];case 3:return[2]}}))}))})),D=(0,l.Z0)({name:"auth",initialState:S,reducers:{logout:function(e){e.user=null,e.token=null,e.isAuthenticated=!1,localStorage.removeItem("token")},clearError:function(e){e.error=null}},extraReducers:function(e){e.addCase(P.pending,(function(e){e.loading=!0,e.error=null})).addCase(P.fulfilled,(function(e,n){e.loading=!1,e.isAuthenticated=!0,e.user=n.payload.user,e.token=n.payload.token})).addCase(P.rejected,(function(e,n){e.loading=!1,e.error=n.payload||n.error.message||"Ошибка при регистрации"})).addCase(E.pending,(function(e){e.loading=!0,e.error=null})).addCase(E.fulfilled,(function(e,n){e.loading=!1,e.isAuthenticated=!0,e.user=n.payload.user,e.token=n.payload.token})).addCase(E.rejected,(function(e,n){e.loading=!1,e.error=n.payload||n.error.message||"Ошибка при входе"})).addCase(R.fulfilled,(function(e,n){e.user&&(e.user.avatarUrl=n.payload.avatarUrl)})).addCase(A.fulfilled,(function(e,n){e.user&&(e.user.city=n.payload)}))}}),I=(v=D.actions).logout;v.clearError;const O=D.reducer;var T=function(e,n,t,r){return new(t||(t=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,s)}c((r=r.apply(e,n||[])).next())}))},B=function(e,n){var t,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=n.call(e,i)}catch(e){s=[6,e],r=0}finally{t=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},L=function(e,n,t){if(t||2===arguments.length)for(var r,a=0,i=n.length;a<i;a++)!r&&a in n||(r||(r=Array.prototype.slice.call(n,0,a)),r[a]=n[a]);return e.concat(r||Array.prototype.slice.call(n))},U=(0,l.zD)("event/fetchEvents",(function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return T(void 0,L([],e,!0),void 0,(function(e){return void 0===e&&(e={}),B(this,(function(n){switch(n.label){case 0:return[4,j(e)];case 1:return[2,n.sent()]}}))}))})),F=((0,l.zD)("event/fetchEventById",(function(e){return T(void 0,void 0,void 0,(function(){return B(this,(function(n){switch(n.label){case 0:return[4,b(e)];case 1:return[2,n.sent()]}}))}))})),(0,l.zD)("event/createEvent",(function(e){return T(void 0,void 0,void 0,(function(){return B(this,(function(n){switch(n.label){case 0:return[4,w(e)];case 1:return[2,n.sent()]}}))}))}))),M=(0,l.zD)("event/fetchUserEvents",(function(){return T(void 0,void 0,void 0,(function(){return B(this,(function(e){switch(e.label){case 0:return[4,N()];case 1:return[2,e.sent()]}}))}))})),q=(0,l.Z0)({name:"event",initialState:{events:[],loading:!1,error:null},reducers:{clearError:function(e){e.error=null}},extraReducers:function(e){e.addCase(U.pending,(function(e){e.loading=!0,e.error=null})).addCase(U.fulfilled,(function(e,n){e.loading=!1,e.events=n.payload})).addCase(U.rejected,(function(e,n){e.loading=!1,e.error=n.error.message||"Ошибка при загрузке событий"})).addCase(F.pending,(function(e){e.loading=!0,e.error=null})).addCase(F.fulfilled,(function(e,n){e.loading=!1,e.events.unshift(n.payload)})).addCase(F.rejected,(function(e,n){e.loading=!1,e.error=n.error.message||"Ошибка при создании события"})).addCase(M.pending,(function(e){e.loading=!0,e.error=null})).addCase(M.fulfilled,(function(e,n){e.loading=!1,e.events=n.payload})).addCase(M.rejected,(function(e,n){e.loading=!1,e.error=n.error.message||"Ошибка при загрузке событий пользователя"}))}});q.actions.clearError;const z=q.reducer;var G,H=function(e,n,t,r){return new(t||(t=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,s)}c((r=r.apply(e,n||[])).next())}))},W=function(e,n){var t,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=n.call(e,i)}catch(e){s=[6,e],r=0}finally{t=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},X=(0,l.zD)("city/fetchByIP",(function(e,n){return H(void 0,[e,n],void 0,(function(e,n){var t,r,a,i,o,s,c,l,u,d,f,h,p,v,m,y,g=n.rejectWithValue;return W(this,(function(e){switch(e.label){case 0:return e.trys.push([0,6,,7]),t="90cea4be77d44b80ab21374726d21b70",console.log("[fetchCityByIP] Используемый API-ключ:",t),r="https://api.ipgeolocation.io/ipgeo?apiKey=".concat(t),console.log("[fetchCityByIP] URL запроса:",r),[4,fetch(r)];case 1:return a=e.sent(),console.log("[fetchCityByIP] Статус ответа:",a.status),a.ok?[4,a.json()]:(console.error("[fetchCityByIP] Ошибка API:",a.status),[2,g("Ошибка API: ".concat(a.status))]);case 2:return i=e.sent(),console.log("[fetchCityByIP] Данные от ipgeolocation:",i),o=i.city,s=i.latitude,c=i.longitude,s&&c?(l="https://nominatim.openstreetmap.org/reverse?lat=".concat(s,"&lon=").concat(c,"&format=json&accept-language=ru"),console.log("[fetchCityByIP] URL запроса к Nominatim:",l),[4,fetch(l,{headers:{"User-Agent":"ebilet-app/1.0 (your@email.com)"}})]):(console.warn("[fetchCityByIP] Нет координат, возвращаю город:",o),[2,o||"Город"]);case 3:return u=e.sent(),console.log("[fetchCityByIP] Статус ответа Nominatim:",u.status),u.ok?[4,u.json()]:[3,5];case 4:if(d=e.sent(),console.log("[fetchCityByIP] Данные от Nominatim:",d),f=(null===(p=d.address)||void 0===p?void 0:p.city)||(null===(v=d.address)||void 0===v?void 0:v.town)||(null===(m=d.address)||void 0===m?void 0:m.village)||(null===(y=d.address)||void 0===y?void 0:y.state))return console.log("[fetchCityByIP] Город на русском найден:",f),[2,f];e.label=5;case 5:return console.warn("[fetchCityByIP] Город на русском не найден, возвращаю:",o),[2,o||"Город"];case 6:return h=e.sent(),console.error("[fetchCityByIP] Ошибка:",h),[2,g(h.message)];case 7:return[2]}}))}))})),Z=(0,l.Z0)({name:"city",initialState:{name:"Город",showPicker:!1},reducers:{openPicker:function(e){e.showPicker=!0},closePicker:function(e){e.showPicker=!1},setCity:function(e,n){e.name=n.payload,e.showPicker=!1}},extraReducers:function(e){e.addCase(X.fulfilled,(function(e,n){var t=n.payload;e.name=t,e.showPicker=!1})).addCase(X.rejected,(function(e){e.showPicker=!0}))}}),V=((G=Z.actions).openPicker,G.closePicker,G.setCity);const Y=Z.reducer;var K=(0,l.Z0)({name:"search",initialState:{value:""},reducers:{setSearch:function(e,n){e.value=n.payload}}}),_=K.actions.setSearch;const J=K.reducer;var Q,$={category:"",subcategory:"",dateRange:{start:"",end:""},priceRange:{min:0,max:1e4},onlyMyCity:!1},ee=(0,l.Z0)({name:"filter",initialState:$,reducers:{setFilters:function(e,n){return n.payload},resetFilters:function(){return $}}}),ne=(Q=ee.actions).setFilters,te=Q.resetFilters;const re=ee.reducer;var ae=(0,l.U1)({reducer:{auth:O,event:z,city:Y,search:J,filter:re}}),ie=function(){return(0,c.wA)()},oe=c.d4;const se="ZBn11TNK",ce="CUqvr6P1",le="AHg1PWg4",ue="lm66XJB1",de="bJBRsEr3",fe="afkZPFTr",he="qRFgd7Gl";var pe=function(){return pe=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},pe.apply(this,arguments)},ve=function(e,n,t,r){return new(t||(t=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,s)}c((r=r.apply(e,n||[])).next())}))},me=function(e,n){var t,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=n.call(e,i)}catch(e){s=[6,e],r=0}finally{t=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ye=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)n.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(t[r[a]]=e[r[a]])}return t};const ge=function(e){var n=e.isOpen,t=e.onClose,i=ie(),o=oe((function(e){return e.auth})),s=o.loading,c=o.error,l=o.isAuthenticated,u=oe((function(e){return e.city.name})),d=(0,a.useState)(!0),f=d[0],h=d[1],p=(0,a.useState)({username:"",email:"",password:"",confirmPassword:""}),v=p[0],m=p[1],y=(0,a.useState)(""),g=y[0],x=y[1],j=function(e){var n;m(pe(pe({},v),((n={})[e.target.name]=e.target.value,n)))};return(0,a.useEffect)((function(){n&&l&&f&&t()}),[l,n,f,t]),(0,a.useEffect)((function(){n&&(m({username:"",email:"",password:"",confirmPassword:""}),x(""))}),[n,f]),n?(0,r.jsx)("div",{className:se,onClick:t,children:(0,r.jsxs)("div",{className:ce,onClick:function(e){return e.stopPropagation()},children:[(0,r.jsx)("button",{className:le,onClick:t,children:"×"}),(0,r.jsx)("h2",{children:f?"Вход":"Регистрация"}),(0,r.jsxs)("form",{onSubmit:function(e){return ve(void 0,void 0,void 0,(function(){var n,r,a;return me(this,(function(o){switch(o.label){case 0:return e.preventDefault(),f||v.password===v.confirmPassword?f?(v.email,v.confirmPassword,n=ye(v,["email","confirmPassword"]),[4,i(E(n))]):[3,2]:(alert("Пароли не совпадают"),[2]);case 1:return o.sent(),[3,4];case 2:return v.confirmPassword,r=ye(v,["confirmPassword"]),[4,i(P(pe(pe({},r),{city:u})))];case 3:a=o.sent(),P.fulfilled.match(a)&&(x("Вы успешно зарегистрировались!"),setTimeout((function(){x(""),t()}),1500)),o.label=4;case 4:return[2]}}))}))},children:[(0,r.jsx)("div",{className:ue,children:(0,r.jsx)("input",{type:"text",name:"username",placeholder:"Имя пользователя",value:v.username,onChange:j,required:!0})}),!f&&(0,r.jsx)("div",{className:ue,children:(0,r.jsx)("input",{type:"email",name:"email",placeholder:"Email",value:v.email,onChange:j,required:!0})}),(0,r.jsx)("div",{className:ue,children:(0,r.jsx)("input",{type:"password",name:"password",placeholder:"Пароль",value:v.password,onChange:j,required:!0})}),!f&&(0,r.jsx)("div",{className:ue,children:(0,r.jsx)("input",{type:"password",name:"confirmPassword",placeholder:"Подтвердите пароль",value:v.confirmPassword,onChange:j,required:!0})}),(0,r.jsx)("button",{type:"submit",disabled:s,children:s?"Загрузка...":f?"Войти":"Зарегистрироваться"}),c&&(0,r.jsx)("p",{className:de,children:c}),g&&(0,r.jsx)("p",{className:fe,children:g})]}),(0,r.jsxs)("p",{className:he,children:[f?"Нет аккаунта?":"Уже есть аккаунт?"," ",(0,r.jsx)("button",{onClick:function(){return h(!f)},children:f?"Зарегистрироваться":"Войти"})]})]})}):null},xe="fAQaBm7b",je="PlasbFNv",be="kTUf0kGC",we="fEL3MMAt",Ne="fM4jt9LS",ke="L30DL5n3",Ce="r7jyaAy1",Se="IXD9sEDJ",Pe="a3hu4l6L";var Ee=function(){return(0,r.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{marginRight:6},children:(0,r.jsx)("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z",fill:"#007bff"})})};const Re=function(){var e=function(){var e=ie(),n=oe((function(e){return e.city})).name,t=oe((function(e){return e.auth})),r=t.isAuthenticated,i=t.user,o=(0,a.useState)(!1),s=o[0],c=o[1],l=(0,a.useState)(""),u=l[0],d=l[1],f=r?(null==i?void 0:i.city)||"Город":n;return(0,a.useEffect)((function(){d(f)}),[f]),{displayCity:f,editing:s,input:u,setEditing:c,setInput:d,handleSave:function(){u.trim()&&(r?(e(A(u.trim())),e(V(u.trim()))):e(V(u.trim())),c(!1))}}}(),n=e.displayCity,t=e.editing,i=e.input,o=e.setEditing,s=e.setInput,c=e.handleSave;return(0,r.jsxs)("div",{className:be,children:[(0,r.jsxs)("button",{className:we,onClick:function(){return o(!0)},"aria-label":"Выбрать город",children:[(0,r.jsx)(Ee,{}),(0,r.jsx)("span",{className:Ne,children:n})]}),t&&(0,r.jsx)("div",{className:ke,onClick:function(){return o(!1)},children:(0,r.jsxs)("div",{className:Ce,onClick:function(e){return e.stopPropagation()},children:[(0,r.jsx)("input",{className:Se,value:i,onChange:function(e){return s(e.target.value)},placeholder:"Введите город",autoFocus:!0}),(0,r.jsxs)("div",{className:Pe,children:[(0,r.jsx)("button",{className:xe,onClick:c,children:"Сохранить"}),(0,r.jsx)("button",{className:je,onClick:function(){return o(!1)},children:"Отмена"})]})]})})]})},Ae="u_gfar7T",De="c4nqin0V",Ie="vznLq989",Oe="RtxXsOy1",Te="zAcwWXS1",Be="yOBgwguB",Le="ecktM8Mn",Ue="WzUGgLsP",Fe="ODPKXZs7",Me="lUEi3qfW",qe="V_MqE9EB",ze="fsUi_MnL";const Ge=function(e){var n=e.user,t=e.avatarUrl,i=function(){var e=ie(),n=(0,s.Zp)(),t=(0,a.useState)(!1),r=t[0],i=t[1],o=(0,a.useState)(!1),c=o[0],l=o[1];return{showUserMenu:r,showLogoutConfirm:c,setShowUserMenu:i,setShowLogoutConfirm:l,onLogout:function(){e(I()),l(!1),i(!1)},onProfileClick:function(){i(!1),n("/profile")}}}(),o=i.showUserMenu,c=i.showLogoutConfirm,l=i.setShowUserMenu,u=i.setShowLogoutConfirm,d=i.onLogout,f=i.onProfileClick;return a.useEffect((function(){if(o){var e=function(e){var n=document.getElementById("user-menu-dropdown");n&&!n.contains(e.target)&&(l(!1),u(!1))};return document.addEventListener("mousedown",e),function(){return document.removeEventListener("mousedown",e)}}}),[o,l,u]),(0,r.jsxs)("div",{className:Ae,children:[(0,r.jsxs)("button",{className:De+(o?" "+Ie:""),onClick:function(){l(!o),u(!1)},"aria-haspopup":"true","aria-expanded":o,children:[(0,r.jsx)("img",{src:t,alt:"avatar",className:Oe}),(0,r.jsx)("span",{className:Te,children:null==n?void 0:n.username})]}),o&&(0,r.jsxs)("div",{className:Be,id:"user-menu-dropdown",children:[(0,r.jsx)("a",{className:Le,href:"/profile",onClick:function(e){e.preventDefault(),l(!1),f()},children:"Мой профиль"}),(0,r.jsx)("div",{className:Ue}),c?(0,r.jsxs)("div",{className:Fe,children:["Выйти из аккаунта?",(0,r.jsxs)("div",{className:Me,children:[(0,r.jsx)("button",{className:qe,onClick:function(){d(),u(!1),l(!1)},children:"Да"}),(0,r.jsx)("button",{className:ze,onClick:function(){return u(!1)},children:"Нет"})]})]}):(0,r.jsx)("button",{className:Le,onClick:function(){return u(!0)},children:"Выйти"})]})]})},He="g41BiwqO",We="Ur4ZVcPj",Xe="NZN2De8g",Ze="EgI6UGtM",Ve="C12NQz6V",Ye="THy6AUoD",Ke="PGbuMa0s";const _e=function(){var e=ie(),n=oe((function(e){return e.search.value}));return(0,r.jsx)("div",{className:Ke,children:(0,r.jsx)("input",{type:"text",placeholder:"Поиск мероприятий...",value:n,onChange:function(n){return e(_(n.target.value))}})})};const Je=function(){var e,n=ie(),t=oe((function(e){return e.auth})),i=t.user,s=t.isAuthenticated,c=(0,a.useState)(!1),l=c[0],u=c[1];oe((function(e){return e.search.value}));(0,a.useEffect)((function(){s?(null==i?void 0:i.city)&&"Город"!==i.city?n(V(i.city)):n(X()).then((function(e){X.fulfilled.match(e)&&(n(A(e.payload)),n(V(e.payload)))})):n(X()).then((function(e){X.fulfilled.match(e)&&n(V(e.payload))}))}),[s]);var d=(null==i?void 0:i.avatarUrl)?i.avatarUrl.startsWith("/uploads")?"".concat(null===(e="https://ebilet-8f91.onrender.com/api")?void 0:e.replace("/api","")).concat(i.avatarUrl):i.avatarUrl:"/img/default-avatar.svg";return(0,r.jsxs)("header",{className:He,children:[(0,r.jsxs)("div",{className:We,children:[(0,r.jsx)(o.N_,{to:"/",className:Xe,children:"EBilet"}),(0,r.jsx)(_e,{}),(0,r.jsxs)("nav",{className:Ze,children:[(0,r.jsx)(Re,{}),s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.N_,{to:"/my-tickets",className:Ve,children:"Мои события"}),(0,r.jsx)(Ge,{user:i,avatarUrl:d})]}):(0,r.jsx)("button",{onClick:function(){return u(!0)},className:Ye,children:"Войти"})]})]}),(0,r.jsx)(ge,{isOpen:l,onClose:function(){return u(!1)}})]})},Qe="q5cSkrMt",$e="Ae6HeLkd",en="Y5GpHGmX",nn="rwPoguZK",tn="cck_aaWJ",rn="HPiEpQok",an="FiozW65V",on="aYq2HTAm",sn="SOh8XEf3",cn="DkILKbzx",ln="LgrZNhg5",un="EkpXFwbY",dn="BTMdkehq";const fn=function(e){var n,t,a=e.event,i=e.onAddToFavorites,o=e.onBuyTicket;return(0,r.jsxs)("div",{className:Qe,children:[a.imageUrl&&(0,r.jsx)("div",{className:$e,children:(0,r.jsx)("img",{src:a.imageUrl.startsWith("/uploads")?"".concat(null===(n="https://ebilet-8f91.onrender.com/api")?void 0:n.replace("/api","")).concat(a.imageUrl):a.imageUrl,alt:a.title,className:en})}),(0,r.jsxs)("div",{className:nn,children:[(0,r.jsx)("h3",{className:tn,children:a.title}),(0,r.jsx)("p",{className:rn,children:a.description}),(0,r.jsxs)("div",{className:an,children:[(0,r.jsx)("span",{className:on,children:(t=a.date,new Date(t).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"}))}),(0,r.jsx)("span",{className:sn,children:a.location}),(0,r.jsxs)("span",{className:cn,children:[a.price," ₽"]})]}),(0,r.jsxs)("div",{className:ln,children:[(0,r.jsx)("button",{className:un,onClick:function(){return i(a.id)},children:"В избранное"}),(0,r.jsx)("button",{className:dn,onClick:function(){return o(a.id)},children:"Купить билет"})]})]})]})},hn={eventsGrid:"qBEGkhBl",skeletonCard:"RbbVmJFy",skeletonPulse:"vpMKu1Ol",skeletonImage:"vlm4unXd",skeletonContent:"NBc2AoOt",skeletonTitle:"f2LiwQAJ",skeletonText:"zS2iyEE3",skeletonActions:"R2oGtYoV"};var pn=t(164);const vn=function(e){var n=e.events,t=e.onAddToFavorites,a=e.onBuyTicket,i=e.loading,o=e.error;return i?(0,r.jsx)("div",{className:hn.eventsGrid,children:Array.from({length:6}).map((function(e,n){return(0,r.jsxs)("div",{className:(0,pn.A)(hn.skeletonCard,hn.card),children:[(0,r.jsx)("div",{className:hn.skeletonImage}),(0,r.jsxs)("div",{className:hn.skeletonContent,children:[(0,r.jsx)("div",{className:hn.skeletonTitle}),(0,r.jsx)("div",{className:hn.skeletonText}),(0,r.jsx)("div",{className:hn.skeletonText}),(0,r.jsx)("div",{className:hn.skeletonActions})]})]},n)}))}):o?(0,r.jsx)("div",{className:hn.eventsGrid,children:(0,r.jsxs)("div",{style:{gridColumn:"1/-1",color:"#dc3545",textAlign:"center",padding:"2rem"},children:["Ошибка: ",o]})}):(0,r.jsx)("div",{className:hn.eventsGrid,children:n.map((function(e){return(0,r.jsx)(fn,{event:e,onAddToFavorites:t,onBuyTicket:a},e.id)}))})},mn={filters:"fwAkczIH",title:"iCXDBxH_",section:"kBXyRaRk",label:"GUckwTmH",select:"Y8pf8z9R",input:"ghCNQt6h",dateRange:"bvfcjHbC",priceRange:"yVFLEEy2"};var yn=function(){return yn=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},yn.apply(this,arguments)},gn={concert:["рок","поп","классика","джаз"],theater:["драма","комедия","мюзикл"],exhibition:["искусство","наука","технологии"],sport:["футбол","баскетбол","теннис"]};const xn=function(){var e=ie(),n=oe((function(e){return e.filter})),t=function(t,r){var a,i=yn(yn({},n),((a={})[t]=r,a));"category"===t&&(i=yn(yn({},i),{subcategory:""})),e(ne(i))};return(0,r.jsxs)("div",{className:mn.filters,children:[(0,r.jsx)("h3",{className:mn.title,children:"Фильтры"}),(0,r.jsxs)("div",{className:mn.section,children:[(0,r.jsx)("label",{className:mn.label,children:"Категория"}),(0,r.jsxs)("select",{className:mn.select,value:n.category,onChange:function(e){return t("category",e.target.value)},children:[(0,r.jsx)("option",{value:"",children:"Все категории"}),(0,r.jsx)("option",{value:"concert",children:"Концерты"}),(0,r.jsx)("option",{value:"theater",children:"Театр"}),(0,r.jsx)("option",{value:"exhibition",children:"Выставки"}),(0,r.jsx)("option",{value:"sport",children:"Спорт"})]})]}),n.category&&gn[n.category]&&(0,r.jsxs)("div",{className:mn.section,children:[(0,r.jsx)("label",{className:mn.label,children:"Подкатегория"}),(0,r.jsxs)("select",{className:mn.select,value:n.subcategory,onChange:function(e){return t("subcategory",e.target.value.toLowerCase())},children:[(0,r.jsx)("option",{value:"",children:"Все подкатегории"}),gn[n.category].map((function(e){return(0,r.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e)}))]})]}),(0,r.jsxs)("div",{className:mn.section,children:[(0,r.jsx)("label",{className:mn.label,children:"Цена"}),(0,r.jsxs)("div",{className:mn.priceRange,children:[(0,r.jsx)("input",{type:"number",className:mn.input,placeholder:"От",value:n.priceRange.min,onChange:function(e){return t("priceRange",yn(yn({},n.priceRange),{min:Number(e.target.value)}))}}),(0,r.jsx)("input",{type:"number",className:mn.input,placeholder:"До",value:n.priceRange.max,onChange:function(e){return t("priceRange",yn(yn({},n.priceRange),{max:Number(e.target.value)}))}})]})]}),(0,r.jsx)("div",{className:mn.section,children:(0,r.jsxs)("label",{className:mn.label,style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,r.jsx)("input",{type:"checkbox",checked:n.onlyMyCity,onChange:function(e){return t("onlyMyCity",e.target.checked)},style:{marginRight:"0.5rem"}}),"Искать в моем городе"]})}),(0,r.jsx)("button",{className:mn.resetBtn,onClick:function(){e(te())},style:{marginTop:"1.5rem",width:"100%",background:"#e3eaff",color:"#2563eb",border:"none",borderRadius:"6px",padding:"0.6rem 0",fontWeight:600,cursor:"pointer"},children:"Сбросить фильтры"})]})},jn="j0hpXBhN",bn="eHWccHhH",wn="vYHN7kuE",Nn="uoLFLMYf",kn="H77EWGMO",Cn="NMRhFUn6",Sn="J96oD63O",Pn="qeNvi5fk",En="KFdP2fDA",Rn="kNzAYewg",An="DM0HIRNy",Dn="ENnngIek",In="xBFG1fFa",On="ZmmTvOnY",Tn="ktm0PLty";var Bn=t(691),Ln=(t(995),t(614)),Un=["ПН","ВТ","СР","ЧТ","ПТ","СБ","ВС"],Fn=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],Mn=function(e){return e.toString().padStart(2,"0")},qn=function(e){return"".concat(e.getFullYear(),"-").concat(Mn(e.getMonth()+1),"-").concat(Mn(e.getDate()))};const zn=function(e){var n=e.onDateSelect,t=e.onRangeSelect,i=new Date,o=(0,a.useState)(!1),s=o[0],c=o[1],l=(0,a.useState)(null),u=l[0],d=l[1],f=(0,a.useState)([null,null]),h=f[0],p=f[1],v=(0,a.useState)(i.getMonth()),m=v[0],y=v[1],g=(0,a.useState)(i.getFullYear()),x=g[0],j=g[1];(0,a.useEffect)((function(){if(u||h[0]||h[1]){var e=function(){d(null),p([null,null])};return window.addEventListener("reset-date-strip",e),function(){return window.removeEventListener("reset-date-strip",e)}}}),[u,h]);var b=function(e,n){for(var t=[],r=new Date(e,n,1);r.getMonth()===n;)t.push(new Date(r)),r.setDate(r.getDate()+1);return t}(x,m),w=new Date(x,m,1).getDay();0===w&&(w=7);Array(w-1).fill(null);var N=function(e){if(Array.isArray(e))p(e),d(null),e[0]&&e[1]&&(t(qn(e[0]),qn(e[1])),c(!1));else if(e instanceof Date){d(e),p([null,null]);var r=qn(e);n(r),c(!1)}},k=function(){d(null),p([null,null]),t("",""),c(!1)};return(0,r.jsxs)("div",{className:jn,children:[(0,r.jsxs)("div",{className:bn,children:[(0,r.jsx)("button",{className:Nn,onClick:function(){0===m?(y(11),j((function(e){return e-1}))):y((function(e){return e-1}))},children:"←"}),(0,r.jsxs)("span",{className:wn,children:[Fn[m]," ",x]}),(0,r.jsx)("button",{className:Nn,onClick:function(){11===m?(y(0),j((function(e){return e+1}))):y((function(e){return e+1}))},children:"→"})]}),(0,r.jsx)("div",{className:kn,children:(0,r.jsx)("div",{className:Sn,children:b.map((function(e){var a=e.toDateString()===i.toDateString(),o=u&&e.toDateString()===u.toDateString(),s=Un[(e.getDay()+6)%7];return(0,r.jsxs)("button",{className:Pn+(o?" "+En:"")+(a?" "+Rn:""),onClick:function(){return function(e){d(e),p([null,null]);var r=qn(e);n(r),t(r,r)}(e)},children:[(0,r.jsx)("span",{className:Cn,children:s}),(0,r.jsx)("span",{className:An,children:e.getDate()})]},e.toISOString())}))})}),(0,r.jsx)("button",{className:Dn,onClick:function(){return c(!0)},children:"📅"}),s&&(0,r.jsx)((function(){return(0,r.jsx)("div",{className:In,onClick:function(){return c(!1)},children:(0,r.jsxs)("div",{className:On,onClick:function(e){return e.stopPropagation()},children:[(0,r.jsx)(Bn.Ay,{selected:u,onChange:N,startDate:h[0],endDate:h[1],selectsRange:!0,inline:!0,locale:Ln.ru,dateFormat:"dd.MM.yyyy"}),(0,r.jsxs)("div",{style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[(0,r.jsx)("button",{className:Tn,onClick:function(){return c(!1)},children:"Закрыть"}),(0,r.jsx)("button",{className:Tn,style:{background:"#e3eaff",color:"#2563eb"},onClick:k,children:"Очистить"})]})]})})}),{})]})},Gn="CgjxyfEd",Hn="RLut3f27",Wn="slcXbDY8",Xn="zRDTHKjp",Zn="oAFdJnbK",Vn="GUOZxmDe";var Yn=function(e,n,t){if(t||2===arguments.length)for(var r,a=0,i=n.length;a<i;a++)!r&&a in n||(r||(r=Array.prototype.slice.call(n,0,a)),r[a]=n[a]);return e.concat(r||Array.prototype.slice.call(n))},Kn=function(){return Kn=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},Kn.apply(this,arguments)},_n=function(){var e=ie(),n=oe((function(e){return e.event})),t=n.loading,r=n.error,i=oe((function(e){return e.filter})),o=function(e,n){var t=(0,a.useState)(e),r=t[0],i=t[1];return(0,a.useEffect)((function(){var t=setTimeout((function(){i(e)}),n);return function(){clearTimeout(t)}}),[e,n]),r}(i,300),s=function(){var e=oe((function(e){return e.event})).events,n=oe((function(e){return e.search.value})),t=oe((function(e){return e.filter})),r=n.trim().toLowerCase(),a=e.filter((function(e){var n=e.title.toLowerCase(),a=!r||n.startsWith(r)||n.includes(r),i=!t.category||e.category&&e.category.trim().toLowerCase()===t.category.trim().toLowerCase(),o=!0,s=(e.date||"").slice(0,10),c=(t.dateRange.start||"").slice(0,10),l=(t.dateRange.end||"").slice(0,10);c&&l?o=s>=c&&s<=l:c?o=s>=c:l&&(o=s<=l);var u=e.price>=t.priceRange.min&&e.price<=t.priceRange.max;return a&&i&&o&&u}));if(r){for(var i=[],o=[],s=0,c=a;s<c.length;s++){var l=c[s],u=l.title.toLowerCase();u.startsWith(r)?i.push(l):u.includes(r)&&o.push(l)}a=Yn(Yn([],i,!0),o,!0)}return{filteredEvents:a}}().filteredEvents,c=(0,a.useState)(!1),l=c[0],u=c[1],d=oe((function(e){return e.search.value})),f=oe((function(e){return e.city.name}));(0,a.useEffect)((function(){var n=Kn(Kn({},o),{search:d});o.onlyMyCity&&f&&"Город"!==f?n.city=f:delete n.city,e(U(n))}),[e,o,d,f]),(0,a.useEffect)((function(){var e=null;return t?e=setTimeout((function(){return u(!0)}),250):u(!1),function(){e&&clearTimeout(e)}}),[t]);return{loading:l,error:r,filteredEvents:s,handleAddToFavorites:function(e){},handleBuyTicket:function(e){},handleDateSelect:function(n){e(ne(Kn(Kn({},i),{dateRange:{start:n,end:n}})))},handleRangeSelect:function(n,t){e(ne(Kn(Kn({},i),{dateRange:{start:n,end:t}})))}}};const Jn=function(){var e=_n(),n=e.loading,t=e.error,a=e.filteredEvents,i=e.handleAddToFavorites,o=e.handleBuyTicket,s=e.handleDateSelect,c=e.handleRangeSelect;return n?(0,r.jsx)("div",{className:Zn,children:"Загрузка..."}):t?(0,r.jsxs)("div",{className:Vn,children:["Ошибка: ",t]}):(0,r.jsxs)("div",{className:Gn,children:[(0,r.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"1.5rem",marginBottom:"-1.5rem"},children:(0,r.jsx)(zn,{onDateSelect:s,onRangeSelect:c})}),(0,r.jsxs)("div",{className:Hn,children:[(0,r.jsx)("aside",{className:Wn,children:(0,r.jsx)(xn,{})}),(0,r.jsx)("main",{className:Xn,children:(0,r.jsx)(vn,{events:a,onAddToFavorites:i,onBuyTicket:o,loading:n,error:t})})]})]})},Qn="Crw2kdr1",$n="C39kYaHZ",et="nN4bYVhl",nt="KAiSm_v9",tt="KJlTLrGi",rt="_RzXGQFk",at="cZJTIiqp",it="EJOHFjYL",ot="EbW2xjXI",st="EXuRoKnY",ct="uXDX9P80",lt="uHtTRs6c",ut="SeuQM5i6",dt="sudOS0eV",ft="DzmiSDRR",ht="ZW_on0Wd",pt="cnbyq8qV";var vt=function(){return vt=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},vt.apply(this,arguments)},mt=function(e,n,t,r){return new(t||(t=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,s)}c((r=r.apply(e,n||[])).next())}))},yt=function(e,n){var t,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=n.call(e,i)}catch(e){s=[6,e],r=0}finally{t=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};const gt=function(){var e,n=ie(),t=oe((function(e){return e.auth})).user,i=oe((function(e){return e.event})),o=i.events,s=i.loading,c=i.error,l=(0,a.useState)(!1),u=l[0],d=l[1],f=(0,a.useState)({username:(null==t?void 0:t.username)||"",email:(null==t?void 0:t.email)||"",city:(null==t?void 0:t.city)||""}),h=f[0],p=f[1];(0,a.useEffect)((function(){t&&n(M())}),[n,t]);var v=function(e){var n;p(vt(vt({},h),((n={})[e.target.name]=e.target.value,n)))};return t?s?(0,r.jsx)("div",{className:ht,children:"Загрузка..."}):c?(0,r.jsx)("div",{className:pt,children:c}):(0,r.jsx)("div",{className:Qn,children:(0,r.jsxs)("div",{className:$n,children:[(0,r.jsxs)("div",{className:et,children:[(0,r.jsxs)("div",{className:nt,children:[(0,r.jsx)("img",{src:t.avatarUrl?t.avatarUrl.startsWith("/uploads")?"".concat(null===(e="https://ebilet-8f91.onrender.com/api")?void 0:e.replace("/api","")).concat(t.avatarUrl):t.avatarUrl:"/img/default-avatar.svg",alt:"Avatar",className:tt}),(0,r.jsxs)("label",{className:rt,children:["Изменить фото",(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:function(e){return mt(void 0,void 0,void 0,(function(){var t,r;return yt(this,(function(a){switch(a.label){case 0:return(t=null===(r=e.target.files)||void 0===r?void 0:r[0])?[4,n(R(t))]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))},style:{display:"none"}})]})]}),(0,r.jsx)("div",{className:at,children:u?(0,r.jsxs)("form",{className:it,children:[(0,r.jsxs)("div",{className:ot,children:[(0,r.jsx)("label",{children:"Имя пользователя"}),(0,r.jsx)("input",{type:"text",name:"username",value:h.username,onChange:v})]}),(0,r.jsxs)("div",{className:ot,children:[(0,r.jsx)("label",{children:"Email"}),(0,r.jsx)("input",{type:"email",name:"email",value:h.email,onChange:v})]}),(0,r.jsxs)("div",{className:ot,children:[(0,r.jsx)("label",{children:"Город"}),(0,r.jsx)("input",{type:"text",name:"city",value:h.city,onChange:v})]}),(0,r.jsxs)("div",{className:st,children:[(0,r.jsx)("button",{type:"submit",className:lt,children:"Сохранить"}),(0,r.jsx)("button",{type:"button",className:ut,onClick:function(){return d(!1)},children:"Отмена"})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{children:t.username}),(0,r.jsx)("p",{children:t.email}),(0,r.jsx)("p",{children:t.city}),(0,r.jsx)("button",{className:ct,onClick:function(){return d(!0)},children:"Редактировать профиль"})]})})]}),(0,r.jsxs)("div",{className:dt,children:[(0,r.jsx)("h3",{children:"Мои события"}),(0,r.jsx)("div",{className:ft,children:o.map((function(e){return(0,r.jsx)(fn,{event:e,onAddToFavorites:function(){},onBuyTicket:function(){}},e.id)}))})]})]})}):(0,r.jsx)("div",{className:pt,children:"Пожалуйста, войдите в систему"})},xt="_ifCH7uh";const jt=function(){return(0,r.jsxs)("div",{className:xt,children:[(0,r.jsx)("h1",{children:"Мои события"}),(0,r.jsx)("p",{children:"Здесь будут отображаться все купленные билеты пользователя на события."})]})},bt="oNLuKqJw",wt="QPT3LbSV";const Nt=function(){return(0,r.jsx)(c.Kq,{store:ae,children:(0,r.jsx)(o.Kd,{basename:"/ebilet",children:(0,r.jsxs)("div",{className:bt,children:[(0,r.jsx)(Je,{}),(0,r.jsx)("main",{className:wt,children:(0,r.jsxs)(s.BV,{children:[(0,r.jsx)(s.qh,{path:"/",element:(0,r.jsx)(Jn,{})}),(0,r.jsx)(s.qh,{path:"/profile",element:(0,r.jsx)(gt,{})}),(0,r.jsx)(s.qh,{path:"/my-tickets",element:(0,r.jsx)(jt,{})})]})})]})})})};i.createRoot(document.getElementById("root")).render((0,r.jsx)(a.StrictMode,{children:(0,r.jsx)(Nt,{})}))}},e=>{e.O(0,[720],(()=>{return n=273,e(e.s=n);var n}));e.O()}]);
//# sourceMappingURL=main.a7084af0.js.map