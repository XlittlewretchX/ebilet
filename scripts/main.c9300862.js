"use strict";(self.webpackChunkebilet_client=self.webpackChunkebilet_client||[]).push([[792],{45:(e,n,t)=>{var r=t(848),a=t(540),i=t(338),s=t(976),o=t(767),c=t(468),l=t(816),u=t(83),d=function(e,n,t,r){return new(t||(t=Promise))((function(a,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function o(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(s,o)}c((r=r.apply(e,n||[])).next())}))},f=function(e,n){var t,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=o(0),s.throw=o(1),s.return=o(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(c){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=n.call(e,i)}catch(e){o=[6,e],r=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},h=u.A.create({baseURL:"https://ebilet-8f91.onrender.com/api",headers:{"Content-Type":"application/json"}});h.interceptors.request.use((function(e){var n=localStorage.getItem("token");return n&&(e.headers.Authorization="Bearer ".concat(n)),e}));var p,v=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(n){switch(n.label){case 0:return[4,h.post("/auth/register",e)];case 1:return[2,n.sent().data]}}))}))},m=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(n){switch(n.label){case 0:return[4,h.post("/auth/login",e)];case 1:return[2,n.sent().data]}}))}))},y=function(e){return d(void 0,void 0,void 0,(function(){var n;return f(this,(function(t){switch(t.label){case 0:return(n=new FormData).append("avatar",e),[4,h.post("/auth/avatar",n,{headers:{"Content-Type":"multipart/form-data"}})];case 1:return[2,t.sent().data]}}))}))},j=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(n){switch(n.label){case 0:return[4,h.patch("/auth/city",{city:e})];case 1:return[2,n.sent().data]}}))}))},x=function(){return d(void 0,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,h.get("/events")];case 1:return[2,e.sent().data]}}))}))},b=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(n){switch(n.label){case 0:return[4,h.get("/events/".concat(e))];case 1:return[2,n.sent().data]}}))}))},g=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(n){switch(n.label){case 0:return[4,h.post("/events",e,{headers:{"Content-Type":"multipart/form-data"}})];case 1:return[2,n.sent().data]}}))}))},w=function(){return d(void 0,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,h.get("/events/user/events")];case 1:return[2,e.sent().data]}}))}))},N=function(e,n,t,r){return new(t||(t=Promise))((function(a,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function o(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(s,o)}c((r=r.apply(e,n||[])).next())}))},k=function(e,n){var t,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=o(0),s.throw=o(1),s.return=o(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(c){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=n.call(e,i)}catch(e){o=[6,e],r=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},C={user:null,token:localStorage.getItem("token"),isAuthenticated:!1,loading:!1,error:null},S=(0,l.zD)("auth/register",(function(e,n){return N(void 0,[e,n],void 0,(function(e,n){var t,r,a,i=n.rejectWithValue;return k(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,v(e)];case 1:return t=n.sent(),localStorage.setItem("token",t.token),[2,t];case 2:return r=n.sent(),(a=r).response&&a.response.data&&a.response.data.message?[2,i(a.response.data.message)]:[2,i("Ошибка при регистрации")];case 3:return[2]}}))}))})),P=(0,l.zD)("auth/login",(function(e,n){return N(void 0,[e,n],void 0,(function(e,n){var t,r,a,i=n.rejectWithValue;return k(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,m(e)];case 1:return t=n.sent(),localStorage.setItem("token",t.token),[2,t];case 2:return r=n.sent(),(a=r).response&&a.response.data&&a.response.data.message?[2,i(a.response.data.message)]:[2,i("Ошибка при входе")];case 3:return[2]}}))}))})),O=(0,l.zD)("auth/uploadAvatar",(function(e){return N(void 0,void 0,void 0,(function(){return k(this,(function(n){switch(n.label){case 0:return[4,y(e)];case 1:return[2,n.sent()]}}))}))})),E=(0,l.zD)("auth/updateCity",(function(e,n){return N(void 0,[e,n],void 0,(function(e,n){var t=n.rejectWithValue;return k(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,j(e)];case 1:return[2,n.sent().city];case 2:return n.sent(),[2,t("Ошибка при обновлении города")];case 3:return[2]}}))}))})),I=(0,l.Z0)({name:"auth",initialState:C,reducers:{logout:function(e){e.user=null,e.token=null,e.isAuthenticated=!1,localStorage.removeItem("token")},clearError:function(e){e.error=null}},extraReducers:function(e){e.addCase(S.pending,(function(e){e.loading=!0,e.error=null})).addCase(S.fulfilled,(function(e,n){e.loading=!1,e.isAuthenticated=!0,e.user=n.payload.user,e.token=n.payload.token})).addCase(S.rejected,(function(e,n){e.loading=!1,e.error=n.payload||n.error.message||"Ошибка при регистрации"})).addCase(P.pending,(function(e){e.loading=!0,e.error=null})).addCase(P.fulfilled,(function(e,n){e.loading=!1,e.isAuthenticated=!0,e.user=n.payload.user,e.token=n.payload.token})).addCase(P.rejected,(function(e,n){e.loading=!1,e.error=n.payload||n.error.message||"Ошибка при входе"})).addCase(O.fulfilled,(function(e,n){e.user&&(e.user.avatarUrl=n.payload.avatarUrl)})).addCase(E.fulfilled,(function(e,n){e.user&&(e.user.city=n.payload)}))}}),R=(p=I.actions).logout;p.clearError;const A=I.reducer;var T=function(e,n,t,r){return new(t||(t=Promise))((function(a,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function o(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(s,o)}c((r=r.apply(e,n||[])).next())}))},F=function(e,n){var t,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=o(0),s.throw=o(1),s.return=o(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(c){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=n.call(e,i)}catch(e){o=[6,e],r=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},D=(0,l.zD)("event/fetchEvents",(function(){return T(void 0,void 0,void 0,(function(){return F(this,(function(e){switch(e.label){case 0:return[4,x()];case 1:return[2,e.sent()]}}))}))})),U=((0,l.zD)("event/fetchEventById",(function(e){return T(void 0,void 0,void 0,(function(){return F(this,(function(n){switch(n.label){case 0:return[4,b(e)];case 1:return[2,n.sent()]}}))}))})),(0,l.zD)("event/createEvent",(function(e){return T(void 0,void 0,void 0,(function(){return F(this,(function(n){switch(n.label){case 0:return[4,g(e)];case 1:return[2,n.sent()]}}))}))}))),B=(0,l.zD)("event/fetchUserEvents",(function(){return T(void 0,void 0,void 0,(function(){return F(this,(function(e){switch(e.label){case 0:return[4,w()];case 1:return[2,e.sent()]}}))}))})),z=(0,l.Z0)({name:"event",initialState:{events:[],loading:!1,error:null},reducers:{clearError:function(e){e.error=null}},extraReducers:function(e){e.addCase(D.pending,(function(e){e.loading=!0,e.error=null})).addCase(D.fulfilled,(function(e,n){e.loading=!1,e.events=n.payload})).addCase(D.rejected,(function(e,n){e.loading=!1,e.error=n.error.message||"Ошибка при загрузке событий"})).addCase(U.pending,(function(e){e.loading=!0,e.error=null})).addCase(U.fulfilled,(function(e,n){e.loading=!1,e.events.unshift(n.payload)})).addCase(U.rejected,(function(e,n){e.loading=!1,e.error=n.error.message||"Ошибка при создании события"})).addCase(B.pending,(function(e){e.loading=!0,e.error=null})).addCase(B.fulfilled,(function(e,n){e.loading=!1,e.events=n.payload})).addCase(B.rejected,(function(e,n){e.loading=!1,e.error=n.error.message||"Ошибка при загрузке событий пользователя"}))}});z.actions.clearError;const V=z.reducer;var _,G=function(e,n,t,r){return new(t||(t=Promise))((function(a,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function o(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(s,o)}c((r=r.apply(e,n||[])).next())}))},M=function(e,n){var t,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=o(0),s.throw=o(1),s.return=o(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(c){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=n.call(e,i)}catch(e){o=[6,e],r=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},Y=(0,l.zD)("city/fetchByIP",(function(e,n){return G(void 0,[e,n],void 0,(function(e,n){var t,r,a,i,s,o,c,l,u,d,f,h,p,v,m,y,j=n.rejectWithValue;return M(this,(function(e){switch(e.label){case 0:return e.trys.push([0,6,,7]),(t="MISSING_ENV_VAR".REACT_APP_IPGEO_API_KEY)?(r="https://api.ipgeolocation.io/ipgeo?apiKey=".concat(t),[4,fetch(r)]):[2,j("API key is not defined")];case 1:return(a=e.sent()).ok?[4,a.json()]:[2,j("Ошибка API: ".concat(a.status))];case 2:return i=e.sent(),s=i.city,o=i.latitude,c=i.longitude,o&&c?(l="https://nominatim.openstreetmap.org/reverse?lat=".concat(o,"&lon=").concat(c,"&format=json&accept-language=ru"),[4,fetch(l,{headers:{"User-Agent":"ebilet-app/1.0 (your@email.com)"}})]):[2,s||"Город"];case 3:return(u=e.sent()).ok?[4,u.json()]:[3,5];case 4:if(d=e.sent(),f=(null===(p=d.address)||void 0===p?void 0:p.city)||(null===(v=d.address)||void 0===v?void 0:v.town)||(null===(m=d.address)||void 0===m?void 0:m.village)||(null===(y=d.address)||void 0===y?void 0:y.state))return[2,f];e.label=5;case 5:return[2,s||"Город"];case 6:return h=e.sent(),[2,j(h.message)];case 7:return[2]}}))}))})),q=(0,l.Z0)({name:"city",initialState:{name:"Город",showPicker:!1},reducers:{openPicker:function(e){e.showPicker=!0},closePicker:function(e){e.showPicker=!1},setCity:function(e,n){e.name=n.payload,e.showPicker=!1}},extraReducers:function(e){e.addCase(Y.fulfilled,(function(e,n){var t=n.payload;e.name=t,e.showPicker=!1})).addCase(Y.rejected,(function(e){e.showPicker=!0}))}}),L=((_=q.actions).openPicker,_.closePicker,_.setCity);const X=q.reducer;var K=(0,l.U1)({reducer:{auth:A,event:V,city:X}}),Z=function(){return(0,c.wA)()},H=c.d4;const J="bpPJIY6U",W="bjtsBS8k",Q="EDhKdpc7",$="yyzd7YrG",ee="Kjv9kV1L",ne="IAgmSXvg",te="uZZ_BM0m";var re=function(){return re=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},re.apply(this,arguments)},ae=function(e,n,t,r){return new(t||(t=Promise))((function(a,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function o(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(s,o)}c((r=r.apply(e,n||[])).next())}))},ie=function(e,n){var t,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=o(0),s.throw=o(1),s.return=o(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(c){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=n.call(e,i)}catch(e){o=[6,e],r=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},se=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)n.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(t[r[a]]=e[r[a]])}return t};const oe=function(e){var n=e.isOpen,t=e.onClose,i=Z(),s=H((function(e){return e.auth})),o=s.loading,c=s.error,l=s.isAuthenticated,u=H((function(e){return e.city.name})),d=(0,a.useState)(!0),f=d[0],h=d[1],p=(0,a.useState)({username:"",email:"",password:"",confirmPassword:""}),v=p[0],m=p[1],y=(0,a.useState)(""),j=y[0],x=y[1],b=function(e){var n;m(re(re({},v),((n={})[e.target.name]=e.target.value,n)))};return(0,a.useEffect)((function(){n&&l&&f&&t()}),[l,n,f,t]),(0,a.useEffect)((function(){n&&(m({username:"",email:"",password:"",confirmPassword:""}),x(""))}),[n,f]),n?(0,r.jsx)("div",{className:J,onClick:t,children:(0,r.jsxs)("div",{className:W,onClick:function(e){return e.stopPropagation()},children:[(0,r.jsx)("button",{className:Q,onClick:t,children:"×"}),(0,r.jsx)("h2",{children:f?"Вход":"Регистрация"}),(0,r.jsxs)("form",{onSubmit:function(e){return ae(void 0,void 0,void 0,(function(){var n,r,a;return ie(this,(function(s){switch(s.label){case 0:return e.preventDefault(),f||v.password===v.confirmPassword?f?(v.email,v.confirmPassword,n=se(v,["email","confirmPassword"]),[4,i(P(n))]):[3,2]:(alert("Пароли не совпадают"),[2]);case 1:return s.sent(),[3,4];case 2:return v.confirmPassword,r=se(v,["confirmPassword"]),[4,i(S(re(re({},r),{city:u})))];case 3:a=s.sent(),S.fulfilled.match(a)&&(x("Вы успешно зарегистрировались!"),setTimeout((function(){x(""),t()}),1500)),s.label=4;case 4:return[2]}}))}))},children:[(0,r.jsx)("div",{className:$,children:(0,r.jsx)("input",{type:"text",name:"username",placeholder:"Имя пользователя",value:v.username,onChange:b,required:!0})}),!f&&(0,r.jsx)("div",{className:$,children:(0,r.jsx)("input",{type:"email",name:"email",placeholder:"Email",value:v.email,onChange:b,required:!0})}),(0,r.jsx)("div",{className:$,children:(0,r.jsx)("input",{type:"password",name:"password",placeholder:"Пароль",value:v.password,onChange:b,required:!0})}),!f&&(0,r.jsx)("div",{className:$,children:(0,r.jsx)("input",{type:"password",name:"confirmPassword",placeholder:"Подтвердите пароль",value:v.confirmPassword,onChange:b,required:!0})}),(0,r.jsx)("button",{type:"submit",disabled:o,children:o?"Загрузка...":f?"Войти":"Зарегистрироваться"}),c&&(0,r.jsx)("p",{className:ee,children:c}),j&&(0,r.jsx)("p",{className:ne,children:j})]}),(0,r.jsxs)("p",{className:te,children:[f?"Нет аккаунта?":"Уже есть аккаунт?"," ",(0,r.jsx)("button",{onClick:function(){return h(!f)},children:f?"Зарегистрироваться":"Войти"})]})]})}):null},ce="k5rxhHqu",le="mTFHSVjn",ue="AQj0qjGu",de="NLW9Mru1",fe="JUFDT6sE",he="IecoVAa_",pe="ohMFSmtb",ve="ZykafPsT",me="AMkCxMZ5",ye="eSE1oGM8",je="OQXaY7qu",xe="YpBllFSl",be="zVBLGTS5",ge="BMrkEVHo",we="JtP_ltPL",Ne="rtCQt7XI",ke="kwHSCM5d",Ce="lAVIIIFv",Se="XapMHCuM",Pe="FV9PH3Y9",Oe="YRk2MqKD",Ee="FuZjbqe_",Ie="fA1OvUlR",Re="wwQn_1wS",Ae="jXt8BEh2",Te="X4PUdjG7";var Fe=function(){return(0,r.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{marginRight:6},children:(0,r.jsx)("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z",fill:"#007bff"})})};const De=function(){var e=Z(),n=H((function(e){return e.city})).name,t=H((function(e){return e.auth})),i=t.isAuthenticated,s=t.user,o=(0,a.useState)(!1),c=o[0],l=o[1],u=(0,a.useState)(""),d=u[0],f=u[1],h=i?(null==s?void 0:s.city)||"Город":n;return a.useEffect((function(){f(h)}),[h]),(0,r.jsxs)("div",{className:Pe,children:[(0,r.jsxs)("button",{className:Oe,onClick:function(){return l(!0)},"aria-label":"Выбрать город",children:[(0,r.jsx)(Fe,{}),(0,r.jsx)("span",{className:Ee,children:h})]}),c&&(0,r.jsx)("div",{className:Ie,onClick:function(){return l(!1)},children:(0,r.jsxs)("div",{className:Re,onClick:function(e){return e.stopPropagation()},children:[(0,r.jsx)("input",{className:Ae,value:d,onChange:function(e){return f(e.target.value)},placeholder:"Введите город",autoFocus:!0}),(0,r.jsxs)("div",{className:Te,children:[(0,r.jsx)("button",{className:Ce,onClick:function(){d.trim()&&(i?(e(E(d.trim())),e(L(d.trim()))):e(L(d.trim())),l(!1))},children:"Сохранить"}),(0,r.jsx)("button",{className:Se,onClick:function(){return l(!1)},children:"Отмена"})]})]})})]})};const Ue=function(){var e,n=Z(),t=H((function(e){return e.auth})),i=t.user,o=t.isAuthenticated,c=(0,a.useState)(!1),l=c[0],u=c[1],d=(0,a.useState)(!1),f=d[0],h=d[1],p=(0,a.useState)(!1),v=p[0],m=p[1],y=(0,a.useState)(""),j=y[0],x=y[1];(0,a.useEffect)((function(){o?(null==i?void 0:i.city)&&"Город"!==i.city?n(L(i.city)):n(Y()).then((function(e){Y.fulfilled.match(e)&&(n(E(e.payload)),n(L(e.payload)))})):n(Y()).then((function(e){Y.fulfilled.match(e)&&n(L(e.payload))}))}),[o]);return(0,a.useEffect)((function(){if(f){var e=function(e){var n=document.getElementById("user-menu-dropdown");n&&!n.contains(e.target)&&(h(!1),m(!1))};return document.addEventListener("mousedown",e),function(){return document.removeEventListener("mousedown",e)}}}),[f]),(0,r.jsxs)("header",{className:ce,children:[(0,r.jsxs)("div",{className:le,children:[(0,r.jsx)(s.N_,{to:"/",className:ue,children:"EBilet"}),(0,r.jsx)("div",{className:pe,children:(0,r.jsx)("input",{type:"text",placeholder:"Поиск мероприятий...",value:j,onChange:function(e){return x(e.target.value)}})}),(0,r.jsxs)("nav",{className:de,children:[(0,r.jsx)(De,{}),o?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.N_,{to:"/my-tickets",className:fe,children:"Мои события"}),(0,r.jsxs)("div",{className:ve,children:[(0,r.jsxs)("button",{className:me+(f?" "+ye:""),onClick:function(){h((function(e){return!e})),m(!1)},"aria-haspopup":"true","aria-expanded":f,children:[(0,r.jsx)("img",{src:(null==i?void 0:i.avatarUrl)?i.avatarUrl.startsWith("/uploads")?"".concat(null===(e="https://ebilet-8f91.onrender.com/api")?void 0:e.replace("/api","")).concat(i.avatarUrl):i.avatarUrl:"/img/default-avatar.svg",alt:"avatar",className:je}),(0,r.jsx)("span",{className:xe,children:null==i?void 0:i.username})]}),f&&(0,r.jsxs)("div",{className:be,id:"user-menu-dropdown",children:[(0,r.jsx)(s.N_,{className:ge,to:"/profile",onClick:function(){return h(!1)},children:"Мой профиль"}),(0,r.jsx)("div",{className:we}),v?(0,r.jsxs)("div",{className:Ne,children:["Выйти из аккаунта?",(0,r.jsxs)("div",{className:ke,children:[(0,r.jsx)("button",{className:Ce,onClick:function(){n(R()),m(!1),h(!1)},children:"Да"}),(0,r.jsx)("button",{className:Se,onClick:function(){return m(!1)},children:"Нет"})]})]}):(0,r.jsx)("button",{className:ge,onClick:function(){return m(!0)},children:"Выйти"})]})]})]}):(0,r.jsx)("button",{onClick:function(){return u(!0)},className:he,children:"Войти"})]})]}),(0,r.jsx)(oe,{isOpen:l,onClose:function(){return u(!1)}})]})},Be="YvM5FLFP",ze="dXj11BDJ",Ve="FpY8onfk",_e="CRizw7lr",Ge="QgcL77oZ",Me="RRM3pxoO",Ye="zu3mJbnV",qe="JYaCMsI8",Le="TTVw5vFO",Xe="mXBkGq1O",Ke="AOIpO0MI",Ze="cPHSjKlo",He="C4vpFgDJ";const Je=function(e){var n,t=e.event,a=e.onAddToFavorites,i=e.onBuyTicket;return(0,r.jsxs)("div",{className:Be,children:[t.imageUrl&&(0,r.jsx)("div",{className:ze,children:(0,r.jsx)("img",{src:t.imageUrl,alt:t.title,className:Ve})}),(0,r.jsxs)("div",{className:_e,children:[(0,r.jsx)("h3",{className:Ge,children:t.title}),(0,r.jsx)("p",{className:Me,children:t.description}),(0,r.jsxs)("div",{className:Ye,children:[(0,r.jsx)("span",{className:qe,children:(n=t.date,new Date(n).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"}))}),(0,r.jsx)("span",{className:Le,children:t.location}),(0,r.jsxs)("span",{className:Xe,children:[t.price," ₽"]})]}),(0,r.jsxs)("div",{className:Ke,children:[(0,r.jsx)("button",{className:Ze,onClick:function(){return a(t.id)},children:"В избранное"}),(0,r.jsx)("button",{className:He,onClick:function(){return i(t.id)},children:"Купить билет"})]})]})]})},We="PjgZ7vFV",Qe="jaY9VeYu",$e="BaGs2vBz",en="YvBg03zK",nn="Tlk30F4G",tn="J481YSQ9",rn="e9XMvyD5",an="b9FCLRCd";var sn=function(){return sn=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},sn.apply(this,arguments)};const on=function(e){var n=e.onFilterChange,t=(0,a.useState)({category:"",dateRange:{start:"",end:""},priceRange:{min:0,max:1e4}}),i=t[0],s=t[1],o=function(e,t){var r,a=sn(sn({},i),((r={})[e]=t,r));s(a),null==n||n(a)};return(0,r.jsxs)("div",{className:We,children:[(0,r.jsx)("h3",{className:Qe,children:"Фильтры"}),(0,r.jsxs)("div",{className:$e,children:[(0,r.jsx)("label",{className:en,children:"Категория"}),(0,r.jsxs)("select",{className:nn,value:i.category,onChange:function(e){return o("category",e.target.value)},children:[(0,r.jsx)("option",{value:"",children:"Все категории"}),(0,r.jsx)("option",{value:"concert",children:"Концерты"}),(0,r.jsx)("option",{value:"theater",children:"Театр"}),(0,r.jsx)("option",{value:"exhibition",children:"Выставки"}),(0,r.jsx)("option",{value:"sport",children:"Спорт"})]})]}),(0,r.jsxs)("div",{className:$e,children:[(0,r.jsx)("label",{className:en,children:"Дата"}),(0,r.jsx)("div",{className:rn,children:(0,r.jsx)("input",{type:"date",className:tn,value:i.dateRange.start,onChange:function(e){return o("dateRange",sn(sn({},i.dateRange),{start:e.target.value}))}})})]}),(0,r.jsxs)("div",{className:$e,children:[(0,r.jsx)("label",{className:en,children:"Цена"}),(0,r.jsxs)("div",{className:an,children:[(0,r.jsx)("input",{type:"number",className:tn,placeholder:"От",value:i.priceRange.min,onChange:function(e){return o("priceRange",sn(sn({},i.priceRange),{min:Number(e.target.value)}))}}),(0,r.jsx)("input",{type:"number",className:tn,placeholder:"До",value:i.priceRange.max,onChange:function(e){return o("priceRange",sn(sn({},i.priceRange),{max:Number(e.target.value)}))}})]})]})]})},cn="CgjxyfEd",ln="RLut3f27",un="slcXbDY8",dn="zRDTHKjp",fn="UD6lwGa_",hn="oAFdJnbK",pn="GUOZxmDe";const vn=function(){var e=Z(),n=H((function(e){return e.event})),t=n.events,i=n.loading,s=n.error;(0,a.useEffect)((function(){e(D())}),[e]);var o=function(e){console.log("Добавлено в избранное: ".concat(e))},c=function(e){console.log("Куплен билет: ".concat(e))};return i?(0,r.jsx)("div",{className:hn,children:"Загрузка..."}):s?(0,r.jsxs)("div",{className:pn,children:["Ошибка: ",s]}):(0,r.jsx)("div",{className:cn,children:(0,r.jsxs)("div",{className:ln,children:[(0,r.jsx)("aside",{className:un,children:(0,r.jsx)(on,{onFilterChange:function(e){console.log("Фильтры:",e)}})}),(0,r.jsx)("main",{className:dn,children:(0,r.jsx)("div",{className:fn,children:t.map((function(e){return(0,r.jsx)(Je,{event:e,onAddToFavorites:o,onBuyTicket:c},e.id)}))})})]})})},mn="Crw2kdr1",yn="C39kYaHZ",jn="nN4bYVhl",xn="KAiSm_v9",bn="KJlTLrGi",gn="_RzXGQFk",wn="cZJTIiqp",Nn="EJOHFjYL",kn="EbW2xjXI",Cn="EXuRoKnY",Sn="uXDX9P80",Pn="uHtTRs6c",On="SeuQM5i6",En="sudOS0eV",In="DzmiSDRR",Rn="ZW_on0Wd",An="cnbyq8qV";var Tn=function(){return Tn=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},Tn.apply(this,arguments)},Fn=function(e,n,t,r){return new(t||(t=Promise))((function(a,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function o(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(s,o)}c((r=r.apply(e,n||[])).next())}))},Dn=function(e,n){var t,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=o(0),s.throw=o(1),s.return=o(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(c){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=n.call(e,i)}catch(e){o=[6,e],r=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}};const Un=function(){var e,n=Z(),t=H((function(e){return e.auth})).user,i=H((function(e){return e.event})),s=i.events,o=i.loading,c=i.error,l=(0,a.useState)(!1),u=l[0],d=l[1],f=(0,a.useState)({username:(null==t?void 0:t.username)||"",email:(null==t?void 0:t.email)||"",city:(null==t?void 0:t.city)||""}),h=f[0],p=f[1];(0,a.useEffect)((function(){t&&n(B())}),[n,t]);var v=function(e){var n;p(Tn(Tn({},h),((n={})[e.target.name]=e.target.value,n)))};return t?o?(0,r.jsx)("div",{className:Rn,children:"Загрузка..."}):c?(0,r.jsx)("div",{className:An,children:c}):(0,r.jsx)("div",{className:mn,children:(0,r.jsxs)("div",{className:yn,children:[(0,r.jsxs)("div",{className:jn,children:[(0,r.jsxs)("div",{className:xn,children:[(0,r.jsx)("img",{src:t.avatarUrl?t.avatarUrl.startsWith("/uploads")?"".concat(null===(e="https://ebilet-8f91.onrender.com/api")?void 0:e.replace("/api","")).concat(t.avatarUrl):t.avatarUrl:"/img/default-avatar.svg",alt:"Avatar",className:bn}),(0,r.jsxs)("label",{className:gn,children:["Изменить фото",(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:function(e){return Fn(void 0,void 0,void 0,(function(){var t,r;return Dn(this,(function(a){switch(a.label){case 0:return(t=null===(r=e.target.files)||void 0===r?void 0:r[0])?[4,n(O(t))]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))},style:{display:"none"}})]})]}),(0,r.jsx)("div",{className:wn,children:u?(0,r.jsxs)("form",{className:Nn,children:[(0,r.jsxs)("div",{className:kn,children:[(0,r.jsx)("label",{children:"Имя пользователя"}),(0,r.jsx)("input",{type:"text",name:"username",value:h.username,onChange:v})]}),(0,r.jsxs)("div",{className:kn,children:[(0,r.jsx)("label",{children:"Email"}),(0,r.jsx)("input",{type:"email",name:"email",value:h.email,onChange:v})]}),(0,r.jsxs)("div",{className:kn,children:[(0,r.jsx)("label",{children:"Город"}),(0,r.jsx)("input",{type:"text",name:"city",value:h.city,onChange:v})]}),(0,r.jsxs)("div",{className:Cn,children:[(0,r.jsx)("button",{type:"submit",className:Pn,children:"Сохранить"}),(0,r.jsx)("button",{type:"button",className:On,onClick:function(){return d(!1)},children:"Отмена"})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{children:t.username}),(0,r.jsx)("p",{children:t.email}),(0,r.jsx)("p",{children:t.city}),(0,r.jsx)("button",{className:Sn,onClick:function(){return d(!0)},children:"Редактировать профиль"})]})})]}),(0,r.jsxs)("div",{className:En,children:[(0,r.jsx)("h3",{children:"Мои события"}),(0,r.jsx)("div",{className:In,children:s.map((function(e){return(0,r.jsx)(Je,{event:e,onAddToFavorites:function(){},onBuyTicket:function(){}},e.id)}))})]})]})}):(0,r.jsx)("div",{className:An,children:"Пожалуйста, войдите в систему"})},Bn="_ifCH7uh";const zn=function(){return(0,r.jsxs)("div",{className:Bn,children:[(0,r.jsx)("h1",{children:"Мои события"}),(0,r.jsx)("p",{children:"Здесь будут отображаться все купленные билеты пользователя на события."})]})},Vn="d6WLOcTu",_n="CjyF501h";const Gn=function(){return(0,r.jsx)(c.Kq,{store:K,children:(0,r.jsx)(s.Kd,{basename:"/ebilet",children:(0,r.jsxs)("div",{className:Vn,children:[(0,r.jsx)(Ue,{}),(0,r.jsx)("main",{className:_n,children:(0,r.jsxs)(o.BV,{children:[(0,r.jsx)(o.qh,{path:"/",element:(0,r.jsx)(vn,{})}),(0,r.jsx)(o.qh,{path:"/profile",element:(0,r.jsx)(Un,{})}),(0,r.jsx)(o.qh,{path:"/my-tickets",element:(0,r.jsx)(zn,{})})]})})]})})})};i.createRoot(document.getElementById("root")).render((0,r.jsx)(a.StrictMode,{children:(0,r.jsx)(Gn,{})}))}},e=>{e.O(0,[460],(()=>{return n=45,e(e.s=n);var n}));e.O()}]);
//# sourceMappingURL=main.c9300862.js.map