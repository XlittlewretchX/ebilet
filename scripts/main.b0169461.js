"use strict";(self.webpackChunkebilet_client=self.webpackChunkebilet_client||[]).push([[792],{688:(e,n,t)=>{var r=t(848),a=t(540),i=t(338),o=t(976),s=t(767),c=t(468),l=t(816),u=t(83),d=function(e,n,t,r){return new(t||(t=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,s)}c((r=r.apply(e,n||[])).next())}))},f=function(e,n){var t,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=n.call(e,i)}catch(e){s=[6,e],r=0}finally{t=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},h=u.A.create({baseURL:"https://ebilet-8f91.onrender.com/api",headers:{"Content-Type":"application/json"}});h.interceptors.request.use((function(e){var n=localStorage.getItem("token");return n&&(e.headers.Authorization="Bearer ".concat(n)),e}));var p,v=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(n){switch(n.label){case 0:return[4,h.post("/auth/register",e)];case 1:return[2,n.sent().data]}}))}))},m=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(n){switch(n.label){case 0:return[4,h.post("/auth/login",e)];case 1:return[2,n.sent().data]}}))}))},y=function(e){return d(void 0,void 0,void 0,(function(){var n;return f(this,(function(t){switch(t.label){case 0:return(n=new FormData).append("avatar",e),[4,h.post("/auth/avatar",n,{headers:{"Content-Type":"multipart/form-data"}})];case 1:return[2,t.sent().data]}}))}))},x=function(){return d(void 0,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,h.get("/events")];case 1:return[2,e.sent().data]}}))}))},j=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(n){switch(n.label){case 0:return[4,h.get("/events/".concat(e))];case 1:return[2,n.sent().data]}}))}))},b=function(e){return d(void 0,void 0,void 0,(function(){return f(this,(function(n){switch(n.label){case 0:return[4,h.post("/events",e,{headers:{"Content-Type":"multipart/form-data"}})];case 1:return[2,n.sent().data]}}))}))},g=function(){return d(void 0,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,h.get("/events/user/events")];case 1:return[2,e.sent().data]}}))}))},w=function(e,n,t,r){return new(t||(t=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,s)}c((r=r.apply(e,n||[])).next())}))},N=function(e,n){var t,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=n.call(e,i)}catch(e){s=[6,e],r=0}finally{t=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},k={user:null,token:localStorage.getItem("token"),isAuthenticated:!1,loading:!1,error:null},C=(0,l.zD)("auth/register",(function(e,n){return w(void 0,[e,n],void 0,(function(e,n){var t,r,a,i=n.rejectWithValue;return N(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,v(e)];case 1:return t=n.sent(),localStorage.setItem("token",t.token),[2,t];case 2:return r=n.sent(),(a=r).response&&a.response.data&&a.response.data.message?[2,i(a.response.data.message)]:[2,i("Ошибка при регистрации")];case 3:return[2]}}))}))})),S=(0,l.zD)("auth/login",(function(e,n){return w(void 0,[e,n],void 0,(function(e,n){var t,r,a,i=n.rejectWithValue;return N(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,m(e)];case 1:return t=n.sent(),localStorage.setItem("token",t.token),[2,t];case 2:return r=n.sent(),(a=r).response&&a.response.data&&a.response.data.message?[2,i(a.response.data.message)]:[2,i("Ошибка при входе")];case 3:return[2]}}))}))})),O=(0,l.zD)("auth/uploadAvatar",(function(e){return w(void 0,void 0,void 0,(function(){return N(this,(function(n){switch(n.label){case 0:return[4,y(e)];case 1:return[2,n.sent()]}}))}))})),P=(0,l.Z0)({name:"auth",initialState:k,reducers:{logout:function(e){e.user=null,e.token=null,e.isAuthenticated=!1,localStorage.removeItem("token")},clearError:function(e){e.error=null}},extraReducers:function(e){e.addCase(C.pending,(function(e){e.loading=!0,e.error=null})).addCase(C.fulfilled,(function(e,n){e.loading=!1,e.isAuthenticated=!0,e.user=n.payload.user,e.token=n.payload.token})).addCase(C.rejected,(function(e,n){e.loading=!1,e.error=n.payload||n.error.message||"Ошибка при регистрации"})).addCase(S.pending,(function(e){e.loading=!0,e.error=null})).addCase(S.fulfilled,(function(e,n){e.loading=!1,e.isAuthenticated=!0,e.user=n.payload.user,e.token=n.payload.token})).addCase(S.rejected,(function(e,n){e.loading=!1,e.error=n.payload||n.error.message||"Ошибка при входе"})).addCase(O.fulfilled,(function(e,n){e.user&&(e.user.avatarUrl=n.payload.avatarUrl)}))}}),I=(p=P.actions).logout;p.clearError;const E=P.reducer;var R=function(e,n,t,r){return new(t||(t=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,s)}c((r=r.apply(e,n||[])).next())}))},A=function(e,n){var t,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=n.call(e,i)}catch(e){s=[6,e],r=0}finally{t=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},T=(0,l.zD)("event/fetchEvents",(function(){return R(void 0,void 0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,x()];case 1:return[2,e.sent()]}}))}))})),D=((0,l.zD)("event/fetchEventById",(function(e){return R(void 0,void 0,void 0,(function(){return A(this,(function(n){switch(n.label){case 0:return[4,j(e)];case 1:return[2,n.sent()]}}))}))})),(0,l.zD)("event/createEvent",(function(e){return R(void 0,void 0,void 0,(function(){return A(this,(function(n){switch(n.label){case 0:return[4,b(e)];case 1:return[2,n.sent()]}}))}))}))),F=(0,l.zD)("event/fetchUserEvents",(function(){return R(void 0,void 0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,g()];case 1:return[2,e.sent()]}}))}))})),_=(0,l.Z0)({name:"event",initialState:{events:[],loading:!1,error:null},reducers:{clearError:function(e){e.error=null}},extraReducers:function(e){e.addCase(T.pending,(function(e){e.loading=!0,e.error=null})).addCase(T.fulfilled,(function(e,n){e.loading=!1,e.events=n.payload})).addCase(T.rejected,(function(e,n){e.loading=!1,e.error=n.error.message||"Ошибка при загрузке событий"})).addCase(D.pending,(function(e){e.loading=!0,e.error=null})).addCase(D.fulfilled,(function(e,n){e.loading=!1,e.events.unshift(n.payload)})).addCase(D.rejected,(function(e,n){e.loading=!1,e.error=n.error.message||"Ошибка при создании события"})).addCase(F.pending,(function(e){e.loading=!0,e.error=null})).addCase(F.fulfilled,(function(e,n){e.loading=!1,e.events=n.payload})).addCase(F.rejected,(function(e,n){e.loading=!1,e.error=n.error.message||"Ошибка при загрузке событий пользователя"}))}});_.actions.clearError;const z=_.reducer;var G,B=function(e,n,t,r){return new(t||(t=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,s)}c((r=r.apply(e,n||[])).next())}))},V=function(e,n){var t,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=n.call(e,i)}catch(e){s=[6,e],r=0}finally{t=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},q=(0,l.zD)("city/fetchByIP",(function(e,n){return B(void 0,[e,n],void 0,(function(e,n){var t,r,a,i,o=n.rejectWithValue;return V(this,(function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),(t="MISSING_ENV_VAR".REACT_APP_IPGEO_API_KEY)?(r="https://api.ipgeolocation.io/ipgeo?apiKey=".concat(t),[4,fetch(r)]):[2,o("API key is not defined")];case 1:return(a=e.sent()).ok?[4,a.json()]:[2,o("Ошибка API: ".concat(a.status))];case 2:return[2,e.sent().city||"Город"];case 3:return i=e.sent(),[2,o(i.message)];case 4:return[2]}}))}))})),Y=(0,l.Z0)({name:"city",initialState:{name:"Город",showPicker:!1},reducers:{openPicker:function(e){e.showPicker=!0},closePicker:function(e){e.showPicker=!1},setCity:function(e,n){e.name=n.payload,e.showPicker=!1}},extraReducers:function(e){e.addCase(q.fulfilled,(function(e,n){var t=n.payload;e.name=t,e.showPicker=!1})).addCase(q.rejected,(function(e){e.showPicker=!0}))}});(G=Y.actions).openPicker,G.closePicker,G.setCity;const K=Y.reducer;var U=(0,l.U1)({reducer:{auth:E,event:z,city:K}}),L=function(){return(0,c.wA)()},M=c.d4;const J="bpPJIY6U",Z="bjtsBS8k",X="EDhKdpc7",H="yyzd7YrG",W="Kjv9kV1L",Q="IAgmSXvg",$="uZZ_BM0m";var ee=function(){return ee=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},ee.apply(this,arguments)},ne=function(e,n,t,r){return new(t||(t=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,s)}c((r=r.apply(e,n||[])).next())}))},te=function(e,n){var t,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=n.call(e,i)}catch(e){s=[6,e],r=0}finally{t=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},re=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)n.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(t[r[a]]=e[r[a]])}return t};const ae=function(e){var n=e.isOpen,t=e.onClose,i=L(),o=M((function(e){return e.auth})),s=o.loading,c=o.error,l=o.isAuthenticated,u=(0,a.useState)(!0),d=u[0],f=u[1],h=(0,a.useState)({username:"",email:"",password:"",confirmPassword:"",city:""}),p=h[0],v=h[1],m=(0,a.useState)(""),y=m[0],x=m[1],j=function(e){var n;v(ee(ee({},p),((n={})[e.target.name]=e.target.value,n)))};return(0,a.useEffect)((function(){n&&l&&d&&t()}),[l,n,d,t]),(0,a.useEffect)((function(){n&&(v({username:"",email:"",password:"",confirmPassword:"",city:""}),x(""))}),[n,d]),n?(0,r.jsx)("div",{className:J,onClick:t,children:(0,r.jsxs)("div",{className:Z,onClick:function(e){return e.stopPropagation()},children:[(0,r.jsx)("button",{className:X,onClick:t,children:"×"}),(0,r.jsx)("h2",{children:d?"Вход":"Регистрация"}),(0,r.jsxs)("form",{onSubmit:function(e){return ne(void 0,void 0,void 0,(function(){var n,r,a;return te(this,(function(o){switch(o.label){case 0:return e.preventDefault(),d||p.password===p.confirmPassword?d?(p.email,p.confirmPassword,n=re(p,["email","confirmPassword"]),[4,i(S(n))]):[3,2]:(alert("Пароли не совпадают"),[2]);case 1:return o.sent(),[3,4];case 2:return p.confirmPassword,r=re(p,["confirmPassword"]),[4,i(C(r))];case 3:a=o.sent(),C.fulfilled.match(a)&&(x("Вы успешно зарегистрировались!"),setTimeout((function(){x(""),t()}),1500)),o.label=4;case 4:return[2]}}))}))},children:[(0,r.jsx)("div",{className:H,children:(0,r.jsx)("input",{type:"text",name:"username",placeholder:"Имя пользователя",value:p.username,onChange:j,required:!0})}),!d&&(0,r.jsx)("div",{className:H,children:(0,r.jsx)("input",{type:"email",name:"email",placeholder:"Email",value:p.email,onChange:j,required:!0})}),(0,r.jsx)("div",{className:H,children:(0,r.jsx)("input",{type:"password",name:"password",placeholder:"Пароль",value:p.password,onChange:j,required:!0})}),!d&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:H,children:(0,r.jsx)("input",{type:"password",name:"confirmPassword",placeholder:"Подтвердите пароль",value:p.confirmPassword,onChange:j,required:!0})}),(0,r.jsx)("div",{className:H,children:(0,r.jsx)("input",{type:"text",name:"city",placeholder:"Город",value:p.city,onChange:j})})]}),(0,r.jsx)("button",{type:"submit",disabled:s,children:s?"Загрузка...":d?"Войти":"Зарегистрироваться"}),c&&(0,r.jsx)("p",{className:W,children:c}),y&&(0,r.jsx)("p",{className:Q,children:y})]}),(0,r.jsxs)("p",{className:$,children:[d?"Нет аккаунта?":"Уже есть аккаунт?"," ",(0,r.jsx)("button",{onClick:function(){return f(!d)},children:d?"Зарегистрироваться":"Войти"})]})]})}):null},ie="k5rxhHqu",oe="mTFHSVjn",se="AQj0qjGu",ce="NLW9Mru1",le="JUFDT6sE",ue="IecoVAa_",de="TsEAjAlS",fe="g4eN4Ol0",he="MFPQxyND",pe="L_8zItlc",ve="ohMFSmtb";const me=function(){var e=L(),n=M((function(e){return e.auth})),t=(n.user,n.isAuthenticated),i=(0,a.useState)(!1),s=i[0],c=i[1],l=(0,a.useState)(!1),u=l[0],d=l[1],f=(0,a.useState)(""),h=f[0],p=f[1];return(0,r.jsxs)("header",{className:ie,children:[(0,r.jsxs)("div",{className:oe,children:[(0,r.jsx)(o.N_,{to:"/",className:se,children:"EBilet"}),(0,r.jsx)("div",{className:ve,children:(0,r.jsx)("input",{type:"text",placeholder:"Поиск мероприятий...",value:h,onChange:function(e){return p(e.target.value)}})}),(0,r.jsxs)("nav",{className:ce,children:[(0,r.jsx)(o.N_,{to:"/my-tickets",className:le,children:"Мои события"}),t?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.N_,{to:"/profile",className:le,children:"Профиль"}),(0,r.jsxs)("div",{style:{position:"relative",display:"inline-block"},children:[(0,r.jsx)("button",{onClick:function(){d(!0)},className:ue,children:"Выйти"}),u&&(0,r.jsxs)("div",{className:de,children:[(0,r.jsx)("div",{children:"Выйти из аккаунта?"}),(0,r.jsxs)("div",{className:fe,children:[(0,r.jsx)("button",{onClick:function(){e(I()),d(!1)},className:he,children:"Да"}),(0,r.jsx)("button",{onClick:function(){d(!1)},className:pe,children:"Нет"})]})]})]})]}):(0,r.jsx)("button",{onClick:function(){return c(!0)},className:ue,children:"Войти"})]})]}),(0,r.jsx)(ae,{isOpen:s,onClose:function(){return c(!1)}})]})},ye="YvM5FLFP",xe="dXj11BDJ",je="FpY8onfk",be="CRizw7lr",ge="QgcL77oZ",we="RRM3pxoO",Ne="zu3mJbnV",ke="JYaCMsI8",Ce="TTVw5vFO",Se="mXBkGq1O",Oe="AOIpO0MI",Pe="cPHSjKlo",Ie="C4vpFgDJ";const Ee=function(e){var n,t=e.event,a=e.onAddToFavorites,i=e.onBuyTicket;return(0,r.jsxs)("div",{className:ye,children:[t.imageUrl&&(0,r.jsx)("div",{className:xe,children:(0,r.jsx)("img",{src:t.imageUrl,alt:t.title,className:je})}),(0,r.jsxs)("div",{className:be,children:[(0,r.jsx)("h3",{className:ge,children:t.title}),(0,r.jsx)("p",{className:we,children:t.description}),(0,r.jsxs)("div",{className:Ne,children:[(0,r.jsx)("span",{className:ke,children:(n=t.date,new Date(n).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"}))}),(0,r.jsx)("span",{className:Ce,children:t.location}),(0,r.jsxs)("span",{className:Se,children:[t.price," ₽"]})]}),(0,r.jsxs)("div",{className:Oe,children:[(0,r.jsx)("button",{className:Pe,onClick:function(){return a(t.id)},children:"В избранное"}),(0,r.jsx)("button",{className:Ie,onClick:function(){return i(t.id)},children:"Купить билет"})]})]})]})},Re="PjgZ7vFV",Ae="jaY9VeYu",Te="BaGs2vBz",De="YvBg03zK",Fe="Tlk30F4G",_e="J481YSQ9",ze="e9XMvyD5",Ge="b9FCLRCd";var Be=function(){return Be=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},Be.apply(this,arguments)};const Ve=function(e){var n=e.onFilterChange,t=(0,a.useState)({category:"",dateRange:{start:"",end:""},priceRange:{min:0,max:1e4}}),i=t[0],o=t[1],s=function(e,t){var r,a=Be(Be({},i),((r={})[e]=t,r));o(a),null==n||n(a)};return(0,r.jsxs)("div",{className:Re,children:[(0,r.jsx)("h3",{className:Ae,children:"Фильтры"}),(0,r.jsxs)("div",{className:Te,children:[(0,r.jsx)("label",{className:De,children:"Категория"}),(0,r.jsxs)("select",{className:Fe,value:i.category,onChange:function(e){return s("category",e.target.value)},children:[(0,r.jsx)("option",{value:"",children:"Все категории"}),(0,r.jsx)("option",{value:"concert",children:"Концерты"}),(0,r.jsx)("option",{value:"theater",children:"Театр"}),(0,r.jsx)("option",{value:"exhibition",children:"Выставки"}),(0,r.jsx)("option",{value:"sport",children:"Спорт"})]})]}),(0,r.jsxs)("div",{className:Te,children:[(0,r.jsx)("label",{className:De,children:"Дата"}),(0,r.jsx)("div",{className:ze,children:(0,r.jsx)("input",{type:"date",className:_e,value:i.dateRange.start,onChange:function(e){return s("dateRange",Be(Be({},i.dateRange),{start:e.target.value}))}})})]}),(0,r.jsxs)("div",{className:Te,children:[(0,r.jsx)("label",{className:De,children:"Цена"}),(0,r.jsxs)("div",{className:Ge,children:[(0,r.jsx)("input",{type:"number",className:_e,placeholder:"От",value:i.priceRange.min,onChange:function(e){return s("priceRange",Be(Be({},i.priceRange),{min:Number(e.target.value)}))}}),(0,r.jsx)("input",{type:"number",className:_e,placeholder:"До",value:i.priceRange.max,onChange:function(e){return s("priceRange",Be(Be({},i.priceRange),{max:Number(e.target.value)}))}})]})]})]})},qe="CgjxyfEd",Ye="RLut3f27",Ke="slcXbDY8",Ue="zRDTHKjp",Le="UD6lwGa_",Me="oAFdJnbK",Je="GUOZxmDe";const Ze=function(){var e=L(),n=M((function(e){return e.event})),t=n.events,i=n.loading,o=n.error;(0,a.useEffect)((function(){e(T())}),[e]);var s=function(e){console.log("Добавлено в избранное: ".concat(e))},c=function(e){console.log("Куплен билет: ".concat(e))};return i?(0,r.jsx)("div",{className:Me,children:"Загрузка..."}):o?(0,r.jsxs)("div",{className:Je,children:["Ошибка: ",o]}):(0,r.jsx)("div",{className:qe,children:(0,r.jsxs)("div",{className:Ye,children:[(0,r.jsx)("aside",{className:Ke,children:(0,r.jsx)(Ve,{onFilterChange:function(e){console.log("Фильтры:",e)}})}),(0,r.jsx)("main",{className:Ue,children:(0,r.jsx)("div",{className:Le,children:t.map((function(e){return(0,r.jsx)(Ee,{event:e,onAddToFavorites:s,onBuyTicket:c},e.id)}))})})]})})},Xe="Crw2kdr1",He="C39kYaHZ",We="nN4bYVhl",Qe="KAiSm_v9",$e="KJlTLrGi",en="_RzXGQFk",nn="cZJTIiqp",tn="EJOHFjYL",rn="EbW2xjXI",an="EXuRoKnY",on="uXDX9P80",sn="uHtTRs6c",cn="SeuQM5i6",ln="sudOS0eV",un="DzmiSDRR",dn="ZW_on0Wd",fn="cnbyq8qV";var hn=function(){return hn=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},hn.apply(this,arguments)},pn=function(e,n,t,r){return new(t||(t=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,s)}c((r=r.apply(e,n||[])).next())}))},vn=function(e,n){var t,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=n.call(e,i)}catch(e){s=[6,e],r=0}finally{t=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};const mn=function(){var e=L(),n=M((function(e){return e.auth})).user,t=M((function(e){return e.event})),i=t.events,o=t.loading,s=t.error,c=(0,a.useState)(!1),l=c[0],u=c[1],d=(0,a.useState)({username:(null==n?void 0:n.username)||"",email:(null==n?void 0:n.email)||"",city:(null==n?void 0:n.city)||""}),f=d[0],h=d[1];(0,a.useEffect)((function(){n&&e(F())}),[e,n]);var p=function(e){var n;h(hn(hn({},f),((n={})[e.target.name]=e.target.value,n)))};return n?o?(0,r.jsx)("div",{className:dn,children:"Загрузка..."}):s?(0,r.jsx)("div",{className:fn,children:s}):(0,r.jsx)("div",{className:Xe,children:(0,r.jsxs)("div",{className:He,children:[(0,r.jsxs)("div",{className:We,children:[(0,r.jsxs)("div",{className:Qe,children:[(0,r.jsx)("img",{src:n.avatarUrl||"/default-avatar.png",alt:"Avatar",className:$e}),(0,r.jsxs)("label",{className:en,children:["Изменить фото",(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:function(n){return pn(void 0,void 0,void 0,(function(){var t,r;return vn(this,(function(a){switch(a.label){case 0:return(t=null===(r=n.target.files)||void 0===r?void 0:r[0])?[4,e(O(t))]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))},style:{display:"none"}})]})]}),(0,r.jsx)("div",{className:nn,children:l?(0,r.jsxs)("form",{className:tn,children:[(0,r.jsxs)("div",{className:rn,children:[(0,r.jsx)("label",{children:"Имя пользователя"}),(0,r.jsx)("input",{type:"text",name:"username",value:f.username,onChange:p})]}),(0,r.jsxs)("div",{className:rn,children:[(0,r.jsx)("label",{children:"Email"}),(0,r.jsx)("input",{type:"email",name:"email",value:f.email,onChange:p})]}),(0,r.jsxs)("div",{className:rn,children:[(0,r.jsx)("label",{children:"Город"}),(0,r.jsx)("input",{type:"text",name:"city",value:f.city,onChange:p})]}),(0,r.jsxs)("div",{className:an,children:[(0,r.jsx)("button",{type:"submit",className:sn,children:"Сохранить"}),(0,r.jsx)("button",{type:"button",className:cn,onClick:function(){return u(!1)},children:"Отмена"})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{children:n.username}),(0,r.jsx)("p",{children:n.email}),(0,r.jsx)("p",{children:n.city}),(0,r.jsx)("button",{className:on,onClick:function(){return u(!0)},children:"Редактировать профиль"})]})})]}),(0,r.jsxs)("div",{className:ln,children:[(0,r.jsx)("h3",{children:"Мои события"}),(0,r.jsx)("div",{className:un,children:i.map((function(e){return(0,r.jsx)(Ee,{event:e,onAddToFavorites:function(){},onBuyTicket:function(){}},e.id)}))})]})]})}):(0,r.jsx)("div",{className:fn,children:"Пожалуйста, войдите в систему"})},yn="_ifCH7uh";const xn=function(){return(0,r.jsxs)("div",{className:yn,children:[(0,r.jsx)("h1",{children:"Мои события"}),(0,r.jsx)("p",{children:"Здесь будут отображаться все купленные билеты пользователя на события."})]})},jn="d6WLOcTu",bn="CjyF501h";const gn=function(){return(0,r.jsx)(c.Kq,{store:U,children:(0,r.jsx)(o.Kd,{children:(0,r.jsxs)("div",{className:jn,children:[(0,r.jsx)(me,{}),(0,r.jsx)("main",{className:bn,children:(0,r.jsxs)(s.BV,{children:[(0,r.jsx)(s.qh,{path:"/",element:(0,r.jsx)(Ze,{})}),(0,r.jsx)(s.qh,{path:"/profile",element:(0,r.jsx)(mn,{})}),(0,r.jsx)(s.qh,{path:"/my-tickets",element:(0,r.jsx)(xn,{})})]})})]})})})};i.createRoot(document.getElementById("root")).render((0,r.jsx)(a.StrictMode,{children:(0,r.jsx)(gn,{})}))}},e=>{e.O(0,[460],(()=>{return n=688,e(e.s=n);var n}));e.O()}]);
//# sourceMappingURL=main.b0169461.js.map